<?xml version="1.0" encoding="UTF-8"?>
<blocks>
  <block id="014e0772632604acc6760e28c820cb22" category="summary">故障排除概述</block>
  <block id="818c6e601a24f72750da0f6c9b8ebe28" category="paragraph">Lorem ipsum dolor sit amet、consectetur adipiscing elit、sed do eiusmod tempdor incidunt ut labore et dolore magna aliqua。</block>
  <block id="e95081b0e85f690a9bdcb41ea940c186" category="summary">要在NetApp解决方案 上实施BeeGFS、请确保您的环境满足技术要求。</block>
  <block id="de65efa2c0698ededf4229cafcca2d08" category="doc">技术要求</block>
  <block id="47dee50ad0138b8f5ca70e40e86e6c04" category="section-title">硬件要求</block>
  <block id="16cc6ce48a597aebb8ab5132cb3523dc" category="cell">硬件组件</block>
  <block id="5a2ebfb8baa378cfcfcba58bbb1380c2" category="cell">要求</block>
  <block id="d41d8cd98f00b204e9800998ecf8427e" category="doc"></block>
  <block id="c81e728d9d4c2f636f067f89cc14862c" category="paragraph">2.</block>
  <block id="a631c0a4a9b408ccc2559c2a3323af51" category="paragraph">*其他：*</block>
  <block id="c9f0f895fb98ab9159f51fd0297e236d" category="cell">8.</block>
  <block id="7ddb33edf227a18eb76201fcb9e2c9db" category="section-title">软件要求</block>
  <block id="440907229edb210984831982728c0047" category="paragraph">为了获得可预测的性能和可靠性、NetApp解决方案 上的BeeGFS版本会使用实施解决方案 所需的特定版本软件组件进行测试。</block>
  <block id="5fea6233624bde259c99b82e6d7de3c6" category="section-title">软件部署要求</block>
  <block id="699b33acca98ab1d3eb0d684f59f1c98" category="paragraph">下表列出了在基于Ansible的BeeGFS部署中自动部署的软件要求。</block>
  <block id="719d067b229178f03bcfa1da4ac4dede" category="cell">软件</block>
  <block id="34b6cd75171affba6957e308dcbd92be" category="cell">version</block>
  <block id="eb57eb77389d7d4e71c5790c9c6ec1a7" category="cell">BeeGFS</block>
  <block id="9197ec103d780b6779cb78eec6afce31" category="cell">7.2.6</block>
  <block id="51cf7c858a71d06ee12a42cfbff97da7" category="cell">核心同步</block>
  <block id="d95adee972ae170512bd3bdbce557054" category="cell">起搏器</block>
  <block id="13f2a3097f055e043d74b20940df2658" category="section-title">Ansible控制节点要求</block>
  <block id="c3ee5ddf91e65773d3e9d27f9e627350" category="inline-link">Ansible文档</block>
  <block id="83d32979307efd813f41ef5070206fd3" category="paragraph">NetApp解决方案 上的BeeGFS可从Ansible控制节点进行部署和管理。有关详细信息，请参见<block ref="4410f583cbabaee2389115371eb2ab02" category="inline-link-rx"></block>。</block>
  <block id="158a122309f0454b31e4853755a5962a" category="paragraph">下表中列出的软件要求特定于下面列出的NetApp BeeGFS Ansible集合版本。</block>
  <block id="d51d5ee15f404c2f4f7863bebcde1fac" category="cell">Ansible</block>
  <block id="a7f5f35426b927411fc9231b56382173" category="cell">Python</block>
  <block id="d35d779fe31977939a0a72c5c962d2af" category="cell">其他Python软件包</block>
  <block id="5510cedb08df4208db0688e41cea716f" category="section-title">文件节点要求</block>
  <block id="eae2868fd17cac4569887ad9ccca42c2" category="paragraph">RedHat Enterprise Linux</block>
  <block id="1f8b1bc6c0a349e88a3353e347489a9a" category="admonition">文件节点需要有效的RedHat Enterprise Linux Server订阅和Red Hat Enterprise Linux高可用性附加软件。</block>
  <block id="2488fead2064d4aeb886afc1a0010ee7" category="cell">Linux内核</block>
  <block id="f6883581bd882ffdf705127738982586" category="cell">InfiniBand / RDMA驱动程序</block>
  <block id="fbc534ed33feffdfe8fc56e7cde13e6e" category="section-title">EF600块节点要求</block>
  <block id="e791d47d690cbc6aa7c7f9434ebd2fa1" category="cell">SANtricity 操作系统</block>
  <block id="b384b3cf4ffa3a81a88e8687dd6ca028" category="cell">NVSRAM</block>
  <block id="b89cb5f38b54c6181858af1281dcaeef" category="cell">驱动器固件</block>
  <block id="df4607ba320342072b2dc12271b08d2f" category="cell">适用于所用驱动器型号的最新版本。</block>
  <block id="cef5ab698867f39ec4b495cba708da1a" category="summary">NetApp解决方案 上的BeeGFS将BeeGFS并行文件系统与NetApp EF600存储系统相结合、打造了一个可靠、可扩展且经济高效的基础架构、可满足苛刻的工作负载要求。</block>
  <block id="c0c4b60d27032c028c91440e9d3be949" category="doc">解决方案概述</block>
  <block id="c6ff1c8ffcd7024a30e7240129bf57a8" category="section-title">NVA计划</block>
  <block id="f109ec830b8ab112f8e89da398d4ca0f" category="paragraph">NetApp解决方案 上的BeeGFS是NetApp验证架构(NVA)计划的一部分、该计划为客户提供针对特定工作负载和使用情形的参考配置和规模估算指导。NVA解决方案经过全面测试和设计、可最大限度地降低部署风险并加快上市速度。</block>
  <block id="2a3b399798aa16ecfbc1425cc560bfad" category="section-title">用例</block>
  <block id="9a250aa43ea6738ca4cd441c42e26b4e" category="paragraph">以下使用情形适用于NetApp解决方案 上的BeeGFS：</block>
  <block id="f743e786ba2a29eb033d8f7e1e2101d3" category="inline-link">BeeGFS for AI：事实与虚构</block>
  <block id="b761cb5be0f07b26af56bda6c19cf90a" category="list-text">人工智能(AI)、包括机器学习(ML)、深度学习(DL)、大规模自然语言处理(NLP)和自然语言理解(NLF)。有关详细信息，请参见<block ref="e0ec3865f791595484686c9b79436d0e" category="inline-link-rx"></block>。</block>
  <block id="3476c4aa4908c2b49f576f13d95d657a" category="inline-link">BeeGFS为何超越HPC</block>
  <block id="4becc7ac7e53ca421f06307e37478c8a" category="list-text">高性能计算(HPC)、包括通过MPI (消息传递接口)和其他分布式计算技术加速的应用程序。有关详细信息，请参见<block ref="3f795d4ce44ed51872cb7704a4553f2a" category="inline-link-rx"></block>。</block>
  <block id="89b4dd8e856627d44ffe8d3d0066cd98" category="list-text">应用程序工作负载的特征为：</block>
  <block id="c9ccfce7935790c9fd0d9ccf98da5177" category="list-text">读取或写入大于1 GB的文件</block>
  <block id="680e47afa4860ce2ac4a078a0d466121" category="list-text">多个客户端(10、100和1000)读取或写入同一文件</block>
  <block id="56e0e65d3207ad1f0f7efb003935c936" category="list-text">多TB或多PB数据集。</block>
  <block id="f36d694578bdc30f9cfa5faeb163df61" category="list-text">需要一个存储命名空间的环境、可以优化大小文件的组合。</block>
  <block id="e654f7a86a4458b9cd662267e0f29b52" category="section-title">优势</block>
  <block id="abc4f101e3891d158ab6ad80a3568c46" category="paragraph">在NetApp上使用BeeGFS的主要优势包括：</block>
  <block id="f1161b5399c6f13433f0d7ef82e26dfc" category="list-text">提供经验证的硬件设计、可实现硬件和软件组件的全面集成、以确保可预测的性能和可靠性。</block>
  <block id="d678167c236b5d1af08b550c5038cccb" category="list-text">使用Ansible进行部署和管理、以实现规模化的精简性和一致性。</block>
  <block id="82a72442e588bfcf2e472da1d9834f2a" category="inline-link">介绍用于监控NetApp E系列解决方案的框架</block>
  <block id="e30389e6b0882b87124e5401375e84e3" category="list-text">使用E系列性能分析器和BeeGFS插件提供监控和可观察性。有关详细信息，请参见<block ref="5fd4bf3409228b006228517662906ac3" category="inline-link-rx"></block>。</block>
  <block id="fc20f26327fc88da82154f6c09f6991d" category="list-text">高可用性采用共享磁盘架构、可提供数据持久性和可用性。</block>
  <block id="d47615808883de28c6943d206bf0d2cb" category="inline-link">Kubernetes认识BeeGFS：一个适应未来需求的投资故事</block>
  <block id="7f62321e8e75c63a1fe94a4d41435dac" category="list-text">支持使用容器和Kubernetes进行现代工作负载管理和流程编排。有关详细信息，请参见<block ref="3ba4b256f7ab4762b0c431fc1809aa9b" category="inline-link-rx"></block>。</block>
  <block id="cf03dce6d27c37ae2bf803a5ad8ddb93" category="section-title">HA架构</block>
  <block id="5c306284db745339f153886fd666ba5f" category="paragraph">NetApp上的BeeGFS通过创建与NetApp硬件完全集成的解决方案 来扩展BeeGFS企业版的功能、从而实现共享磁盘高可用性(HA)架构。</block>
  <block id="5481b5a39e7ecc68d8956711964cffcb" category="admonition">虽然BeeGFS社区版可以免费使用、但企业版要求从NetApp等合作伙伴购买专业支持订阅合同。企业版支持使用多项附加功能、包括故障恢复能力、配额强制实施和存储池。</block>
  <block id="d1d1e6e3c28393c984fbb987be60324d" category="paragraph">下图对无共享和共享磁盘HA架构进行了比较。</block>
  <block id="52feb691d73302501483cced28704021" category="inline-link">宣布NetApp支持的BeeGFS高可用性</block>
  <block id="0bd36571bea371893d99d201b7835845" category="paragraph">有关详细信息，请参见<block ref="eb50143d83b72cd897fd47297781957c" category="inline-link-rx"></block>。</block>
  <block id="733ba000742537e7a4435573aca51393" category="inline-link">Ansible Galax河</block>
  <block id="6ec27f578410cadd1a5e4b274d75cdb2" category="inline-link">NetApp的E系列GitHub</block>
  <block id="d643841fe27d769d39ef1865b69cb48b" category="paragraph">NetApp上的BeeGFS是使用Ansible自动化交付和部署的、Ansible自动化托管在GitHub和Ansible GALAXY上(BeeGFS集合可从获取<block ref="6e6b4aec10f34b8873e2101fed073d9a" category="inline-link-rx"></block> 和<block ref="6e9ef2e0fff4844f9560394ab05a51e9" category="inline-link-rx"></block>）。虽然Ansible主要是使用用于组装BeeGFS组件的硬件进行测试的、但您可以将其配置为使用受支持的Linux版本在几乎任何基于x86的服务器上运行。</block>
  <block id="dcd417571f5073f074067e7d0d445a2e" category="inline-link">使用E系列存储部署BeeGFS</block>
  <block id="cb8de1e2639bc0378b3714cf6ba35837" category="paragraph">有关详细信息，请参见<block ref="8af04fa161ecb5f3ec4feab8d52e96c8" category="inline-link-rx"></block>。</block>
  <block id="e69ebf3ec790efafa5cfc7b6502ccfe4" category="summary">NetApp解决方案 上的BeeGFS包括用于确定支持经验证的工作负载所需的特定设备、布线和配置的架构设计注意事项。</block>
  <block id="ebd8431a0b14e9588377860f5d21d80b" category="doc">架构概述</block>
  <block id="dc3f25ceea15d952c20a612e806039b4" category="section-title">构建块架构</block>
  <block id="f968e1fab577166d28baa278b7fbec71" category="paragraph">根据存储要求、可以使用不同的方式部署和扩展BeeGFS文件系统。例如、以大量小文件为主要特征的使用情形将受益于额外的元数据性能和容量、而大文件较少的使用情形则可能有利于提高实际文件内容的存储容量和性能。这些多种注意事项会影响并行文件系统部署的不同维度、从而增加了文件系统设计和部署的复杂性。</block>
  <block id="a0f56902d72268743383af795844da43" category="paragraph">为了应对这些挑战、NetApp设计了一个标准的构建块架构、用于横向扩展其中的每个方面。通常、BeeGFS组件部署在以下三种配置文件之一中：</block>
  <block id="cbebd598c304febe3d9ce528a39f79ca" category="list-text">一个基础组件、包括BeeGFS管理、元数据和存储服务</block>
  <block id="f606793c59d48b54b2b3a18a70dd823d" category="list-text">BeeGFS元数据加上存储组件</block>
  <block id="5d36a489380874ed227d193957d972de" category="list-text">仅供BeeGFS存储使用的组件</block>
  <block id="3679eaa30562d3f5040cb64c625a3455" category="paragraph">这三个选项之间的唯一硬件更改是使用较小的驱动器来获取BeeGFS元数据。否则、所有配置更改将通过软件应用。借助Ansible作为部署引擎、为特定组件设置所需的配置文件可以使配置任务变得简单明了。</block>
  <block id="0623572375a27997b16aa8f259513278" category="paragraph">有关更多详细信息、请参见 <block ref="27bdb301347b8d7fa8a057384825ba6a" category="inline-xref-macro-rx"></block>。</block>
  <block id="e3b101a8b62b6541bfde340117b3f92b" category="section-title">文件系统服务</block>
  <block id="26e699f65c8724efd549a1445c4b9eb3" category="paragraph">BeeGFS文件系统包括以下主要服务：</block>
  <block id="a9effde6a4743049a20cd75e19532999" category="list-text">*管理服务。*注册并监控所有其他服务。</block>
  <block id="edd29dd37a407bf6bdd3dcefe97db0d5" category="list-text">*存储服务。*存储称为数据区块文件的分布式用户文件内容。</block>
  <block id="dc134a7a2e4d2cbe6789c47709b38b35" category="list-text">*元数据服务。*跟踪文件系统布局、目录、文件属性等。</block>
  <block id="bfd4d1f28f912adef70ff502946f2d7a" category="list-text">*客户端服务。*挂载文件系统以访问存储的数据。</block>
  <block id="94ab5c559c66cc4fc4b2e1c1ed4b00a3" category="paragraph">下图显示了NetApp E系列系统中使用的BeeGFS解决方案 组件和关系。</block>
  <block id="9ac96964e53d6a8061e16551c85e7b05" category="paragraph">作为一个并行文件系统、BeeGFS会将其文件条带化到多个服务器节点上、以最大限度地提高读/写性能和可扩展性。服务器节点协同工作、可提供一个文件系统、其他服务器节点(通常称为_clients_）可以同时挂载和访问该文件系统。这些客户端可以查看和使用分布式文件系统、类似于NTFS、XFS或ext4等本地文件系统。</block>
  <block id="2cd4f3c05097f81722656ab8de9b6a25" category="paragraph">这四项主要服务在广泛支持的Linux分发版上运行、并通过任何支持TCP/IP或RDMA的网络进行通信、包括InfiniBand (IB)、OMNI-Path (OPA)和基于融合以太网的RDMA (RoCE)。BeeGFS服务器服务(管理、存储和元数据)是用户空间守护进程、而客户端是原生 内核模块(无修补)。所有组件均可在不重新启动的情况下安装或更新、您可以在同一节点上运行任何服务组合。</block>
  <block id="006d93ef4f9eec646f24191298096ff5" category="section-title">已验证节点</block>
  <block id="18bc6212071e7cb1cca90788a40a9301" category="inline-link">联想的网站</block>
  <block id="4b2aed7f56892904807d2a0dba262f91" category="section-title">经验证的硬件设计</block>
  <block id="c8a0fcd1a15bb039926f56fd15ce82e9" category="summary">适用于NetApp解决方案 上的BeeGFS的术语和概念。</block>
  <block id="5d146c3fd3b69782d69f66b386b88a4c" category="doc">术语和概念</block>
  <block id="5710fc980ad3cc07a2d53a30f8e42802" category="paragraph">以下术语和概念适用于NetApp解决方案 上的BeeGFS。</block>
  <block id="cf5f3091e30dee6597885d8c0e0c357f" category="cell">期限</block>
  <block id="b5a7adde1af5c87d7fd797b6245c2a39" category="cell">Description</block>
  <block id="0a40e3c91a3a55c9a37428c6d194d0e5" category="paragraph">AI</block>
  <block id="10a99475af71a950df10ae4fb41e6b27" category="paragraph">人工智能。</block>
  <block id="206b11a774f63418bae21625e6f6d2fb" category="paragraph">可逆清单</block>
  <block id="4278d92c9bdf11d430a86f440cffbb06" category="paragraph">包含用于描述所需BeeGFS HA集群的YAML文件的目录结构。</block>
  <block id="396262ee936f3d3e26ff0e60bea6cae0" category="paragraph">BMC</block>
  <block id="20e7cb5fddc6ef60deff83e38954fc9c" category="paragraph">基板管理控制器。有时称为服务处理器。</block>
  <block id="399cda935f5cb9e0b94eaf42309257fb" category="paragraph">块节点</block>
  <block id="56977f2bee9d2716e5224e95ceb72839" category="paragraph">存储系统。</block>
  <block id="fac04ca68a48af91f0290001604a2463" category="paragraph">客户端</block>
  <block id="f5ce9f5cb682a1f863d5a8c51ac28683" category="paragraph">深度</block>
  <block id="3a113e532fcdd400cdf83ef62ac9d9de" category="paragraph">深度学习。</block>
  <block id="c404903bef63acba3e3abe370e09474f" category="paragraph">文件节点</block>
  <block id="2118e5d99e7b7d309a8f82e52f89ab22" category="paragraph">BeeGFS文件服务器。</block>
  <block id="594c16ca0695f6665d7cf4971707adf6" category="paragraph">HA</block>
  <block id="b5c55115b0714618209ee9459023bad1" category="paragraph">高可用性。</block>
  <block id="a25baf723f95fbcbceae8399b638f108" category="paragraph">HIC</block>
  <block id="2d5307a091565cb524b7c0a2c48a1588" category="paragraph">主机接口卡。</block>
  <block id="2f569257101cf136a49d983584bfc44f" category="paragraph">HPC</block>
  <block id="9a3968cd0518e869657fa99f060cd8f2" category="paragraph">高性能计算。</block>
  <block id="06a52007ec390481940877b63a4b7c61" category="paragraph">HPC模式的工作负载</block>
  <block id="221d47451f4f42c2e516a414798b6e1e" category="paragraph">HPC模式的工作负载通常具有多个计算节点或GPU、这些节点或GPU都需要并行访问同一数据集、以便执行分布式计算或培训作业。这些数据集通常由大型文件组成、这些文件应在多个物理存储节点之间进行条带化、以消除传统硬件瓶颈、避免同时访问单个文件。</block>
  <block id="d01fd9b01e9dde8bd3dc247afbfb7218" category="paragraph">毫升</block>
  <block id="65abbc2190f8ea8522de3b7df3397302" category="paragraph">机器学习。</block>
  <block id="85587c49afa2ea2adacd4bbcdb57d064" category="paragraph">NLP</block>
  <block id="1e8218217ed7a37de1bd5f394a253db8" category="paragraph">自然语言处理。</block>
  <block id="04808383df00e6501c912f8fae661f73" category="paragraph">NLU</block>
  <block id="f0f701867a5e02fa406b05e22df7ae03" category="paragraph">自然语言理解。</block>
  <block id="af33781ae5dd2f5ffb194a90989038a8" category="paragraph">NVA</block>
  <block id="4119dd754c8118aa6a1bb36f194a2f52" category="paragraph">NetApp经验证的架构(NVA)计划为特定工作负载和使用情形提供参考配置和规模估算指导。这些解决方案经过全面测试、旨在最大程度地降低部署风险并加快上市速度。</block>
  <block id="51bfd24e79e0939d84e9230980db5f18" category="summary">NetApp解决方案 上的BeeGFS目前正处于第二代设计阶段。</block>
  <block id="fa0de4179a84e742d2d88028d16bf137" category="doc">设计代数</block>
  <block id="51c16b7415d506b9bbcedd7241c7c1c0" category="paragraph">第一代和第二代均采用一种基础架构、其中整合了BeeGFS文件系统和NVMe EF600存储系统。但是、第二代基于第一代产品构建、其中包括以下附加优势：</block>
  <block id="20667306535e51f69f34371b95abfd0b" category="list-text">将性能和容量提高一倍、同时仅添加2U机架空间</block>
  <block id="edcc56d654a1a9362699f309c738a185" category="list-text">高可用性(High Availability、HA)基于共享磁盘的两层硬件设计</block>
  <block id="189fdda096d5b994e140eac128f464e1" category="section-title">第二代设计</block>
  <block id="145c927b5996411105e8a05381bfab75" category="section-title">第一代设计</block>
  <block id="8c2de6dc6972aa428c25b73867ee0c6c" category="inline-link-macro">采用NVIDIA DGX A100系统和BeeGFS的NetApp EF系列AI</block>
  <block id="cb0e1ee82028e21bcb25d1cedee42a90" category="paragraph">有关第一代产品的详细信息、请参见 <block ref="7c75f12548abfaad3f9a226ecdfc54d3" category="inline-link-macro-rx"></block>。</block>
  <block id="745f22cbd412f2eab6c6bf95417e8b09" category="doc">此站点包含的内容</block>
  <block id="fb7e8abee0ed4186f8c4b871d0ea6ac3" category="inline-link-macro">设计概述</block>
  <block id="42f8643eb52a942747937327c72c8361" category="inline-link-macro">部署概述</block>
  <block id="fefc21957cc1bbb1f6a7704d95ad5e0d" category="summary">您可以使用NetApp的第二代BeeGFS组件设计将NetApp上的BeeGFS部署到经验证的文件和块节点。</block>
  <block id="ef200d7e9d983785df6b4e01fa65bf59" category="section-title">Ansible集合和角色</block>
  <block id="31f2ceaa03965649e2e37df5634511e7" category="paragraph">您可以使用Ansible在NetApp解决方案 上部署BeeGFS、Ansible是一种常用的IT自动化引擎、用于自动执行应用程序部署。Ansible使用一系列文件、统称为清单、用于为要部署的BeeGFS文件系统建立模型。</block>
  <block id="87d27d52f7fc81e8a134f2e3d2a57ecf" category="inline-link">NetApp E系列BeeGFS集合</block>
  <block id="4aa1cf90ffa01d3b63825bad839d9e29" category="inline-link-macro">了解Ansible清单</block>
  <block id="1325754275d5677e560f21035bc1ac47" category="paragraph">有关其他详细信息，请参见 <block ref="dd39ef1fcc2e17fe1fe509b7ac2d5dea" category="inline-link-macro-rx"></block>。</block>
  <block id="5b3ae76175242b9c0c63ba5668657f49" category="admonition">由于在NetApp解决方案 上部署BeeGFS涉及许多步骤、因此NetApp不支持手动部署解决方案。</block>
  <block id="6201cef3e5bb8f42f2aa1876b8c1f544" category="section-title">BeeGFS组件的配置配置文件</block>
  <block id="3c411e2f06cd1b5275d2be84bb18a641" category="paragraph">部署过程包括以下配置文件：</block>
  <block id="3c1ad21a1c1a2804f8ace80b84822bfe" category="list-text">一个基础组件、其中包括管理、元数据和存储服务。</block>
  <block id="416ad52da618754efb3680e957b1a048" category="list-text">包含元数据和存储服务的第二个组件。</block>
  <block id="11047a79bd1eab4d52ba658a48a430e8" category="list-text">仅包含存储服务的第三个组件。</block>
  <block id="886066871646e69724c15beede051aa6" category="paragraph">这些配置文件展示了NetApp BeeGFS组件的完整建议配置文件。对于每个部署、元数据和存储组件或仅存储服务组件的数量可能因容量和性能要求而有所不同。</block>
  <block id="20cf8ff34f34ae23669e586d1092a0f9" category="section-title">部署步骤概述</block>
  <block id="9d863a0564ad86180bde2b2a6c27a6ed" category="paragraph">部署涉及以下高级任务：</block>
  <block id="fd2f8c173ade715231c21c932686e38b" category="list-title">硬件部署</block>
  <block id="f08d36149d715ffbb8eca9f7159e0d27" category="list-text">以物理方式组装每个组件。</block>
  <block id="abd55e01ead6dac45d997ad9c82c8019" category="inline-link-macro">部署硬件</block>
  <block id="65353eb96f13d02029086d1790108e3c" category="list-text">机架和缆线硬件。有关详细过程、请参见 <block ref="19367e6e5e194f2806703eb905741326" category="inline-link-macro-rx"></block>。</block>
  <block id="b9205e876aa43217d9358621cf2c6187" category="list-title">软件部署</block>
  <block id="359f84c66084d8c8c9d4cb7ca3945bcd" category="inline-link-macro">设置文件和块节点</block>
  <block id="f8367dab28e2315251df9dcf227916b5" category="list-text"><block ref="4cfaa56cb8da11f04e7ee8ae6dd86bcc" category="inline-link-macro-rx"></block>。</block>
  <block id="ee63db10faeceba4efb3b03145e0ec26" category="list-text">在文件节点上配置BMC IP</block>
  <block id="aa51221099b00aa6e09e3cb6b1b03f47" category="list-text">安装受支持的操作系统并在文件节点上配置管理网络</block>
  <block id="a75b117cd8d7af9205b2185d8afb8537" category="list-text">在块节点上配置管理IP</block>
  <block id="14f10d91a4d4d076d9f025fdb6134949" category="inline-link-macro">设置Ansible控制节点</block>
  <block id="b81f7e6126c9f5040f05685e56e57af1" category="list-text"><block ref="6848fc9a1ed48359bab6d9326922d03c" category="inline-link-macro-rx"></block>。</block>
  <block id="51d961299f8aa9bb882574aae2a219eb" category="inline-link-macro">调整系统性能设置</block>
  <block id="9312585e52fd3b0a0898c7f73fdfd8cc" category="list-text"><block ref="dbe1843153b6696d3dd846d3a25ea7b2" category="inline-link-macro-rx"></block>。</block>
  <block id="2903652ee31835883feeb469228b4406" category="inline-link-macro">创建Ansible清单</block>
  <block id="914b8eb4568f7c438e1d415af01c2787" category="list-text"><block ref="dbbcb9482f49ee969cddb7f10864cbd0" category="inline-link-macro-rx"></block>。</block>
  <block id="c8f38adfaba8270e793616e0556571c7" category="inline-link-macro">为BeeGFS组件定义Ansible清单</block>
  <block id="2640957ad14de18b2d308da5e116b4a0" category="list-text"><block ref="56ee4018bb6227ffe39900ebf12f2472" category="inline-link-macro-rx"></block>。</block>
  <block id="d21cb96c35176f0f0ea13876f354d072" category="inline-link-macro">使用Ansible部署BeeGFS</block>
  <block id="a8169193bd5718bbe78111b3a1f874d7" category="list-text"><block ref="dffbd1bc941e2f4395de7cba04c6653b" category="inline-link-macro-rx"></block>。</block>
  <block id="096a6674c1f4ef681d88a6eb229299b7" category="inline-link-macro">配置BeeGFS客户端</block>
  <block id="f159952d71e33cd0a1ffbb2bcc4ce2ad" category="list-text"><block ref="75197807ccb18c9f99e8f2a2a3443aea" category="inline-link-macro-rx"></block>。</block>
  <block id="d6dd015562e1d088d87d28007ecfa541" category="admonition">部署过程包括几个示例、其中需要将文本复制到文件。请密切注意对于任何应针对特定部署进行修改或可修改的内容、任何以"#"或"/"字符表示的实时注释。例如：`beegfs_ha_ntp_server_pools：# This is an example of a comment！-"pool 0.pool.ntp.org iBurst maxsources 3"-"pool 1.pool.ntp.org iBurst maxsources 3"`</block>
  <block id="d8ca15234a274a841f06a1d429141054" category="summary">在每个服务器的基板管理控制器(BMC)上配置网络连接、并在每个控制器上配置管理端口。</block>
  <block id="1cfd8029b1372ddacb436890446b43fd" category="doc">设置文件节点和块节点</block>
  <block id="d900235d99f416c3bfda0461cbb71f26" category="paragraph">虽然大多数软件配置任务都是使用NetApp提供的Ansible集合自动执行的、但您必须在每个服务器的基板管理控制器(Baseboard Management Controller、BMC)上配置网络、并在每个控制器上配置管理端口。</block>
  <block id="02f510b4f0f01c83fb0898c7c21472f3" category="section-title">设置文件节点</block>
  <block id="58ee770c560ec650edbb0731c6882d53" category="list-text">在每个服务器的基板管理控制器(BMC)上配置网络连接。</block>
  <block id="75ae096871a25daf3dcd5da902c66ecf" category="inline-link">联想ThinkSystem文档</block>
  <block id="0c112c89dd8c3ce2b92d5e4844ea4641" category="admonition">基板管理控制器(Baseboard Management Controller、BMC)有时也称为服务处理器、它是内置于各种服务器平台中的带外管理功能的通用名称、即使操作系统未安装或无法访问、也可以提供远程访问。供应商通常会使用自己的品牌推广此功能。例如、在联想SR665上、BMC称为_Lenovo Xicity1控制器(XCC)_。</block>
  <block id="290a84841d7341364c4abf862a74583f" category="list-text">配置系统设置以实现最高性能。</block>
  <block id="04c7f6322804081c61ca0d88cef85904" category="paragraph">您可以使用UEFI设置(以前称为BIOS)或许多BMC提供的Redfish API配置系统设置。系统设置因用作文件节点的服务器型号而异。</block>
  <block id="354f37da23eacae1fc163775964a0a2e" category="paragraph">要了解如何为经过验证的联想SR665文件节点配置系统设置、请参见 <block ref="dbe1843153b6696d3dd846d3a25ea7b2" category="inline-link-macro-rx"></block>。</block>
  <block id="63b34e32fcac1724c46edd575672332b" category="paragraph">此时、请勿在任何InfiniBand端口上配置IP。</block>
  <block id="e9074e57167186919a163cd099187dd0" category="admonition">尽管严格要求不高、但后续章节假定主机名按顺序编号(例如H1-HN)、并提及应在奇数主机上完成的任务、而不是偶数主机上完成的任务。</block>
  <block id="0123fb5bcbcd68deb7c43ec913e70705" category="inline-link">如何注册和订阅RHEL系统</block>
  <block id="29f7e22c9a0b8d15ea802eee7a5e07cf" category="inline-link">如何限制更新</block>
  <block id="577885e812bad7e4780317a271722339" category="list-text">启用包含高可用性所需软件包的Red Hat存储库。</block>
  <block id="3c438be737391744e2fed6f73c418638" category="inline-link-macro">技术要求</block>
  <block id="de2787072a70ede6b3c4b90ff28fe789" category="inline-link">lxup—更新和查询实用程序</block>
  <block id="febfb51b621938c49980eee52ab6a373" category="section-title">设置块节点</block>
  <block id="1dab115fdeed11b46ad9a32f690cfc8a" category="paragraph">通过在每个控制器上配置管理端口来设置EF600块节点。</block>
  <block id="0631592349fc286da7627270b9c9b359" category="list-text">在每个EF600控制器上配置管理端口。</block>
  <block id="3f7c08d9f511dbd36a44bc681e25e3bf" category="inline-link">E系列文档中心</block>
  <block id="83398f0ded44dc933df951171f29b604" category="paragraph">有关配置端口的说明、请转至<block ref="4719a190e5f3bfbda84ab0e6295af1ef" category="inline-link-rx"></block>。</block>
  <block id="a1cdd0715dd7993c1664eea6d7f39810" category="list-text">(可选)设置每个系统的存储阵列名称。</block>
  <block id="6c8f452018d59ce25e69f9d3f8851b32" category="paragraph">通过设置名称、可以更轻松地在后续章节中引用每个系统。有关设置阵列名称的说明、请转到<block ref="4719a190e5f3bfbda84ab0e6295af1ef" category="inline-link-rx"></block>。</block>
  <block id="561abcc4bd5f30a9d5ee1e4c64d9a10d" category="admonition">尽管严格要求不严格、但后续主题假定存储阵列名称按顺序编号(例如C1 - CN)、并提及在奇数系统甚至编号系统上应完成的步骤。</block>
  <block id="1b6582c92d5f0e47bd102f2e16686662" category="summary">开始部署之前、请确保了解如何使用Ansible使用第二代BeeGFS组件设计在NetApp解决方案 上配置和部署BeeGFS。</block>
  <block id="91177a5a4b0c27f810e6deb9395eef4a" category="inline-link">NetApp E系列BeeGFS GitHub</block>
  <block id="489a8841f96385c3fca8ff239dc24250" category="paragraph">Ansible清单定义了文件和块节点的配置、并表示要部署的BeeGFS文件系统。清单包括描述所需BeeGFS文件系统的主机、组和变量。可从下载示例清单<block ref="5f5a4f2bb780d1d47d6a1c5865c757e8" category="inline-link-rx"></block>。</block>
  <block id="2b030b2e370bebb88648070cda0b66eb" category="section-title">Ansible模块和角色</block>
  <block id="27633c2a48532dabf935531ba52193df" category="paragraph">NetApp E系列Ansible资料集中的每个角色都是在NetApp解决方案 上完整地端到端部署BeeGFS。这些角色使用NetApp E系列SANtricity 、主机和BeeGFS集合、通过这些集合、您可以使用HA (高可用性)配置BeeGFS文件系统。然后、您可以配置和映射存储、并确保集群存储已准备就绪、可以使用。</block>
  <block id="ca467fdffa66288bc6eeca1d49467e2e" category="paragraph">虽然角色附带了深入的文档、但部署过程介绍了如何使用角色使用第二代BeeGFS组件设计部署经验证的NetApp架构。</block>
  <block id="7c1be9d0f9dc743e2a1540004da3eb1d" category="admonition">尽管部署步骤会尝试提供足够详细的信息、以便事先使用Ansible并不是前提条件、但您应该对Ansible及相关术语有所熟悉。</block>
  <block id="e9b6dfb59ebbe3c2a8e47b9bec2ada24" category="section-title">BeeGFS HA集群的清单布局</block>
  <block id="5585bfe6d81b9366f1160e16fcf3464f" category="paragraph">使用Ansible清单结构定义BeeGFS HA集群。</block>
  <block id="ea969b9d9b8b0a66432c22ea23412c18" category="paragraph">任何以前具有Ansible经验的用户都应了解BeeGFS HA角色可通过一种自定义方法来发现每个主机适用的变量(或事实)。要简化Ansible清单的构建、使其能够描述可在多个服务器上运行的资源、需要执行此操作。</block>
  <block id="fcf695220ea603b6d461ed9aaa63c323" category="paragraph">Ansible清单通常由`host_vars`和`group_vars`中的文件以及一个`inventory.yml`文件组成、该文件可将主机分配给特定组(并可能将组分配给其他组)。</block>
  <block id="927527f499c87b83ee052f9a293c0293" category="admonition">请勿使用本小节中的内容创建任何文件、本小节仅用作示例。</block>
  <block id="a7a48a32496dcd14ea6f94f7d89ab599" category="paragraph">尽管此配置是根据配置配置文件预先确定的、但您应大致了解如何将所有内容作为Ansible清单进行布局、如下所示：</block>
  <block id="9d92e1d6c46a5db6f99457758b8c71dc" category="paragraph">对于每个服务、将在`group_vars`下创建一个附加文件、用于描述其配置：</block>
  <block id="7c98bb1c0d887b40b12614cc2cce909e" category="inline-link">NetApp借助Ansible加快了BeeGFS HA的部署</block>
  <block id="2c3ce0f08dbef62630d61052bdd46f20" category="paragraph">通过此布局、可以在一个位置为每个资源定义BeeGFS服务、网络和存储配置。在后台、BeeGFS角色会根据此清单结构为每个文件和块节点聚合所需的配置。有关详细信息、请参见以下博客文章：<block ref="500a149f08c7164c80066a24197a4f46" category="inline-link-rx"></block>。</block>
  <block id="bab8955d49a06dc041f1cf99ae3c65aa" category="admonition">系统会根据组名称自动配置每个服务的BeeGFS数字和字符串节点ID。因此、除了组名称唯一的一般可逆要求之外、表示BeeGFS服务的组必须以该组所代表的BeeGFS服务类型唯一的数字结尾。例如、允许使用meta_01和stor_01、但不允许使用metadata_01和metada_01。</block>
  <block id="1d62eb925570a160f6a58cd18984f578" category="summary">BeeGFS解决方案 提供了基于验证测试的性能和容量规模估算建议。</block>
  <block id="137e4d3e0bc5586af6fc7ca9441511e1" category="doc">规模估算准则</block>
  <block id="6166a42aac4e50811124dbb35631ea78" category="paragraph">构建块架构的目标是、通过添加多个构建块来满足特定BeeGFS系统的要求、创建一个易于调整大小的解决方案。您可以根据以下准则估算满足环境要求所需的BeeGFS组件的数量和类型。</block>
  <block id="a752ca5f8ca9bd168c12fc180ff734e3" category="paragraph">请记住、这些估计是最佳性能。我们编写并利用了综合基准测试应用程序、以便以实际应用程序可能无法实现的方式优化底层文件系统的使用。</block>
  <block id="800f4a301937e5493aaaddfe77e10dd5" category="section-title">性能规模估算</block>
  <block id="6875300666b544ca98e406bd6ca73da1" category="paragraph">下表提供了建议的性能规模估算。</block>
  <block id="83d4567aaaf81ff58ab394c3ad02accc" category="cell">配置配置文件</block>
  <block id="58a15ea9e5c981b498a5c119456b9dd9" category="cell">1 MiB读取</block>
  <block id="968dfca19c742301bc400a7c883b1594" category="cell">1 MiB写入</block>
  <block id="8cf5b688a1a209b630cab18001501c76" category="cell">元数据+存储</block>
  <block id="5d44d1f7b753dee2968cad82eef2f1dd" category="cell">62 GiBps</block>
  <block id="a5a649e4dec54d9f61f1cfc632dab412" category="cell">21 GiBps</block>
  <block id="dfab8e8b566f2d091e7ecb4b4d65060b" category="cell">仅存储</block>
  <block id="1d955116a3bafb864bcf6755485fce7e" category="cell">64 GiBps</block>
  <block id="419cfc02b324dc7d8faefa90ed608fb0" category="inline-link">系统要求</block>
  <block id="e618e38f89f153e374a90674c51efb8f" category="paragraph">元数据容量估算是根据"经验法则"估算的、即500 GB的容量足以容纳BeeGFS中大约1.5亿个文件。(有关详细信息、请参见的BeeGFS文档<block ref="d422b619831c270410797364c04b1fb2" category="inline-link-rx"></block>）</block>
  <block id="903cd75262aca9ec0b3a831bccc18869" category="paragraph">使用访问控制列表等功能以及每个目录的目录和文件数量也会影响元数据空间的使用速度。存储容量估计值会考虑可用驱动器容量以及RAID 6和XFS开销。</block>
  <block id="9490db12574d3954607c7e9d91d28809" category="section-title">元数据+存储组件的容量规模估算</block>
  <block id="015d2cd8138605f0cec20c9dffe04a93" category="paragraph">下表提供了元数据和存储组件的建议容量大小调整。</block>
  <block id="b897bc1ea15940ab83faf02e07b143bf" category="cell">驱动器大小(2+2 RAID 1)元数据卷组</block>
  <block id="fa4beb4be6de6614b0cd1460e8d33b1f" category="cell">元数据容量(文件数)</block>
  <block id="070e4137f478af27755d228dba080d41" category="cell">驱动器大小(8+2 RAID 6)存储卷组</block>
  <block id="785d80cc95b60fc3365e05e3ae013331" category="cell">存储容量(文件内容)</block>
  <block id="be3ca1ec15ca4657e5ca3ec84a561090" category="cell">1.92 TB</block>
  <block id="71839d6e6fb59e239ad941d08b5e2519" category="cell">3.84 TB</block>
  <block id="a98c228c0d8903ba6926546f64321cc4" category="cell">7.68 TB</block>
  <block id="1f04a7c587f50d269f44d43229c966ac" category="cell">15.3 TB</block>
  <block id="a966f153f6f429bbd39c3ac2390ef970" category="admonition">在估算元数据和存储组件的规模时、您可以使用较小的驱动器作为元数据卷组、而不是存储卷组、从而降低成本。</block>
  <block id="f9fb1e607e840d5610c34a9f15da540e" category="section-title">仅存储组件的容量规模估算</block>
  <block id="cd9db38cfde636fa7c304f8e67d8708d" category="paragraph">下表提供了仅存储组件的容量规模估算规则。</block>
  <block id="4f7d0f08c61d0cc981b973ba853e2c6f" category="cell">59.89 TB</block>
  <block id="22f3cf273453d70fdc724d513005c81d" category="cell">119.80 TB</block>
  <block id="e4c2850d67996ecfe5e0b56e9637a470" category="cell">251.89 TB</block>
  <block id="f7c8918f0c24047e89e5842785e7b8ef" category="cell">538.55 TB</block>
  <block id="3cf8b9e44b7a1eb7154f2b777094e670" category="admonition">除非启用全局文件锁定、否则将管理服务包含在基本(第一个)组件中所带来的性能和容量开销极小。</block>
  <block id="5b361b4897c4847c08b3d13bf3b66b8d" category="summary">在需要访问BeeGFS文件系统的任何主机上安装和配置BeeGFS客户端、例如计算或GPU节点。在此任务中、您可以使用Ansible和BeeGFS收集。</block>
  <block id="c855016387ccd14e80b0628a2da5609b" category="paragraph">您必须在需要访问BeeGFS文件系统的任何主机上安装和配置BeeGFS客户端、例如计算或GPU节点。在此任务中、您可以使用Ansible和BeeGFS收集。</block>
  <block id="f3a29486bed19a90f2da6d007818b427" category="list-title">步骤</block>
  <block id="f4bf34ee26e45437b7b34ee3858d3f39" category="list-text">如果需要、请从Ansible控制节点向要配置为BeeGFS客户端的每个主机设置无密码SSH：</block>
  <block id="c9793ac6c6a163b585094181979efe25" category="paragraph">`ssh-copy-id &lt;user&gt;@&lt;HOSTNAME_OR_IP&gt;`</block>
  <block id="05c8acf59a637c421ef21a4a37d674de" category="list-text">在`host_vars/`下、为名为`&lt;HOSTNAME&gt;.yml`的每个BeeGFS客户端创建一个包含以下内容的文件、并使用适用于您环境的正确信息填写占位符文本：</block>
  <block id="ca6b4577e851d5587e19a3d017db68b1" category="list-text">创建一个新文件`client_inventory.yml`、然后在顶部填充以下参数：</block>
  <block id="ec6e88f08b026e04d1ce5f5f31493b21" category="inline-link">使用Ansible Vault加密内容</block>
  <block id="d424a4948912165baf5c9641ad4de044" category="admonition">请勿以纯文本格式存储密码。请改用Ansible Vault (请参见的Ansible文档)<block ref="69d38d4b5deda302461f6461c5317006" category="inline-link-rx"></block>)或在运行攻略手册时使用`-ask-pass-pass`选项。</block>
  <block id="8f27eda73b5d4e7594b05bed1b90a053" category="list-text">在`client_inventory.yml`文件中、列出应在`beegfs_clients`组下配置为BeeGFS客户端的所有主机、然后指定构建BeeGFS客户端内核模块所需的任何其他配置。</block>
  <block id="42d868a1eb5776ce2eb9b95938bcc056" category="inline-link">RDMA支持</block>
  <block id="b9d3c4e1c18127cf36ad951b208d45bb" category="list-text">在`client_inventory.yml`文件中、列出要挂载到任何先前定义的`vars`底部的BeeGFS文件系统。</block>
  <block id="0ebb92016a1cd310802bb6e22bcd491c" category="admonition">`beegfs_client_config`表示已测试的设置。有关所有选项的全面概述、请参见`netapp_eseries.beegfs`集合的`beegfs_client` role附带的文档。其中包括有关挂载多个BeeGFS文件系统或多次挂载相同BeeGFS文件系统的详细信息。</block>
  <block id="853c95fff114a0396695a5a34c4f78f1" category="list-text">创建新的`client_playbook.yml`文件、然后填充以下参数：</block>
  <block id="8ae73b3fcef5fc8f1a73e62c987915e6" category="admonition">如果您已在相应的IPoIB接口上安装了所需的IB/RDMA驱动程序和配置的IP、请省略导入`NetApp_E系列.host`集合和`IPoIB`角色。</block>
  <block id="598ee1856218e19bf329d8bece215061" category="list-text">要安装和构建客户端并挂载BeeGFS、请运行以下命令：</block>
  <block id="999070faf3729384137acf10348ed589" category="list-text">在将BeeGFS文件系统投入生产之前、我们*强烈*建议您登录到任何客户端并运行`beegfs-fsck -checkfs`以确保所有节点均可访问且未报告任何问题。</block>
  <block id="883ccbea6264c3d9c8ea56267b290a0a" category="summary">NetApp上的BeeGFS软件配置包括BeeGFS网络组件、EF600块节点、BeeGFS文件节点、资源组和BeeGFS服务。</block>
  <block id="e366b0b441e75fcafac2db7ff979a799" category="doc">软件配置</block>
  <block id="dea1b03288253149cb4c55f3c4f10e3e" category="section-title">BeeGFS网络配置</block>
  <block id="391f99769ce2b9374f0421ace7ce5ac5" category="paragraph">BeeGFS网络配置由以下组件组成。</block>
  <block id="f05f92f283e258444df8e73ac9508c74" category="list-text">*浮动IP*浮动IP是一种虚拟IP地址、可以动态路由到同一网络中的任何服务器。多个服务器可以拥有相同的浮动IP地址、但在任何给定时间、它只能在一个服务器上处于活动状态。</block>
  <block id="76a7e91177d008d5a202ef507a9049d7" category="paragraph">每个BeeGFS服务器服务都有自己的IP地址、可以根据BeeGFS服务器服务的运行位置在文件节点之间移动。此浮动IP配置允许每个服务单独故障转移到另一个文件节点。客户端只需知道特定BeeGFS服务的IP地址即可；它不需要知道哪个文件节点当前正在运行该服务。</block>
  <block id="527f436644c629cc1f2330d74c5c29b4" category="list-text">* BeeGFS服务器多主机配置*为了提高解决方案 的密度、每个文件节点都有多个存储接口、其IP配置在同一IP子网中。</block>
  <block id="5a19238d05fdcdb09e439e41a0a94349" category="paragraph">为了确保此配置在Linux网络堆栈中正常运行、需要进行其他配置、因为默认情况下、如果一个接口的IP位于同一子网中、则可以在其他接口上对对对对请求做出响应。除了其他缺点之外、此默认行为还会使您无法正确建立或维护RDMA连接。</block>
  <block id="e7a28f6c997a9c0eba41eb574b5f829c" category="paragraph">基于Ansible的部署可处理反向路径(RP)和地址解析协议(ARP)行为的收紧、并确保浮动IP何时启动和停止；系统会动态创建相应的IP路由和规则、以使多宿主网络配置正常运行。</block>
  <block id="12ec3f7db1a39d49d76e159a6fc9be24" category="paragraph">下图显示了在多个BeeGFS客户端接口之间平衡流量的情况。</block>
  <block id="02eef1a6d9aefa452755edb315057e27" category="paragraph">由于BeeGFS中的每个文件通常在多个存储服务之间进行条带化、因此多导轨配置可以使客户端实现比单个InfiniBand端口更大的吞吐量。例如、以下代码示例显示了一个通用文件条带化配置、该配置允许客户端在两个接口之间平衡流量：</block>
  <block id="b28b500a27afaa858536ee53a4c02d91" category="section-title">EF600块节点配置</block>
  <block id="6e88eb560b5c117f0226888b924af1c5" category="paragraph">块节点由两个主动/主动RAID控制器组成、这些控制器可共享访问同一组驱动器。通常、每个控制器拥有系统上配置的一半卷、但可以根据需要接管另一个控制器。</block>
  <block id="674757e2095af366602187ca856f8ec4" category="paragraph">文件节点上的多路径软件可确定每个卷的活动和优化路径、并在发生缆线、适配器或控制器故障时自动移至备用路径。</block>
  <block id="458cd7cdbda7e7a38853eae8ce0e9662" category="paragraph">下图显示了EF600块节点中的控制器布局。</block>
  <block id="b4adca73c8e2d619dedc4eb6a42bc966" category="paragraph">为了便于使用共享磁盘HA解决方案 、卷会映射到两个文件节点、以便它们可以根据需要相互接管。下图显示了如何配置BeeGFS服务和首选卷所有权以实现最高性能的示例。每个BeeGFS服务左侧的接口指示客户端和其他服务用来与其联系的首选接口。</block>
  <block id="d1bff1512ad9e19d6469659f6a916a7e" category="paragraph">在上一示例中、客户端和服务器服务更愿意使用接口i1b与存储服务1进行通信。存储服务1使用接口i1a作为与其第一个块节点的控制器A上的卷(storage_tgt_101、102)进行通信的首选路径。此配置可利用InfiniBand适配器可用的全双向PCIe带宽、并通过双端口HDR InfiniBand适配器获得比PCIe 4.0更高的性能。</block>
  <block id="f4fa0385d373373f4ab191231ead5909" category="section-title">BeeGFS文件节点配置</block>
  <block id="5e2d5eb9f991b81a298fb57212c715fe" category="paragraph">BeeGFS文件节点配置到高可用性(HA)集群中、以便于在多个文件节点之间对BeeGFS服务进行故障转移。</block>
  <block id="f409d0a0c329860646597bbcc45fcc4b" category="inline-link">针对高可用性附加组件的Red Hat培训</block>
  <block id="79b70ba13b6d273b53c66d816a15830d" category="paragraph">NetApp编写并扩展了多个开放式集群框架(Open Cluster Framework、OCF)资源代理、使集群能够智能启动和监控BeeGFS资源。</block>
  <block id="ff07f4dbc22a6f0ecb4a11bfb6136d40" category="section-title">BeeGFS HA集群</block>
  <block id="7a189557128751d94f2d8bca38ccf462" category="paragraph">通常、在启动BeeGFS服务(无论是否具有HA)时、必须具备一些资源：</block>
  <block id="3f1f71800ded6b59769a66de67dd7d86" category="list-text">可访问服务的IP地址、通常由Network Manager配置。</block>
  <block id="03eb5c90128e244e904f61d22569b4af" category="list-text">用作BeeGFS数据存储目标的底层文件系统。</block>
  <block id="510de0f837e4aacf9e6eb3c08926bcff" category="paragraph">这些参数通常在`/etc/fstab`中定义、并由systemd挂载。</block>
  <block id="49990dbe44b62019deed5be9f5c437a3" category="list-text">一种系统服务、负责在其他资源准备就绪时启动BeeGFS进程。</block>
  <block id="4f26c3922778ca3d5247b1281f6843af" category="paragraph">如果没有其他软件、这些资源只会在一个文件节点上启动。因此、如果文件节点脱机、则无法访问BeeGFS文件系统的一部分。</block>
  <block id="c60a1b018b03670c1a1a93baf9da5d45" category="paragraph">由于多个节点可以启动每个BeeGFS服务、因此Pacemaker必须确保每个服务和相关资源一次仅在一个节点上运行。例如、如果两个节点尝试启动同一BeeGFS服务、则在它们都尝试写入底层目标上的相同文件时、存在数据损坏的风险。为了避免这种情况、Pacemaker会依靠Corosync可靠地在所有节点之间保持整个集群的状态同步并建立仲裁。</block>
  <block id="a96d4ad8c651d8ff21de193227e20f4d" category="paragraph">如果集群发生故障、Pacemaker会做出反应、并在另一节点上重新启动BeeGFS资源。在某些情况下、Pacemaker可能无法与原始故障节点通信以确认资源已停止。要在其他位置重新启动BeeGFS资源之前验证节点是否已关闭、Pacemaker最好断开故障节点的电源。</block>
  <block id="ad22605bb834d1c650f3b2f1e5c76401" category="paragraph">有许多开源隔离代理可用于使Pacemaker使用配电单元(PDU)或使用服务器基板管理控制器(BMC)和Redfo*等API来隔离节点。</block>
  <block id="05273fb3cfbaf5190eee8cfc0c3e0597" category="paragraph">当BeeGFS在HA集群中运行时、所有BeeGFS服务和底层资源都由资源组中的Pacemaker管理。每个BeeGFS服务及其所依赖的资源都会配置到一个资源组中、以确保资源按正确顺序启动和停止、并放置在同一节点上。</block>
  <block id="de25b213ff1f6f931a4d9c0f59bbed69" category="paragraph">对于每个BeeGFS资源组、Pacemaker都会运行一个自定义BeeGFS监控资源、该资源负责检测故障情况、并在特定节点上无法再访问BeeGFS服务时智能地触发故障转移。</block>
  <block id="e33abb1ba19f563eaa662796e8b3021b" category="paragraph">下图显示了由Pacemaker控制的BeeGFS服务和依赖项。</block>
  <block id="5346cef6f7de3aac02ebdfc1ae9b6f27" category="inline-link">有关多模式的BeeGFS文档</block>
  <block id="c4ae8913dc1f6c9fed7961516b16defd" category="admonition">为了在同一节点上启动多个相同类型的BeeGFS服务、我们将Pacemaker配置为使用多模式配置方法启动BeeGFS服务。有关详细信息，请参见<block ref="bc179f675bb7a303402ecb902ab09448" category="inline-link-rx"></block>。</block>
  <block id="553c30108a127bc2c66537e58970be9e" category="paragraph">由于BeeGFS服务必须能够在多个节点上启动、因此每个服务(通常位于`/etc/beegfs`)的配置文件存储在用作该服务的BeeGFS目标的E系列卷之一上。这样、可能需要运行此服务的所有节点都可以访问此配置以及特定BeeGFS服务的数据。</block>
  <block id="39f54b8b12af6ae0edd74b4db43d9959" category="summary">NetApp上BeeGFS的硬件配置包括文件节点和网络布线。</block>
  <block id="a80f40a4cf172e4461c613d2afc0bade" category="doc">硬件配置</block>
  <block id="a6f76304e97d4b2df31a130d24073f88" category="section-title">文件节点配置</block>
  <block id="8e9473694bc8ee293e1f6c4f730ab4ed" category="paragraph">文件节点具有两个CPU插槽、这些插槽配置为单独的NUMA分区、其中包括对相同数量的PCIe插槽和内存的本地访问。</block>
  <block id="81fb4a697d99bad44c068f68db513e26" category="paragraph">InfiniBand适配器必须填充到相应的PCI提升板或插槽中、以便在可用的PCIe通道和内存通道上平衡工作负载。您可以通过将单个BeeGFS服务的工作完全隔离到特定NUMA节点来平衡工作负载。目标是从每个文件节点获得类似的性能、就像两个独立的单插槽服务器一样。</block>
  <block id="26dc1928abfabc3027cfa2e4f0b2f57f" category="paragraph">下图显示了文件节点NUMA配置。</block>
  <block id="cc560c8656cb52d0c2376a0dbb2ac436" category="paragraph">BeeGFS进程固定到特定的NUMA区域、以确保使用的接口位于同一区域。此配置可避免通过插槽间连接进行远程访问。插槽间连接有时称为QPI或GMI2链路；即使在现代处理器架构中、也可能会在使用诸如HDR InfiniBand等高速网络时成为瓶颈。</block>
  <block id="037505dd545df2577c95982dd52a9497" category="section-title">网络布线配置</block>
  <block id="2efc6e5efcfc3424383b80badbc6f2f8" category="paragraph">在一个构建块中、每个文件节点使用总共四个冗余InfiniBand连接连接连接到两个块节点。此外、每个文件节点还具有四个到InfiniBand存储网络的冗余连接。</block>
  <block id="c2b0d4abc479963299ef11f7007b04d9" category="paragraph">在下图中、请注意：</block>
  <block id="ccebd32ee2768501ecf2042e521d090c" category="list-text">绿色中所示的所有文件节点端口均用于连接到存储网络结构；所有其他文件节点端口均直接连接到块节点。</block>
  <block id="01be869a64586dc6df5d40be148742a7" category="list-text">特定NUMA区域中的两个InfiniBand端口连接到同一块节点的A和B控制器。</block>
  <block id="92d102b77ed7526653d6ed77bc5f9297" category="list-text">NUMA节点0中的端口始终连接到第一个块节点。</block>
  <block id="41d34f3f75f0a6f23825fec8c1f6b167" category="list-text">NUMA节点1中的端口连接到第二个块节点。</block>
  <block id="1109e0767ef0b323f02f85cdaa9a589d" category="paragraph">图中所示的布线配置允许每个BeeGFS服务：</block>
  <block id="12e9ec8c0cb3aa87bfb400a73712d79b" category="list-text">无论运行BeeGFS服务的文件节点是什么、都可以在同一NUMA区域中运行。</block>
  <block id="488f6220ee8bab2e1e3621f7f99b598c" category="list-text">无论故障发生在何处、都要有通向前端存储网络和后端块节点的二级最佳路径。</block>
  <block id="e2ae85c4e917fafc3b545710dcc3fdf1" category="list-text">如果块节点中的文件节点或控制器需要维护、则最大限度地降低性能影响。</block>
  <block id="33f3e0c9879fd051eb380c62267a24cf" category="paragraph">下图显示了用于利用完整PCIe双向带宽的布线设计。</block>
  <block id="1a72dacfce92d062255a929bbb18fc8d" category="paragraph">对于每个BeeGFS服务、请使用同一适配器将用于客户端流量的首选端口连接到作为该服务卷的主所有者的块节点控制器的路径。有关详细信息，请参见 <block ref="1ce6299bc86692b3e97783bdba904848" category="inline-link-macro-rx"></block>。</block>
  <block id="0dfb05d4ea761122194fbafcd7f3a5eb" category="summary">NetApp解决方案 上的BeeGFS的第二代设计已使用三个组件配置文件进行了验证。</block>
  <block id="57448c4b7cf64af279b612502ae49c08" category="doc">设计验证</block>
  <block id="dd444e75087c1912fb6b2f9435eec0ba" category="paragraph">配置配置文件包括以下内容：</block>
  <block id="ba33770125b7249843843e3524e48e5e" category="list-text">一个基础组件、包括BeeGFS管理、元数据和存储服务。</block>
  <block id="dc0ae690014a6e4ed1d17d728fce2e3a" category="list-text">BeeGFS元数据加上存储构建块。</block>
  <block id="f789cf74ad54c463cf1827c970b695c0" category="list-text">一个BeeGFS纯存储组件。</block>
  <block id="f27d4d7620b1158ad830c498a6faf1c5" category="paragraph">下图显示了用于验证NetApp解决方案 上的BeeGFS的BeeGFS配置。</block>
  <block id="dfa0c76fc554fa6837cfe216381eb3df" category="section-title">BeeGFS文件条带化</block>
  <block id="73bf7a09a102bdf9e2984ff15f2e62cc" category="paragraph">并行文件系统的一个优势是能够在多个存储目标之间对各个文件进行条带化、这可能表示同一个或不同底层存储系统上的卷。</block>
  <block id="f781a67c7f55c5a3d6d505e3569ff3c3" category="inline-link">条带化</block>
  <block id="0102b96fad09ea07b9b6c943ac48e706" category="inline-link">条带化API</block>
  <block id="be4c29766b20870006df2b27be87994e" category="paragraph">在BeeGFS中、您可以按目录和文件配置条带化、以控制每个文件使用的目标数量、并控制每个文件条带使用的机克大小(或块大小)。此配置允许文件系统支持不同类型的工作负载和I/O配置文件、而无需重新配置或重新启动服务。您可以使用`beegfs-ctl`命令行工具或对使用条带化API的应用程序应用条带设置。有关详细信息、请参见的BeeGFS文档<block ref="d307c57bb94d8613bf23053de378d367" category="inline-link-rx"></block> 和<block ref="d53017212bcf8a78d44d2efbf061a88a" category="inline-link-rx"></block>。</block>
  <block id="706c7a765e77b694cee17941887ccaaf" category="paragraph">为了获得最佳性能、我们在整个测试过程中对条带模式进行了调整、并记录了每个测试使用的参数。</block>
  <block id="a40727fe75676638a1b87009fafed260" category="section-title">IOR带宽测试：多个客户端</block>
  <block id="a4c77786e4208d299fbf0c491eb99106" category="inline-link">HPC GitHub</block>
  <block id="8b2e6032c8801b379e2fd75991ebb452" category="paragraph">IOR带宽测试使用OpenMPI运行合成I/O生成器工具IOR的并行作业(可从获取<block ref="323e2ec03a214c41088a20e514e0a41e" category="inline-link-rx"></block>)连接到一个或多个BeeGFS组件。除非另有说明：</block>
  <block id="219cae8db1869355f9c480a2fe2c5d6d" category="list-text">所有测试都使用传输大小为1 MiB的直接I/O。</block>
  <block id="de2223ae9c343f387e4a3549abf2a4fc" category="list-text">BeeGFS文件条带化设置为1 MB的机克大小、每个文件一个目标。</block>
  <block id="8aa2f9ce00cbab54a4479ba40f638773" category="paragraph">以下参数用于IOR、并对区块数进行了调整、以使一个组件的聚合文件大小保持在5 TiB、而三个组件的聚合文件大小保持在40 TiB。</block>
  <block id="a404b853baec85523834a070479317ea" category="paragraph">下图显示了一个BeeGFS基础(管理、元数据和存储)组件的IOR测试结果。</block>
  <block id="578da280bb783045852047cd081f65fd" category="paragraph">下图显示了一个BeeGFS元数据+存储组件的IOR测试结果。</block>
  <block id="720f0ab0184643d51a1197789875c393" category="paragraph">下图显示了一个BeeGFS纯存储组件的IOR测试结果。</block>
  <block id="e3b081c19738d20e5f52be67ac8d0361" category="paragraph">下图显示了三个BeeGFS组件的IOR测试结果。</block>
  <block id="9abc8771b8098ae505a1ff386b580ef3" category="paragraph">正如预期、基础组件与后续元数据+存储组件之间的性能差异可忽略不计。比较元数据+存储构建块和纯存储构建块后、由于用作存储目标的驱动器增加、读取性能略有提高。但是、写入性能没有显著差异。为了提高性能、您可以将多个组件添加到一起、以线性方式扩展性能。</block>
  <block id="7465e2f5afc6bc7ebff6ea05e19d52d3" category="section-title">IOR带宽测试：单个客户端</block>
  <block id="4cb463d8f88ac93de9fecb82d125d05c" category="paragraph">IOR带宽测试使用OpenMPI通过一个高性能GPU服务器运行多个IOR进程、以探索单个客户端可实现的性能。</block>
  <block id="6a2583bcd41d0a03702444d541162685" category="paragraph">此测试还会将客户端配置为使用Linux内核页面缓存(`tuneFileCacheType =原生`)时BeeGFS的重新读取行为和性能与默认的`缓冲区`设置进行比较。</block>
  <block id="0123881fd1c799161bf0cc847d402a42" category="paragraph">原生 缓存模式会在客户端上使用Linux内核页面缓存、从而使重新读取操作可以来自本地内存、而不是通过网络重新传输。</block>
  <block id="2748a8672e1df7ff75dc04c3e0086a44" category="paragraph">下图显示了三个BeeGFS组件和一个客户端的IOR测试结果。</block>
  <block id="2e301b61d3683cc584633009bafffa70" category="admonition">在这些测试中、BeeGFS条带化设置为1 MB的机克大小、每个文件有8个目标。</block>
  <block id="8c5eae70f19670232111d1823b5edb56" category="paragraph">尽管使用默认缓冲模式时写入和初始读取性能较高、但对于多次重新读取相同数据的工作负载、原生 缓存模式会显著提升性能。对于深度学习等工作负载来说、这种提高的重新读取性能非常重要、因为深度学习会在许多时间内多次重新读取同一数据集。</block>
  <block id="e9f3e979fd823256ea73296f49e954da" category="section-title">元数据性能测试</block>
  <block id="e3195dd21dbd9ee2c6c42f0c8a6c7128" category="paragraph">元数据性能测试使用MDTest工具(包含在IOR中)测量BeeGFS的元数据性能。这些测试利用OpenMPI在所有十个客户端节点上运行并行作业。</block>
  <block id="44ece23db4ca31ae5b81205ad387af00" category="paragraph">以下参数用于运行基准测试、其中进程总数从10扩展到320、步长为2倍、文件大小为4 k。</block>
  <block id="b872c01a040702b121dc5f52261e99e0" category="paragraph">元数据性能首先使用一到两个元数据+存储组件进行衡量、以显示性能如何通过添加更多组件进行扩展。</block>
  <block id="c6c65b36c5c466822447bc4c94abd80c" category="paragraph">下图显示了一个BeeGFS元数据+存储组件的MDTest结果。</block>
  <block id="5d4514dbb64a843f08caa7fe8140c121" category="paragraph">下图显示了包含两个BeeGFS元数据+存储组件的MDTest结果。</block>
  <block id="6bcc55d27d7ea16e6df55e7ec18fd377" category="section-title">功能验证</block>
  <block id="b15005270887e63f3c777c3722631021" category="paragraph">在验证此架构的过程中、NetApp执行了多项功能测试、其中包括：</block>
  <block id="008151af32cff92eed6431ca4cf43500" category="list-text">通过禁用交换机端口使单个客户端InfiniBand端口出现故障。</block>
  <block id="73b83d70be21d004da6e079b00bb5948" category="list-text">通过禁用交换机端口使单个服务器InfiniBand端口出现故障。</block>
  <block id="f7b8ad51ce1aad4a6e15c6583fcbdd55" category="list-text">使用BMC触发服务器立即关闭。</block>
  <block id="6148d6995d77c1b8b1bfd4c6f299162b" category="list-text">妥善地将节点置于备用状态并将服务故障转移到另一节点。</block>
  <block id="1cc77e3527f4ac004c8a5cdb5cac049e" category="list-text">妥善地将节点重新联机、并将服务故障恢复到原始节点。</block>
  <block id="908463015e2671e9d90b06353dabae03" category="list-text">使用PDU关闭其中一个InfiniBand交换机。所有测试均在压力测试期间执行、并在BeeGFS客户端上设置了`ssysSessionChecksEnabled：false`参数。未发现I/O错误或中断。</block>
  <block id="c49182dc0c7a70b9cd2e10853d9ec6c7" category="inline-link">ChangeLog</block>
  <block id="788a9659515e495b379621cac9040872" category="admonition">存在一个已知的问题描述 (请参见<block ref="9892b1a82a523d642c4ee2c76b765b8b" category="inline-link-rx"></block>)当BeeGFS客户端/服务器RDMA连接因主接口丢失(如`connInterfacesFile`中所定义)或BeeGFS服务器发生故障而意外中断时、活动客户端I/O可能会挂起多达十分钟、然后才能恢复。如果BeeGFS节点已妥善置于待机状态和待机状态并处于待机状态以进行计划内维护、或者正在使用TCP、则不会发生此问题描述。</block>
  <block id="7c6326491c77a63417df94790ba07083" category="inline-link">采用NetApp技术的NVIDIA DGX SuperPOD</block>
  <block id="2bf773d42bef6909b232e854a16b3ec1" category="summary">将Pacemaker和Corosync配置为扩展到五个组件以上。</block>
  <block id="22892d2f5bfdfba001a02572258cca62" category="doc">扩展到五个组件以上</block>
  <block id="cfd24c157d6cd9f200eb8c3cf68ee7ed" category="paragraph">您可以将Pacemaker和Corosync配置为扩展到五个组件(10个文件节点)以上。但是、较大的集群存在一些缺点、最终、Pacemaker和Corosync最多会占用32个节点。</block>
  <block id="9e59383f4d4ca677923852ae81323178" category="paragraph">NetApp仅测试了最多10个节点的BeeGFS HA集群；不建议或不支持将单个集群扩展到超过此限制的范围。但是、BeeGFS文件系统仍需要扩展到10个以上的节点、而NetApp已在NetApp解决方案 上的BeeGFS中对此进行了说明。</block>
  <block id="72799e21cef92db3ad98f7c0a923e398" category="paragraph">通过在每个文件系统中部署包含一个子块的多个HA集群、您可以扩展整个BeeGFS文件系统、而不受底层HA集群机制的任何建议限制或硬限制。在此情景中、请执行以下操作：</block>
  <block id="5c3bc488def3e9ba17589e3a75fdd5c0" category="list-text">创建一个新的Ansible清单以表示其他HA集群、然后省略配置另一个管理服务。请将每个附加集群`ha_cluster.yml`中的`beegfs_ha_mgmtd_floating_ip`变量指向第一个BeeGFS管理服务的IP。</block>
  <block id="321f3f6b80bc5f9c02e358e120fa74b0" category="list-text">在向同一文件系统添加其他HA集群时、请确保满足以下要求：</block>
  <block id="32e66ce3c599bce3fc21c5a5943b6f4d" category="list-text">BeeGFS节点ID是唯一的。</block>
  <block id="50b9a2f3bd2dc22b582e6e66d12bf0ff" category="list-text">与`group_vars`下的每个服务对应的文件名在所有集群中都是唯一的。</block>
  <block id="6219a68f7552d8328f7fc5df8510ffc3" category="list-text">BeeGFS客户端和服务器IP地址在所有集群中都是唯一的。</block>
  <block id="16d3c50a6b84c7701cadfdf721b74007" category="list-text">在尝试部署或更新其他集群之前、包含BeeGFS管理服务的第一个HA集群正在运行。</block>
  <block id="6f94cb93f82c2013e179dc630a5dd715" category="list-text">在每个HA集群各自的目录树中单独维护清单。</block>
  <block id="079e1a9e099799d390c677577618ecce" category="paragraph">尝试在一个目录树中混用多个集群的清单文件可能会导致发生原因 对BeeGFS HA角色聚合应用于特定集群的配置的方式产生问题。</block>
  <block id="f4250b17c613a290cad4edf8e2bab3fd" category="admonition">无需在创建新的HA集群之前将每个HA集群扩展到五个组件。在许多情况下、每个集群使用较少的组件会更易于管理。一种方法是将每个机架中的组件配置为HA集群。</block>
  <block id="d1da0cd6852302b521f35aeee065f5ea" category="summary">在NetApp解决方案 上部署BeeGFS时、请遵循最佳实践准则。</block>
  <block id="38b622e4d5c9d918330c81663f61a4e3" category="doc">查看最佳实践</block>
  <block id="d780de93793370946b2449b88a29b5ea" category="section-title">标准约定</block>
  <block id="b4d19c971bd6ad93985147c0ce9477c8" category="list-text">文件节点主机名按顺序编号(h01-HN)、机架顶部的数字较低、底部的数字较高。</block>
  <block id="7bf4bcec78c083e165c31432234ebef8" category="list-text">每个块节点由两个存储控制器组成、每个控制器都有自己的主机名。</block>
  <block id="1d6d5c920cb7d130fd45d8ced35ebec2" category="paragraph">存储阵列名称用于在Ansible清单中引用整个块存储系统。存储阵列名称应按顺序编号(A01 - A)、各个控制器的主机名均根据该命名约定派生。</block>
  <block id="a902add826ee667d7f067acb8b49432f" category="list-text">同一构建块中的文件和块节点共享相同的编号方案、并在机架中彼此相邻、两个文件节点位于顶部、两个块节点位于其正下方。</block>
  <block id="2761f73c104511b8aaeef2eb6c84f3d3" category="paragraph">例如、在第一个构建块中、文件节点h01和h02都直接连接到块节点A01和A02。主机名依次为h01、h02、A01和A02。</block>
  <block id="33324ee77729f51ada2c5446c9c21488" category="list-text">组件会根据主机名按顺序进行安装、因此、编号较低的主机名位于机架顶部、编号较高的主机名位于底部。</block>
  <block id="afdf73d1fa37280d63c602fa6be27740" category="paragraph">其目的是最大限度地缩短连接到机架交换机顶部的缆线长度、并定义标准部署实践以简化故障排除。对于因机架稳定性问题而不允许这样做的数据中心、当然也允许使用相反方法、即从下往上填充机架。</block>
  <block id="b4c0fb3649e4f85d78611d90d2d2d308" category="section-title">InfiniBand存储网络配置</block>
  <block id="815b2630d684df2f4894bd753d3a1fcb" category="paragraph">每个文件节点上一半的InfiniBand端口用于直接连接到块节点。另一半连接到InfiniBand交换机、并用于BeeGFS客户端-服务器连接。在确定用于BeeGFS客户端和服务器的IPoIB子网的大小时、您必须考虑计算/GPU集群和BeeGFS文件系统的预期增长。如果您必须偏离建议的IP范围、请注意、一个构建块中的每个直接连接都有一个唯一的子网、并且与用于客户端-服务器连接的子网没有重叠。</block>
  <block id="a4f2d907e6fd183bbbc4d275c08b7a9a" category="section-title">直接连接</block>
  <block id="07a0544547e3cceec6f669bd25c6a605" category="paragraph">每个构建块中的文件和块节点始终使用下表中的IP进行直接连接。</block>
  <block id="d9938c4beed355ac7387d03d8f191c9e" category="admonition">此寻址方案遵循以下规则：第三个八位字节始终为奇数或偶数、具体取决于文件节点是奇数还是偶数。</block>
  <block id="b55e37e80a68661366be8c4377b13489" category="cell">文件节点</block>
  <block id="90c8d508b315842cddaf605e8e068d6f" category="cell">IB端口</block>
  <block id="75ba8d70e3692ba200f0e0df37b4d2ae" category="cell">IP 地址</block>
  <block id="d7f9ab96aecba4fb98ecf8831eb0a462" category="cell">块节点</block>
  <block id="b9549a36d11b47e2d2f9389f6363ff8e" category="cell">物理IP</block>
  <block id="0d01a155a448abaa8ab4b0bdd3ea5e54" category="cell">虚拟IP</block>
  <block id="e9813c434db44aa063e37598de3ed515" category="cell">奇数(H1)</block>
  <block id="9d928738606162dca1d244ffcbdf0036" category="cell">i1a</block>
  <block id="8f337c973339dd7093883bd28ddb6588" category="cell">192.168.1.10</block>
  <block id="495cb471115cc2dbd5c60736f989aa8c" category="cell">奇数(C1)</block>
  <block id="e36314e624d2b2ca257e1f1ecb381f93" category="cell">2a.</block>
  <block id="d984a05fa268b7cc6ac052a38960aeb2" category="cell">192.168.1.100</block>
  <block id="80f8cac1e092ca14301921951cf77f91" category="cell">192.168.1.101</block>
  <block id="c7a617044afee64ec7d511879e8b194c" category="cell">I2a.</block>
  <block id="d731a116ccfe40ce4a5adb1bf565d785" category="cell">192.168.3.10</block>
  <block id="a9aeb028763672267b98adb1e61f06ca" category="cell">192.168.3.100</block>
  <block id="868e778e153cfafee02c89678e31e3e4" category="cell">192.168.3.101</block>
  <block id="b723decd732b31d828ae939f8f8c81fb" category="cell">i3a</block>
  <block id="28013a9391888f81944ead3ec1401cb0" category="cell">192.168.5.10</block>
  <block id="cfb1a9d899157fd3919c08dceff7fe61" category="cell">偶数(C2)</block>
  <block id="8945c747c6a4da714083579891b2495a" category="cell">192.168.5.100</block>
  <block id="538f8a364ff4308c16dbf7a80a554b5f" category="cell">192.168.5.101</block>
  <block id="d4d9efce9a26c8551723c677f65e1284" category="cell">i4a</block>
  <block id="7e7269d72492d715bbd00efdcdec7e0a" category="cell">192.168.7.10</block>
  <block id="1fbf861a0f4d9494682cfff33756b7aa" category="cell">192.168.7.100</block>
  <block id="7a1a4e2ee2757f302d47c7e3cdc8fcc3" category="cell">192.168.7.101</block>
  <block id="1442135832b351ed9b2f3b91f2393ec7" category="cell">偶数(H2)</block>
  <block id="0522334c503ae8e87d77104f7b27ba17" category="cell">192.168.2.10</block>
  <block id="f8bc2fbe2c937ea5b5e8839cbea69491" category="cell">2亿</block>
  <block id="28de33b5199547c2f026595b7175a940" category="cell">192.168.2.100</block>
  <block id="d006845bf7fd39e054131ca6f76c2c47" category="cell">192.168.2.101</block>
  <block id="3a1cc00317003b20386d92ca13328e3d" category="cell">192.168.4.10</block>
  <block id="ccce62893693ca1e63992fa77159dce3" category="cell">192.168.4.100</block>
  <block id="eab39d2ba2b7a903ccf8cef112e1d506" category="cell">192.168.4.101</block>
  <block id="02def76181eddeab3ec0492be002417d" category="cell">192.168.6.10</block>
  <block id="d4b42e0f0d80e9c910e062f49b48b5f5" category="cell">192.168.6.100</block>
  <block id="f23edf799227dfd20d80544836aad8e9" category="cell">192.168.6.101</block>
  <block id="5e0ca78bea1b6ed4af93b1b1c5d7c573" category="cell">192.168.8.10</block>
  <block id="3581177979a7b934a2accd3f5f999444" category="cell">192.168.8.100</block>
  <block id="49213c8f0e8758438d7a69e2789a8b7d" category="cell">192.168.8.101</block>
  <block id="5e98efce8292b94590f3ca502c1d8697" category="paragraph">每个文件节点都运行多个BeeGFS服务器服务(管理、元数据或存储)。为了使每个服务能够独立故障转移到另一个文件节点、每个服务都配置了唯一的IP地址、这些地址可以在两个节点之间浮动(有时称为逻辑接口或LIF)。</block>
  <block id="4db8c0036deb36a38e4df4660af9ed06" category="paragraph">此部署虽然不是必需的、但假定这些连接正在使用以下IPoIB子网范围、并定义了一个标准寻址方案、该方案将应用以下规则：</block>
  <block id="8d41eefa8441a4ca177fe0f2676a9512" category="list-text">根据文件节点InfiniBand端口是奇数还是奇数、第二个八位字节始终是奇数甚至偶数。</block>
  <block id="6482f8ef9c5ff1d8a971601fcad837d6" category="list-text">BeeGFS集群IP始终为`xxx。127.100.yyy`或`xxx.128.100.yyy`。</block>
  <block id="3aed58e1cc4af0e5cda8b7e10e2fd863" category="admonition">除了用于带内操作系统管理的接口之外、Corosync还可以使用其他接口进行集群检测和同步。这样可以确保丢失一个接口不会导致整个集群关闭。</block>
  <block id="d95a2f19c705379e32f8030de274d07e" category="list-text">BeeGFS管理服务始终为`xxx.yyy.101.0`或`xxx.yyy.102.0`。</block>
  <block id="29cd1587ba2833db9af29eac16f0d72b" category="list-text">BeeGFS元数据服务始终位于`xxx.yyy.101.zzz`或`xxx.yyy.102.zzz`。</block>
  <block id="be092b10130fe0c97dd9358f0c131935" category="list-text">范围`100.xxx.1.1`到`100.xxx.99.255`的地址是为客户端预留的。</block>
  <block id="3ac8c958d4c77187295fd53646229e9e" category="paragraph">下表提供了子网A的范围：100.127.0.0/16。</block>
  <block id="261addf78c7b2c961032b3dd08ba0b1f" category="cell">目的</block>
  <block id="8433249cf732856c8ef7700f591da923" category="cell">InfiniBand端口</block>
  <block id="5c43713485260d7759e7710e65d5b181" category="cell">IP地址或范围</block>
  <block id="32e90ecbd165097494e967a23490ee41" category="cell">BeeGFS集群IP</block>
  <block id="16bfa5161249dae15f8c441a34126387" category="cell">i1b</block>
  <block id="fcb936b16dcf3c23dec73fa21c9c16f1" category="cell">100.127.100.1 - 100.127.100.255</block>
  <block id="ae709a18a45df821c97f171d87abda05" category="cell">BeeGFS管理</block>
  <block id="ca46d9d01d96136b3bd1dea0bce8b99f" category="cell">100.127.101.0</block>
  <block id="c7725fe17ccf0fe6dfa72467bca22d07" category="cell">BeeGFS元数据</block>
  <block id="2aaea2be17c5c489bc5ec00da30f01e0" category="cell">i1b或i3b</block>
  <block id="5474dd17966e980dee3133c4fdddcf29" category="cell">100.127.101.1 - 100.127.101.255</block>
  <block id="d01488abddf6343d229f4a687a740a9d" category="cell">BeeGFS存储</block>
  <block id="43c64dcbdc9c36edb0a78b932e87b96c" category="cell">100.127.103.1 - 100.127.103.255</block>
  <block id="7b0215ed75674e2bc6f9d23b5db3a59a" category="cell">BeeGFS客户端</block>
  <block id="12ad67de237d3ee3ee2ca3ed39a93826" category="cell">(因客户端而异)</block>
  <block id="88bd43ac89ad7875c3db7323b9879d13" category="cell">100.127.1.1 - 100.127.99.255</block>
  <block id="00ee8ecc0f95892eb58786ee6e94e4e7" category="paragraph">下表提供了子网B的范围：100.128.0.0/16。</block>
  <block id="42e7db8b69b0d0451fe5e7e94d271956" category="cell">i4b.</block>
  <block id="672e53647fb3fbb550b46ac1eaaad363" category="cell">100.128.100.1 - 100.128.100.255</block>
  <block id="50641838fba9970d18ab721f2d775331" category="cell">i2b.</block>
  <block id="6240652cf0cb3a0056e31569edba6f3e" category="cell">100.128.102.0</block>
  <block id="6bbae520cb1416f9508d58010c4df4a0" category="cell">i2b或i4b</block>
  <block id="3ac8689fd677355ec3c1098b78d717dd" category="cell">100.128.102.1 - 100.128.102.255</block>
  <block id="61b0ff8b431abb2cad4481cab938c338" category="cell">100.128.104.1 - 100.128.104.255</block>
  <block id="83dc7e1fb9aa3660d2fc0ccb6e72bd1a" category="cell">100.128.1.1 - 100.128.99.255</block>
  <block id="cd42d4848d52f3ad668601f29b839282" category="admonition">并非上述范围内的所有IP都用于此经过NetApp验证的架构。它们展示了如何预先分配IP地址、以便使用一致的IP寻址方案轻松扩展文件系统。在此方案中、BeeGFS文件节点和服务ID与已知IP范围中的第四个八位字节相对应。如果需要、文件系统可以扩展到255个节点或服务以上。</block>
  <block id="ce0a47ccdc84e9c90b9185aea530a07b" category="summary">要支持NetApp解决方案 上的BeeGFS、需要使用特定的设备、布线和配置、该BeeGFS并行文件系统与NetApp EF600存储系统相结合。</block>
  <block id="7cac973d2abc65a232606799a99be23c" category="paragraph">了解更多信息。</block>
  <block id="6ee419ed5a936cfed45771da0b746c94" category="list-text"><block ref="6ee419ed5a936cfed45771da0b746c94" category="inline-link-macro-rx"></block></block>
  <block id="1ce6299bc86692b3e97783bdba904848" category="list-text"><block ref="1ce6299bc86692b3e97783bdba904848" category="inline-link-macro-rx"></block></block>
  <block id="2c39c30b16a5c14e4b3bd73361f541c5" category="list-text"><block ref="2c39c30b16a5c14e4b3bd73361f541c5" category="inline-link-macro-rx"></block></block>
  <block id="b7f5b93ad68dd5ab95107b85145443e8" category="list-text"><block ref="b7f5b93ad68dd5ab95107b85145443e8" category="inline-link-macro-rx"></block></block>
  <block id="9db3ca538820d0cfb7b44ef80f16ca98" category="inline-link-macro">性能调整</block>
  <block id="a51906ad0f905e303cf3b09d82ec1db0" category="list-text"><block ref="a51906ad0f905e303cf3b09d82ec1db0" category="inline-link-macro-rx"></block></block>
  <block id="730b718214a170296ed598158264e021" category="summary">BeeGFS解决方案 提供了基于验证测试的性能调整建议。</block>
  <block id="a49e13cf9bc8e242e7b828e3c9016699" category="paragraph">虽然BeeGFS可提供合理的即装即用性能、但NetApp已开发出一组建议的调整参数来最大限度地提高性能。这些参数考虑了底层E系列块节点的功能以及在共享磁盘HA架构中运行BeeGFS所需的任何特殊要求。</block>
  <block id="6900084f28039c00033899865271a4b5" category="section-title">文件节点的性能调整</block>
  <block id="7ed4e287a78a4cc348d1e60d143ceda8" category="paragraph">您可以配置的可用调整参数包括：</block>
  <block id="d8eb1bf5eeddb34869fa0aee2c5c3be0" category="list-text">*文件节点的UEFI/BIOS中的系统设置。*为最大限度地提高性能、建议在用作文件节点的服务器型号上配置系统设置。在设置文件节点时、您可以使用由基板管理控制器(BMC)提供的系统设置(UEFI/BIOS)或Redfish API来配置系统设置。</block>
  <block id="bb2fcb1abe8d0829558e398d9acb4589" category="inline-link-macro">调整文件节点系统设置以提高性能</block>
  <block id="adecdfd501fe0c9f7674b95abecb661b" category="paragraph">系统设置因用作文件节点的服务器型号而异。必须根据所使用的服务器型号手动配置这些设置。要了解如何为经过验证的联想SR665文件节点配置系统设置、请参见 <block ref="891cfd1f8dbb99c09432be0144a5be81" category="inline-link-macro-rx"></block>。</block>
  <block id="6721128d9ea380f9965cc220f28619e1" category="list-text">*所需配置参数的默认设置。*所需配置参数会影响BeeGFS服务的配置方式以及Pacemaker对E系列卷(块设备)进行格式化和挂载的方式。这些必需的配置参数包括：</block>
  <block id="93de4dab2e303d649f94f0880095e6ef" category="list-text">BeeGFS服务配置参数</block>
  <block id="c5b3473e89672cc155d0436c6e60bd52" category="inline-link">BeeGFS服务配置参数</block>
  <block id="334a50f926a902a241ecfae54f3cce32" category="list-text">卷格式化和挂载参数设置为建议的默认值、只能针对高级使用情形进行调整。默认值将执行以下操作：</block>
  <block id="4b9b870ed7f3db8f28c2ddcf4d3bd986" category="list-text">根据目标类型(例如管理、元数据或存储)以及底层卷的RAID配置和分段大小优化初始卷格式化。</block>
  <block id="9f641b3b08e18d35b2219dee293e2038" category="list-text">调整Pacemaker挂载每个卷的方式、以确保所做的更改立即刷新到E系列块节点。这样可以防止在文件节点发生故障且正在进行活动写入时丢失数据。</block>
  <block id="72247689b02927b1ceac4fb69e6c9954" category="inline-link">卷格式化和挂载配置参数</block>
  <block id="c5d80eb8c0726de2a9804385295dc0e3" category="paragraph">默认设置用于验证NetApp解决方案 上的BeeGFS、但您可以对其进行更改、以便根据您的特定工作负载或使用情形进行调整。您可以更改的Linux操作系统设置示例包括：</block>
  <block id="b56281fe1e5f14da49b6d1d4c6ad0cd9" category="list-text">E系列块设备上的I/O队列。</block>
  <block id="43a8170c4aebbb467c4d4b59d77a7662" category="paragraph">您可以在用作BeeGFS目标的E系列块设备上配置I/O队列、以便：</block>
  <block id="ce0213a2bd6755f2eacf9574b2b56dda" category="list-text">根据设备类型(NVMe、HDD等)调整计划算法。</block>
  <block id="c78d3d0bdafa5fc5623e3d56a9cc33ce" category="list-text">增加未处理的请求数。</block>
  <block id="b785a1945e736aa8340d2e4bde128b82" category="list-text">调整请求大小。</block>
  <block id="a9a2c451a0c5c7939a07afe7cd297216" category="list-text">优化预读行为。</block>
  <block id="f39721f45b17814f0740b3c066ca0b66" category="list-text">虚拟内存设置。</block>
  <block id="552afad9cf059c34e2ed8d24ff34fc12" category="paragraph">您可以调整虚拟内存设置、以获得最佳的持续流性能。</block>
  <block id="aa8e8d4d1817c4e08c70cd3c1b4c89b9" category="list-text">CPU设置。</block>
  <block id="423dd652f980ba19cb7fb7f577576270" category="paragraph">您可以调整CPU频率调速器和其他CPU配置、以获得最高性能。</block>
  <block id="eb2cf8d186779ea110100038f3ec2e90" category="list-text">读取请求大小。</block>
  <block id="ba4dcc8d5b46a4c30176506ef828aea4" category="section-title">对块节点进行性能调整</block>
  <block id="4f59030dbd3da04d4b74738f5149fffb" category="paragraph">根据应用于特定BeeGFS组件的配置文件、在块节点上配置的卷组会略有变化。例如、对于一个24驱动器EF600块节点：</block>
  <block id="841fc343eee01328e222ebada200ca5d" category="list-text">对于单个基础组件、包括BeeGFS管理、元数据和存储服务：</block>
  <block id="bbea55f4794f89e45fe7c40eaf8ca3ee" category="list-text">1个2+2 RAID 10卷组、用于BeeGFS管理和元数据服务</block>
  <block id="92f2b7b47db52c081f552bd884a78ae7" category="list-text">2个8+2 RAID 6卷组、用于BeeGFS存储服务</block>
  <block id="4f4960028dfd13311a5679d2450101d1" category="list-text">对于BeeGFS元数据+存储构建块：</block>
  <block id="fdd7b1bdaea27f32d5925fd1a957fce4" category="list-text">1个2+2 RAID 10卷组、用于BeeGFS元数据服务</block>
  <block id="196fdf9280847a2a4a9ddd0b8520bdfb" category="list-text">仅限BeeGFS存储组件：</block>
  <block id="632ac8eccac17a8789dd33202130e509" category="list-text">2个10+2 RAID 6卷组、用于BeeGFS存储服务</block>
  <block id="014e85e7f3bbdad1ad6f193e82d21755" category="inline-link-macro">部署说明</block>
  <block id="39b751cb17d740944bc5071eba1abda2" category="admonition">与存储相比、BeeGFS对管理和元数据所需的存储空间要少得多、因此可以选择为RAID 10卷组使用较小的驱动器。较小的驱动器应填充到最外侧的驱动器插槽中。有关详细信息，请参见 <block ref="92eed053ec15880d36275e60ab80275b" category="inline-link-macro-rx"></block>。</block>
  <block id="1708794637b71b8aadfa80d503ccc505" category="paragraph">所有这些设置均由基于Ansible的部署进行配置、此外、通常还建议使用其他几种设置来优化性能/行为、其中包括：</block>
  <block id="b02fbba0a56e144e15b688980d01275a" category="list-text">将全局缓存块大小调整为32 KiB、并将基于需求的缓存刷新调整为80%。</block>
  <block id="c70b65aef502812d5a0e8a4b173334d9" category="list-text">禁用自动加载平衡(确保控制器卷分配保持预期状态)。</block>
  <block id="94966bf9df1a2fb2442d06d53723f28e" category="list-text">启用读取缓存和禁用预读缓存。</block>
  <block id="65f3cbabf1e92d0ce2d27d87d85a3c5a" category="list-text">通过镜像启用写入缓存并要求使用电池备份、以便在块节点控制器发生故障时保持缓存不变。</block>
  <block id="dfb95cf8b58d92dcb47401bae0964c5d" category="list-text">指定驱动器分配给卷组的顺序、在可用驱动器通道之间平衡I/O。</block>
  <block id="2260cb128d87141c6a0a2c06c043def7" category="summary">定义了常规Ansible清单结构后、为BeeGFS文件系统中的每个组件定义配置。</block>
  <block id="b8bb1668a8a0007267670827d99f76b5" category="paragraph">这些部署说明演示了如何部署文件系统、该文件系统由包括管理、元数据和存储服务在内的基础组件、包含元数据和存储服务的第二个组件以及仅存储的第三个组件组成。</block>
  <block id="bc4ca1def58917532e653ebf4c3c5f15" category="paragraph">这些步骤旨在显示一系列典型配置文件、您可以使用这些配置文件来配置NetApp BeeGFS组件、以满足整个BeeGFS文件系统的要求。</block>
  <block id="053cdc4e7aa5884fba5be0b7e80bcb5c" category="admonition">在本节及后续章节中、根据需要进行调整、以构建表示要部署的BeeGFS文件系统的清单。特别是、请使用表示每个块或文件节点的Ansible主机名以及存储网络所需的IP寻址方案、以确保它可以扩展到BeeGFS文件节点和客户端的数量。</block>
  <block id="e00187948ca315221e5e284a4312f83f" category="section-title">第1步：创建Ansible清单文件</block>
  <block id="cbdf4dddad7bf23198edcbf2c8721659" category="list-text">创建新的`inventory.yml`文件、然后插入以下参数、根据需要替换`Esery_storage_systems`下的主机、以表示部署中的块节点。这些名称应与`host_vars/&lt;filename&gt;.yml`使用的名称相对应。</block>
  <block id="742c9db30f264a7d33e72383a817b4f5" category="paragraph">在后续各节中、您将在`ha_cluster`下创建其他Ansible组、这些组表示您要在集群中运行的BeeGFS服务。</block>
  <block id="066251bf9494493f76299f6f40a80df6" category="section-title">第2步：为管理、元数据和存储组件配置清单</block>
  <block id="5320d481bd8442fec42afcaded2a8d49" category="paragraph">集群或基础构建块中的第一个组件必须包括BeeGFS管理服务以及元数据和存储服务：</block>
  <block id="a54299a446e0a2e17f57383db8e31dc6" category="list-text">在`inventory.yml`中、在`ha_cluster下填充以下参数：子项`：</block>
  <block id="fd84d0d4501e2eca409dc18043cf1492" category="list-text">创建文件`group_vars/mgmt.yml`并包含以下内容：</block>
  <block id="bcc9cdaf60435f4d091a1bfdac879201" category="list-text">在`group_vars/`下、使用以下模板为资源组`mETA_01`到`mETA_08`创建文件、然后参考下表填写每个服务的占位值：</block>
  <block id="3df790a0a0a3be54d9cbac91d4bc35e1" category="inline-link">NetApp EF600阵列简介</block>
  <block id="4ada98602970473e524def1d48723bd6" category="admonition">卷大小以整个存储池(也称为卷组)的百分比形式指定。NetApp强烈建议您在每个池中保留一些可用容量、以便为SSD过度配置留出空间(有关详细信息、请参见<block ref="dfc1025f9a756c10e6b0cbe0f4bc500a" category="inline-link-rx"></block>）。存储池`beegfs_m1_m2_m3_m3_m6`也会将池容量的1%分配给管理服务。因此、对于存储池中的元数据卷`beegfs_m1_m2_m5_m6`、如果使用1.92 TB或3.84 TB驱动器、请将此值设置为`21.25`；对于7.65 TB驱动器、请将此值设置为`22.25`；对于15.3 TB驱动器、请将此值设置为`23.75`。</block>
  <block id="34082694d21dbdcfc31e6e32d9fb2b9f" category="cell">文件名</block>
  <block id="60aaf44d4b562252c04db7f98497e9aa" category="cell">Port</block>
  <block id="b1cddc6c78e92a26b8976dc97327d412" category="cell">浮动IP</block>
  <block id="72159601fc6c3d952cc9825d610ddd68" category="cell">NUMA区域</block>
  <block id="40cf615dcacf5ec5faf6a3cdf1ff5a6e" category="cell">存储池</block>
  <block id="cdd25d91a2d0aca59a80f91cfe9af9de" category="cell">所属控制器</block>
  <block id="f4d0c8022be4f31d06814c33705037ff" category="cell">meta_01.yml</block>
  <block id="1f7aa6705d5b742085538c627f6f9c2b" category="cell">8015</block>
  <block id="cfcd208495d565ef66e7dff9f98764da" category="cell">0</block>
  <block id="7ef878b8d47cf2658a8b7e4c1b8f133d" category="cell">beegfs_m1_m2_m3_m3_m6</block>
  <block id="7fc56270e7a70fa81a5935b72eacbe29" category="cell">答</block>
  <block id="60b1afbaab870bf5621ed87ae12559fe" category="cell">meta_02.yml</block>
  <block id="62d2b7ba91f34c0ac08aa11c359a8d2c" category="cell">8025</block>
  <block id="9d5ed678fe57bcca610140957afab571" category="cell">B</block>
  <block id="3ce592406a461bfadfa5ab1f08c5c506" category="cell">meta_03.yml</block>
  <block id="a2b8a85a29b2d64ad6f47275bf1360c6" category="cell">8035</block>
  <block id="c4ca4238a0b923820dcc509a6f75849b" category="cell">1.</block>
  <block id="c229ea898f8c27aeb40c65332e30db3f" category="cell">beegfs_m3_m4_m7_m8</block>
  <block id="7f6482de225123824ca5b23c1cf79f05" category="cell">meta_04.yml</block>
  <block id="704cddc91e28d1a5517518b2f12bc321" category="cell">8045</block>
  <block id="833a23c43dc9c206a593873d80d04903" category="cell">meta_05.yml</block>
  <block id="444b0d9a802792791bb9a2da568b463d" category="cell">8055</block>
  <block id="38774c8cd9de3fd76c7df6b0746f2f2b" category="cell">meta_06.yml</block>
  <block id="320e4df890a1a620573db8170f39a093" category="cell">8065</block>
  <block id="5a681b3e1f7ad2d965284e36f4f6b7d3" category="cell">meta_07.yml</block>
  <block id="ede529dfcbb2907e9760eea0875cdd12" category="cell">8075</block>
  <block id="a9cc3f3ebc7a8daedf369af06faba518" category="cell">meta_08.yml</block>
  <block id="5011bf6d8a37692913fce3a15a51f070" category="cell">8085</block>
  <block id="89f0938aa83de82ca99f8b06297ed69c" category="list-text">在`group_vars/`下、使用以下模板为资源组`stor_01`到`stor_08`创建文件、然后参考以下示例填写每个服务的占位值：</block>
  <block id="9b62ac6b206ab6cafe8dafa0990559c7" category="inline-link-macro">建议的存储池过度配置百分比</block>
  <block id="ab2ec57b0e9afdc73bcc69a962ee35c4" category="admonition">有关要使用的正确大小、请参见 <block ref="152d8bea233357f34ffa00ccf219bae3" category="inline-link-macro-rx"></block>。</block>
  <block id="b627976db3394ccf24342632cef6f4f1" category="cell">STOR_01.yml</block>
  <block id="40f4da34bbe180214c23b9e55da4f772" category="cell">8013</block>
  <block id="5ef33d06ff783e8453c10b95db8c1253" category="cell">beegfs_s1_s2</block>
  <block id="70963f6e36ca66556bef5f6ae74ad0ad" category="cell">STOR_02.yml</block>
  <block id="1ecdec353419f6d7e30857d00d0312d1" category="cell">8023</block>
  <block id="a4253b13d64a7017467d335c0c147ed3" category="cell">STOR_03.yml</block>
  <block id="fc5b3186f1cf0daece964f78259b7ba0" category="cell">8033</block>
  <block id="a3cc9ef3e643fd2d2e1b6c2672b1c361" category="cell">beegfs_s3_s4.</block>
  <block id="d471f1c4be4f658b822b7cfcfc808efa" category="cell">STOR_04.yml</block>
  <block id="5bd529d5b07b647a8863cf71e98d651a" category="cell">8043</block>
  <block id="6a0625f228a1c5802a3d0ca970c7ebac" category="cell">STOR_05.yml</block>
  <block id="dfccdb8b1cc7e4dab6d33db0fef12b88" category="cell">8053</block>
  <block id="2ac54a6d92aca96fef8d0eac5b813f34" category="cell">beegfs_s5_s6</block>
  <block id="09da1a861f10d113069c5e1da9d2decd" category="cell">STOR_06.yml</block>
  <block id="8d1f1aac0dd8a76b49e8bbdda0c7c98c" category="cell">8063</block>
  <block id="cf124e58023b3726106af9c8718a48ed" category="cell">STOR_07.yml</block>
  <block id="ffa9b486ad206c638c657b7ed335635c" category="cell">8073.</block>
  <block id="3e96e523215f928a3915e79e1451e2e7" category="cell">beegfs_s7_s8.</block>
  <block id="0e4b036746af52a755e4b546698b2b61" category="cell">STOR_08.yml</block>
  <block id="20ef119e812e178ecb44efa448b57ebc" category="cell">8083.</block>
  <block id="80e0c052ed9f2bde54c56adb04f880f1" category="section-title">第3步：为元数据+存储构建块配置清单</block>
  <block id="9e701ac8f2dd669a0e51464b4d8e3331" category="paragraph">以下步骤介绍如何为BeeGFS元数据+存储构建块设置Ansible清单。</block>
  <block id="ff1cbf3210fb9b21912445c6ea8cb9f6" category="list-text">在`inventory.yml`中、在现有配置下填充以下参数：</block>
  <block id="628d1b90e1a21bbcec24af78377f8297" category="list-text">在`group_vars/`下、使用以下模板为资源组`mETA_09`到`mETA_16`创建文件、然后参考以下示例填写每个服务的占位值：</block>
  <block id="bc5e8003da73758b95c46194672943bb" category="admonition">有关要使用的正确大小、请参见 <block ref="152d8bea233357f34ffa00ccf219bae3" category="inline-link-macro-rx"></block>。</block>
  <block id="9c6de3c786b8c9c409de2fd8070e5072" category="cell">meta_09.yml</block>
  <block id="2ea9f3181dbee99d651a0d6c53be4a36" category="cell">Beegfs_M9_M10_M13_M14</block>
  <block id="f370a281056494e99bcade5ddef17b26" category="cell">meta_10.yml</block>
  <block id="27f563eed2131061540c21a6239b43d8" category="cell">meta_11.yml</block>
  <block id="7c335ef1ce51db644c52518580d45d49" category="cell">Beegfs_M11_M12_M15_16</block>
  <block id="a2a3007e91ab84d40e9453997468f1ad" category="cell">meta_12.yml</block>
  <block id="14c79c2a227a377885225e0f4dcf53b0" category="cell">meta_13.yml</block>
  <block id="07e72a8a343c421129dc3a92902de565" category="cell">meta_14.yml</block>
  <block id="d4d36ef3d915a0d2eaac8c62f1d8eff6" category="cell">meta_15.yml</block>
  <block id="b465a4b4c591a6f2e44fedac80e726d0" category="cell">meta_16.yml</block>
  <block id="91e38d134a7ca4a23006b0cf023d9011" category="list-text">在`group_vars/下、`使用以下模板为资源组`stor_09`到`stor_16`创建文件、然后参考以下示例填写每个服务的占位值：</block>
  <block id="ca61951791cd6f4d50294a908b9eee76" category="admonition">有关要使用的正确大小、请参见 <block ref="152d8bea233357f34ffa00ccf219bae3" category="inline-link-macro-rx"></block>...</block>
  <block id="71c1385fcc844d118e8b2688b0cfd2d6" category="cell">STOR_09.yml</block>
  <block id="9282f3f43896f146dcbcc2d03d530b59" category="cell">beegfs_s9_s10</block>
  <block id="8f72ae1bf7ca7b8218a4bf9e719f5e7d" category="cell">STOR_10.yml</block>
  <block id="e5a3d4f42adb756f3b3c2e3ed045e4a8" category="cell">STOR_11.yml</block>
  <block id="6e4cec4b32bddd9c9a3574aacee223b6" category="cell">beegfs_s11_s12</block>
  <block id="05fd4833433a12b38d11d8045aebddff" category="cell">STOR_12.yml</block>
  <block id="437037bccd34f3db0b238843b50fe65a" category="cell">STOR_13.yml</block>
  <block id="7db433542754f496e2d707f51bf00c05" category="cell">beegfs_s13_s14</block>
  <block id="b3c4ed6c5b5c833713923f9e9bdfb9b9" category="cell">STOR_14.yml</block>
  <block id="4871ef58b7b91db78d33bb4d95e4bf27" category="cell">STOR_15.yml</block>
  <block id="b1a9c1cb2640dd5bc9fb4e80dda30200" category="cell">beegfs_s15_s16</block>
  <block id="b02a9cdb541eba39e680a1da9c6299c7" category="cell">STOR_16.yml</block>
  <block id="dea1f079dcd8c8280e07dcd96ea8c075" category="section-title">第4步：为纯存储组件配置清单</block>
  <block id="711be1acedea341e1f5455f007cdb22b" category="paragraph">以下步骤介绍如何为BeeGFS纯存储组件设置Ansible清单。设置元数据+存储与仅存储组件的配置之间的主要区别是、省略了所有元数据资源组、并将每个存储池的`Criteria_drive_count`从10更改为12。</block>
  <block id="5b6fe069463b7f5581a1864de036e765" category="list-text">在`group_vars/`下、使用以下模板为资源组`stor_17`到`stor_24`创建文件、然后参考以下示例填写每个服务的占位值：</block>
  <block id="80f4c22d8a78e5d96cdf5bef28444426" category="admonition">有关要使用的正确大小、请参见 <block ref="152d8bea233357f34ffa00ccf219bae3" category="inline-link-macro-rx"></block>。</block>
  <block id="f9838993bed3d0e550ae346ed2e4355e" category="cell">STOR_17.yml</block>
  <block id="8cf4aacf94a115dfc0190ee6782190d3" category="cell">beegfs_s17_s18</block>
  <block id="7876b49b042d07da9a565db780a9b186" category="cell">STOR_18.yml</block>
  <block id="291847ab33dfc1d81beed13f4d7a0519" category="cell">STOR_19.yml</block>
  <block id="6a972920f626e0b0b8d505315beaf38b" category="cell">beegfs_s19_s20</block>
  <block id="943a4f354a2af18dac1fe2a6e14fe880" category="cell">STOR_20.yml</block>
  <block id="a5aadbbde2e0b66fc661a126f5a1ce1e" category="cell">STOR_21.yml</block>
  <block id="9c82263beb960ece0e5b6ac0604bb4d9" category="cell">Beegfs_S21_S22</block>
  <block id="4879e56fe4d161ba3e4df67f961c483a" category="cell">STOR_22.yml</block>
  <block id="316b3c9a6656c51b87a725bf1f678a52" category="cell">STOR_23.yml</block>
  <block id="2404c81b13915ef9d59e0ac6328f4c10" category="cell">beegfs_s23_s24</block>
  <block id="47662afeeaa16771e7d516dd96ade0b7" category="cell">STOR_24.yml</block>
  <block id="66136a118d01240429805a157ae4b538" category="summary">对于第二代构建块、在每个存储池配置中使用标准的四个卷时、请参考以下建议百分比。</block>
  <block id="13d38edc52fe6e049aae05e6fce1573a" category="paragraph">如果对第二代构建块采用每个存储池配置的标准四个卷、请参见下表。</block>
  <block id="2d115a94acc324947afb0abf7c47d665" category="paragraph">下表提供了在`eseries_storage_pool_configuration`中为每个BeeGFS元数据或存储目标用作卷大小的建议百分比：</block>
  <block id="ec8691da9bf60fda22f12e08033d054b" category="cell">驱动器大小</block>
  <block id="6f6cb72d544962fa333e2e34ce64f719" category="cell">Size</block>
  <block id="6f4922f45568161a8cdf4ad2299f6d23" category="cell">18</block>
  <block id="d81fdeb5a429e85d04118048e4b3485d" category="cell">21.5.</block>
  <block id="6303058eb2f22355195922bb9eeac265" category="cell">22.5</block>
  <block id="1ff1de774005f8da13f42943881c655f" category="cell">24</block>
  <block id="b6f404dc4372a8369386a51240b69703" category="admonition">上述指南不适用于包含管理服务的存储池、该存储池应将上述大小减少0.25%、以便为管理数据分配1%的存储池。</block>
  <block id="cede28c203641f70169adaabc10df9b6" category="inline-link">TR-4800：附录A：了解SSD持久性和过度配置</block>
  <block id="dab022c0b8356780eb602bc87effd71f" category="paragraph">要了解如何确定这些值、请参见<block ref="fa826cd698d934925bfe1b514e70b591" category="inline-link-rx"></block>。</block>
  <block id="bea1a33800109358727c67f41cd01d07" category="summary">部署和管理配置涉及运行一个或多个攻略手册、其中包含Ansible需要执行的任务、并将整个系统置于所需状态。</block>
  <block id="40184afe39cc9f2361b3b73e0695976d" category="doc">部署BeeGFS</block>
  <block id="a5cd3ed116608dac017f14c046ea56bf" category="inline-link">角色</block>
  <block id="d0dbcd7fcc2b33ea218a58e2364a462a" category="paragraph">虽然所有任务都可以包含在一本攻略手册中、但对于复杂的系统、这很快就会变得难以管理。Ansible可用于创建和分发角色、以便打包可重复使用的攻略手册和相关内容(例如：默认变量、任务和处理程序)。有关详细信息、请参见的Ansible文档<block ref="68a1974ca8634592518191ca9775617f" category="inline-link-rx"></block>。</block>
  <block id="63d74efd13802381ddc8b8a65a3a5000" category="paragraph">角色通常作为包含相关角色和模块的Ansible集合的一部分进行分布。因此、这些攻略手册主要仅导入分布在各种NetApp E系列Ansible资料集中的多个角色。</block>
  <block id="3fb2d69a2432fdcecc09bb3418ad3ace" category="admonition">目前、部署BeeGFS至少需要两个组件(四个文件节点)、除非将单独的仲裁设备配置为Tiebreaker、以缓解在双节点集群中建立仲裁时出现的任何问题。</block>
  <block id="2ab028f46312dfd58cd64798fc7cbf9e" category="list-text">创建新的`playbook.yml`文件并包括以下内容：</block>
  <block id="26a3e9e044d0e5b372c4803d6bdeefbd" category="admonition">本攻略手册将运行几个`pre_tasks`、用于验证Python 3是否已安装在文件节点上、并检查所提供的Ansible标记是否受支持。</block>
  <block id="7cf59981bd844e32610404655f205256" category="list-text">准备好部署BeeGFS时、请使用`Ansible攻略手册`命令和清单和攻略手册文件。</block>
  <block id="f73890e8771abfa1abdc045ab1b722ef" category="paragraph">此部署将运行所有`pre_tasks`、然后提示用户确认、然后再继续实际的BeeGFS部署。</block>
  <block id="efd5cfa405ebe66e35820b347b961b90" category="paragraph">运行以下命令、根据需要调整货叉数量(请参见以下注释)：</block>
  <block id="2485710fb8c15237f98f63beae48b455" category="inline-link">控制攻略手册执行</block>
  <block id="e5e4c2e4c004bc7dbd4a04d4b0971e53" category="paragraph">根据Ansible控制节点与BeeGFS文件和块节点之间的部署规模和网络性能、部署时间可能会有所不同。</block>
  <block id="c38012b2187d10d4a33d168693918570" category="summary">每个组件都包含两个经验证的x86文件节点、这些文件节点使用HDR (200 GB) InfiniBand直接连接到两个NetApp块节点。</block>
  <block id="0893812920a9268362b89a618b2f05c4" category="paragraph">每个组件都包含两个经过验证的x86文件节点、这些文件节点使用HDR (200 GB) InfiniBand缆线直接连接到两个块节点。</block>
  <block id="9df6f3b087eea6552beb54d44653501a" category="list-text">为每个BeeGFS块节点配置一个双端口200 GB主机接口卡(HIC)、并在其两个存储控制器中的每个控制器中安装HIC。</block>
  <block id="9e5081bbd0a64102ab8844f96776d6ea" category="admonition">用于生产用例的电源配置通常应使用冗余PSU。</block>
  <block id="cf31d049daa8cd238cb4238371f2e5d0" category="list-text">如果需要、请在每个BeeGFS块节点中安装驱动器。</block>
  <block id="eb86aba8f900c8f076cdcddafcf7271f" category="list-text">如果要使用此组件运行BeeGFS元数据和存储服务、而将较小的驱动器用于元数据卷、请验证这些驱动器是否已填充到最外的驱动器插槽中、如下图所示。</block>
  <block id="c448ee45144a8930f2211d0a4edb7b91" category="list-text">对于所有组件配置、如果驱动器机箱未完全填充、请确保在插槽0–11和12–23中填充相同数量的驱动器、以获得最佳性能。</block>
  <block id="7fd5b7ef2a561c49e1b59a838397af45" category="admonition">多个组件中的节点不会直接连接。每个组件都应视为一个独立单元、并且各个组件之间的所有通信都通过网络交换机进行。</block>
  <block id="57f799feabdc3b75aa704ff51e74f4c1" category="list-text">根据需要、按照相同的布线准则组装其他组件。</block>
  <block id="6a2ae129e5b77fd39f068e6cdee42d2a" category="admonition">可部署在一个机架中的组件总数取决于每个站点的可用电源和散热。</block>
  <block id="b11764419626b2eff6352f3d8e6022e3" category="summary">要设置Ansible控制节点、请确定可以通过网络访问可用于配置解决方案 的所有文件和块节点的管理端口的虚拟机或物理机。</block>
  <block id="bfcf60c321d0d2cb85402c7a22d208b9" category="paragraph">要设置Ansible控制节点、您必须确定能够通过网络访问可用于配置解决方案 的所有文件和块节点的管理端口的虚拟机或物理机。</block>
  <block id="e7a81038c18b15bf5d97b77fb110af03" category="list-text">安装NetApp BeeGFS集合所需的Python软件包。</block>
  <block id="7f883f5609524995f000fc99b8f5691a" category="admonition">要确保您安装的是受支持的Ansible版本以及所有必需的Python软件包、请参阅BeeGFS集合的自述文件。中还说明了支持的版本 <block ref="786d34f336ab7f462feb4fe8776c8670" category="inline-link-macro-rx"></block>。</block>
  <block id="a36d9a848f44be3e2b8d092a5861995a" category="list-text">验证是否已安装正确版本的Ansible和Python。</block>
  <block id="4ac0a4015ebef3209a5f3acb61110dd9" category="list-text">将用于描述BeeGFS部署的Ansible清单存储在Git或BitBucket等源控制系统中、然后安装Git以与这些系统进行交互。</block>
  <block id="f2f38616eaf6d21846071c00e89109b4" category="list-text">设置无密码SSH。这是允许Ansible从Ansible控制节点访问远程BeeGFS文件节点的最简单方法。</block>
  <block id="3087af73e5990976755e4c56b6e7c754" category="list-text">如果需要、在Ansible控制节点上、使用`ssh-keygen`生成一对公有 密钥</block>
  <block id="c5d36867af8fc130f7a6b6bd87d51d23" category="list-text">使用`ssh-copy-id &lt;ip_or_hostname&gt;`为每个文件节点设置无密码SSH</block>
  <block id="c4e4fc85a76d5e87beac70d1fa166882" category="paragraph">Do * not* set up passworwless SSH to the block nodes.这既不受支持、也不是必需的。</block>
  <block id="03f38aac08b6c6c3e6e3afc965fedbcc" category="list-text">使用Ansible GALAXY安装中列出的BeeGFS集合版本 <block ref="786d34f336ab7f462feb4fe8776c8670" category="inline-link-macro-rx"></block>。</block>
  <block id="b113449496b52721b53dc04e5120a57b" category="paragraph">此安装还包括其他Ansible依赖关系、例如NetApp SANtricity 软件和主机集合。</block>
  <block id="a8bb1258f035db2e1b989badd7504202" category="summary">要定义文件和块节点的配置、请创建一个Ansible清单、用于表示要部署的BeeGFS文件系统。</block>
  <block id="811a6b46c73b2ff846d806c69f166392" category="paragraph">要定义文件和块节点的配置、请创建一个Ansible清单、用于表示要部署的BeeGFS文件系统。清单包括描述所需BeeGFS文件系统的主机、组和变量。</block>
  <block id="f710d81b04cfd57ef65bc4cca28bc3d4" category="section-title">第1步：定义所有组件的配置</block>
  <block id="08ecdaa3e32e095bd8f7ecec87a6ffe1" category="paragraph">定义适用场景 所有组件的配置、无论您可以单独应用于这些组件的配置文件如何。</block>
  <block id="135b308ed83c53f1516b7c754566d1c4" category="list-title">开始之前</block>
  <block id="1633329793556e695f8ae53c7f3c8756" category="list-text">在Ansible控制节点上、确定要用于存储Ansible清单和攻略手册文件的目录。</block>
  <block id="2af34d0fd4b17ecc42b7fb40d3a2019d" category="paragraph">除非另有说明、否则在此步骤中创建的所有文件和目录以及后续步骤均会相对于此目录创建。</block>
  <block id="31f13138a9fb78368dd1c5b8b9cb522e" category="list-text">创建以下子目录：</block>
  <block id="f502c582ecc3459969f6ae37e60464d1" category="paragraph">`host_vars`</block>
  <block id="f2151fe487fd8f761c16c5d92971a46f" category="paragraph">`group_vars`</block>
  <block id="5fa06f80972ff05cf8eb18aa9af90bbd" category="paragraph">`软件包`</block>
  <block id="49266d47983011d7ceee48c764eaad20" category="section-title">第2步：为单个文件和块节点定义配置</block>
  <block id="bcbd88b78dd9388280471b20c50ef836" category="paragraph">定义适用场景 单个文件节点和单个组件节点的配置。</block>
  <block id="4ace9bc4fa627e77f6406dd2f64e2028" category="list-text">在`host_vars/`下、为名为`&lt;HOSTNAME&gt;.yml`的每个BeeGFS文件节点创建一个文件、其中包含以下内容、请特别注意有关BeeGFS集群IP和以奇数与偶数结尾的主机名要填充的内容的注释。</block>
  <block id="65742ecf20e6c51de487a8a5c4e5d085" category="paragraph">最初、文件节点接口名称与此处列出的名称匹配(例如ib0或ibs1f0)。这些自定义名称在中进行配置 <block ref="9c327e4b0e0a41a0187df973a6c1c1f1" category="inline-xref-macro-rx"></block>。</block>
  <block id="c1df6ea154e4f3c22584570de9017604" category="admonition">如果您已部署BeeGFS集群、则必须先停止此集群、然后才能添加或更改静态配置的IP地址、包括用于NVMe/IB的集群IP和IP。这是必需的、以便这些更改能够正确生效、并且不会中断集群操作。</block>
  <block id="64f6e7ce4bce20648e5b5817cc7c9d5d" category="list-text">在`host_vars/`下、为名为`&lt;HOSTNAME&gt;.yml`的每个BeeGFS块节点创建一个文件、并使用以下内容填充该文件。</block>
  <block id="350317d433df31d79bf0ded1b3748715" category="paragraph">请特别注意有关以奇数与偶数结尾的存储阵列名称要填充的内容的注释。</block>
  <block id="d9aa2babb29bda2ebcdcb05c255e1dd3" category="paragraph">对于每个块节点、创建一个文件并为两个控制器(通常为A)之一指定`&lt;management_IP&gt;`。</block>
  <block id="a79b02f70003beee254343e4cae10ad4" category="section-title">第3步：定义应应用于所有文件和块节点的配置</block>
  <block id="7a7623c76e8a35ad9b47b72876017ffc" category="paragraph">您可以使用与组对应的文件名在`group_vars`下定义一组主机的通用配置。这样可以防止在多个位置重复使用共享配置。</block>
  <block id="b8250a298e8217ebff19d4f7c62cf654" category="inline-link">使用变量</block>
  <block id="45c67f165a1990ff04bfa4ffd3ad1908" category="paragraph">主机可以位于多个组中、运行时、Ansible会根据特定主机的可变优先级规则选择哪些变量适用于该主机。(有关这些规则的详细信息、请参见的Ansible文档<block ref="e846c866a706aed07204d4b81c43f562" category="inline-link-rx"></block>）</block>
  <block id="30670ef79ffcebf619cb84794bb9f467" category="paragraph">主机到组分配在实际可Ansible清单文件中进行定义、该文件在该操作步骤 接近末尾时创建。</block>
  <block id="13fe78da26730165534ca728d16729df" category="paragraph">在Ansible中、可以在名为`All`的组中定义要应用于所有主机的任何配置。使用以下内容创建文件`group_vars/all.yml`：</block>
  <block id="970c2de774d4cba551050f0b96346cc6" category="section-title">第4步：定义应应用于所有文件节点的配置</block>
  <block id="68decee7f537598fe42c449c7effd748" category="paragraph">文件节点的共享配置在名为`ha_cluster`的组中定义。本节中的步骤将构建应包含在`group_vars/ha_cluster.yml`文件中的配置。</block>
  <block id="01eabbaba4e3200ffffeaf687ced4089" category="list-text">在文件顶部、定义默认值、包括用作文件节点上的`sUdo`用户的密码。</block>
  <block id="3eeae040dcd4e8e08ba89cd729351414" category="list-text">(可选)配置高可用性(HA)集群的名称、并为集群内通信指定用户。</block>
  <block id="22bf408c8339ca14dab3745bbe56780d" category="paragraph">如果要修改专用IP寻址方案、则还必须更新默认值`beegfs_ha_mgmtd_float_IP`。这必须与您稍后为BeeGFS管理资源组配置的内容匹配。</block>
  <block id="ba4d50db9221cc812d5f7981d4600c2d" category="paragraph">使用`beegfs_ha_alert_email_list`指定一个或多个应接收集群事件警报的电子邮件。</block>
  <block id="e69d5d030b5267144694edd30e58fa4b" category="admonition">虽然`冗余、但当您将BeeGFS文件系统扩展到单个HA集群之外时、`beegfs_ha_mgmtd_floating_ip非常重要。部署后续HA集群时无需额外的BeeGFS管理服务、并指向第一个集群提供的管理服务。</block>
  <block id="7509dcf152f48abcba19fa72adedb808" category="inline-link">在Red Hat High Availability集群中配置隔离</block>
  <block id="b2f365e9dc240069eb174f596f8086dd" category="paragraph">在此步骤中、请注意：</block>
  <block id="83a5cc26327b36012de2442c022e0357" category="list-text">默认情况下、隔离处于启用状态、但您需要配置隔离_agent_。</block>
  <block id="502142ce464e9e0c49b233594ce3af26" category="list-text">在`PCMK_HOST_MAP`或`PCMK_HOST_LIST`中指定的`&lt;HOSTNAME&gt;`必须与Ansible清单中的主机名相对应。</block>
  <block id="08c76f94c7c5d2fb0509d39d58f7d298" category="list-text">不支持在不使用隔离的情况下运行BeeGFS集群、尤其是在生产环境中。这在很大程度上是为了确保当BeeGFS服务(包括块设备等任何资源依赖关系)因问题描述 而发生故障转移时、不会存在多个节点并发访问导致文件系统损坏或其他不希望或意外行为的风险。如果必须禁用隔离、请参阅BeeGFS HA角色的入门指南中的一般说明、并在`ha_cluster_crm_config_options["stonith-enabled"]`中将`beegfs_ha_cluster.yml`设置为false。</block>
  <block id="8134b950ce435c1478c36f8d9e28640a" category="list-text">可以使用多个节点级别的隔离设备、BeeGFS HA角色可以配置Red Hat HA软件包存储库中可用的任何隔离代理。如果可能、请使用通过不间断电源(UPS)或机架配电单元(rPDU)工作的隔离代理。 因为在某些故障情形下、某些隔离代理(如基板管理控制器(BMC)或服务器中内置的其他无人值守设备)可能无法响应隔离请求。</block>
  <block id="6793d5cb3a8bc008d05678615f821ca7" category="list-text">在Linux操作系统中启用建议的性能调整。</block>
  <block id="951cd0f9ef758f90609564a78a7f36a2" category="paragraph">虽然许多用户发现性能参数的默认设置通常运行良好、但您也可以选择更改特定工作负载的默认设置。因此、这些建议包含在BeeGFS角色中、但默认情况下不会启用、以确保用户了解应用于其文件系统的调整。</block>
  <block id="2e468d52e0778656623f6a98e831b3c0" category="paragraph">要启用性能调整、请指定：</block>
  <block id="5886796779dc029ac41ffca429f9f5d1" category="list-text">(可选)您可以根据需要调整Linux操作系统中的性能调整参数。</block>
  <block id="fe7cbbcd6bbbe894cb7364e04d36c7ae" category="inline-link">E系列BeeGFS GitHub站点</block>
  <block id="372ec1e9d1761b6aa16b9f0b54a4433b" category="list-text">在`group_vars/ha_cluster.yml`中填充以下参数(根据需要调整软件包)：</block>
  <block id="382cd5df5d20e8ee60bea9f8be1884e3" category="list-text">配置`udev`规则、以确保逻辑InfiniBand端口标识符与底层PCIe设备的映射一致。</block>
  <block id="acb63a2b1a344472ec1b72c168bf5a95" category="paragraph">`udev`规则对于用作BeeGFS文件节点的每个服务器平台的PCIe拓扑来说必须是唯一的。</block>
  <block id="8cec215dcbcd9866be7ad7f12652d9bd" category="paragraph">对于已验证的文件节点、请使用以下值：</block>
  <block id="b535d5891e9112526732586cf8225d93" category="list-text">(可选)更新元数据目标选择算法。</block>
  <block id="e3c1663ae83b766d79e4b2be55767666" category="inline-link">对BeeGFS系统进行基准测试</block>
  <block id="8dff66e73ac10da6c457b7092c6f9005" category="admonition">在验证测试中、通常会使用`Randomrobin`来确保测试文件在性能基准测试期间均匀分布在所有BeeGFS存储目标上(有关基准测试的详细信息、请参见BeeGFS站点<block ref="831dbcfeece1d9e52170bb11173ba315" category="inline-link-rx"></block>）。在实际使用情况下、这可能会导致编号较低的目标达到发生原因 、从而比编号较高的目标更快地达到填充速度。已显示省略`randomrobin`以及仅使用默认值`randomized`值可在仍利用所有可用目标的情况下提供良好的性能。</block>
  <block id="aad0b8e6a3552eebcdcf125f218d1954" category="section-title">第5步：定义通用块节点的配置</block>
  <block id="f9ed56c11a1443e285b3d786249fe6aa" category="paragraph">块节点的共享配置在名为`Eseries_storage_systems`的组中定义。本节中的步骤构建了应包含在`group_vars/ eseries_storage_systems.yml`文件中的配置。</block>
  <block id="7d304d17d15c3332b9d8584fa30f070b" category="list-text">将Ansible连接设置为local、提供系统密码、并指定是否应验证SSL证书。(通常、Ansible使用SSH连接到受管主机、但对于用作块节点的NetApp E系列存储系统、模块使用REST API进行通信。) 在文件顶部、添加以下内容：</block>
  <block id="a18d6a60f542af2e3b0784928e17f417" category="list-text">为确保获得最佳性能、请在中安装为块节点列出的版本 <block ref="786d34f336ab7f462feb4fe8776c8670" category="inline-link-macro-rx"></block>。</block>
  <block id="8c41baf1ca98e1184f48c4721d44d431" category="inline-link">NetApp 支持站点</block>
  <block id="38119f4253b4080e689702afd647df1f" category="paragraph">从下载相应的文件<block ref="3f80e15ba326a9eb1fc39b6d8ba81472" category="inline-link-rx"></block>。您可以手动升级它们、也可以将其包含在Ansible控制节点的`packages/`目录中、然后在`Esery_storage_systems.yml`中填充以下参数以使用Ansible进行升级：</block>
  <block id="72423a5fa99fafb4c2dc7b7e7f7d7962" category="admonition">将`esery_drive_firmware_upgrade_drives_online`设置为`false`可以加快升级速度、但在部署BeeGFS之前不应执行此操作。这是因为该设置要求在升级之前停止驱动器的所有I/O、以避免应用程序错误。尽管在配置卷之前执行联机驱动器固件升级仍很快、但我们建议您始终将此值设置为`true`以避免稍后出现问题。</block>
  <block id="2b0551e04ffc3a713c07e9a9611b9897" category="list-text">要优化性能、请对全局配置进行以下更改：</block>
  <block id="6b7cf272a4e3aeaf52c2d0ca991829e5" category="list-text">要确保最佳卷配置和行为、请指定以下参数：</block>
  <block id="b969df7be52ed192c298428e4fb0e696" category="admonition">为`E系列_storage_pool_usable_drives`指定的值特定于NetApp EF600块节点、并控制驱动器分配给新卷组的顺序。此顺序可确保每个组的I/O在后端驱动器通道之间均匀分布。</block>
  <block id="7042a03d018b94aee36197baf79897b2" category="summary">为了最大限度地提高性能、我们建议在用作文件节点的服务器型号上配置系统设置。</block>
  <block id="e95c3b26aabb0242b0a38d72568b125a" category="paragraph">为了最大程度地提高性能、我们建议在用作文件节点的服务器型号上配置系统设置。</block>
  <block id="291e90fb83bca326d06b5479d0ae7197" category="paragraph">系统设置因用作文件节点的服务器型号而异。本主题介绍如何为经过验证的联想ThinkSystem SR665服务器文件节点配置系统设置。</block>
  <block id="cfa9d7ef51eae23751a0ea54765b99fd" category="section-title">使用UEFI界面调整系统设置</block>
  <block id="7afe745e5e5ded0e0cf311f6ab05ce41" category="paragraph">联想SR665服务器的系统固件包含许多可通过UEFI界面设置的调整参数。这些调整参数可能会影响服务器的运行方式以及服务器的性能。</block>
  <block id="01d5e77f89697d310442aa744d5c4068" category="paragraph">在* UEFI设置&gt;系统设置*下、调整以下系统设置：</block>
  <block id="6e2e169ab41f56781f3cd65629914fc6" category="section-title">操作模式菜单</block>
  <block id="f7adfd4c98207b1161c7b693c16fa9ea" category="cell">*系统设置*</block>
  <block id="a3fb412bb8de9718b8510aa99340221a" category="cell">*更改为*</block>
  <block id="1c2631aa94b6d5e1cc826b0cb76a87ba" category="paragraph">操作模式</block>
  <block id="90589c47f06eb971d548591f23c285af" category="paragraph">自定义</block>
  <block id="43e16592d1b7c57c68cdf68bcd7f2fbd" category="paragraph">cTDP</block>
  <block id="e1ba155a9f2e8c3be94020eef32a0301" category="paragraph">手动</block>
  <block id="db0877bc3fbb4ce0ffd2f36fa5470581" category="paragraph">cTDP手册</block>
  <block id="9de6d14fff9806d4bcd1ef555be766cd" category="paragraph">350</block>
  <block id="43287f46609a4dc60f40223b99452814" category="paragraph">软件包电源限制</block>
  <block id="8bec16a6c589939ad9d0a3c20f7dd8dc" category="paragraph">效率模式</block>
  <block id="bcfaccebf745acfd5e75351095a5394a" category="paragraph">禁用</block>
  <block id="50a4d260500229aae705dffbef792499" category="paragraph">全局Cstate-Control</block>
  <block id="bbb8600e28b07b4e7765ccb37c8ba72d" category="paragraph">SOC P状态</block>
  <block id="16a2e561c536a77cbfd10490ea398be6" category="paragraph">P0</block>
  <block id="f7d2d14860cfdee82e8cf9418c1ec624" category="paragraph">DF C状态</block>
  <block id="9c1a39470ba5d6a8856c5e813e20ef6b" category="paragraph">启用内存关闭</block>
  <block id="3011761cbf6a8eb38a41f6b38210c119" category="paragraph">每个插槽的NUMA节点数</block>
  <block id="4142a6b2c0ac3aaf643751457e9aad6a" category="paragraph">NPS1</block>
  <block id="cdceaf6498461c15ce1ae0800bf60c66" category="section-title">设备和I/O端口菜单</block>
  <block id="fb31ba7c369028665e7e1a20bd645da6" category="paragraph">IOMMU</block>
  <block id="ada62bbe41ae187c3f0f777ffbd44d28" category="section-title">电源菜单</block>
  <block id="e7dc1149b98b9a234419b52cb65c86eb" category="paragraph">PCIe电源制动器</block>
  <block id="a4fb96bd64d4ecceb3f0f416f7032bb9" category="section-title">处理器菜单</block>
  <block id="78ee21f7e9d290c773c1aa6ae0d03303" category="paragraph">全局C状态控制</block>
  <block id="dc8a824c345b5e3bbaa79fce219830c2" category="paragraph">SMT模式</block>
  <block id="28fb70bc7fdb441f9e6550205a24c92c" category="paragraph">CPPC</block>
  <block id="83ed73e76e0c1cfe38ef9627b7ae0fe0" category="section-title">使用Redfish API调整系统设置</block>
  <block id="2bfb51b6fb78d5540135d28668652ab6" category="paragraph">除了使用UEFI设置之外、您还可以使用Redfish API更改系统设置。</block>
  <block id="33e221e2cea2342a6bae3c4c24f33827" category="inline-link">DMTF网站</block>
  <block id="d96afe3ab332c2cc42ac69c811923ba7" category="paragraph">有关Redfish模式的详细信息、请参见<block ref="108ef396f9aef1d6bcaea08379b877eb" category="inline-link-rx"></block>。</block>
  <block id="71f5771dab663d80ba4dad1627e3386a" category="summary">升级概述</block>
  <block id="e9c44bbfd795a5d63d74c6a77afee70d" category="summary">法律声明提供对版权声明、商标、专利等的访问。</block>
  <block id="30d965eef5ba25c6b9998ae38270b43e" category="doc">法律声明</block>
  <block id="6016a2b341113bf496b719905398ecd2" category="section-title">版权</block>
  <block id="126a02652da6de02962cf1b654fd6376" category="section-title">商标</block>
  <block id="c4ce4761e466527d26b3e3d5ed1006fd" category="paragraph">NetApp 、 NetApp 徽标和 NetApp 商标页面上列出的标记是 NetApp 、 Inc. 的商标。其他公司和产品名称可能是其各自所有者的商标。</block>
  <block id="be89498d2f8a22ce47c02ba9795fe2af" category="section-title">专利</block>
  <block id="d0b19d36be2c5f16e9aef46c8a452d3d" category="paragraph">有关 NetApp 拥有的专利的最新列表，请访问：</block>
  <block id="56c34c6410dd45c5cec44149ad0ce037" category="section-title">隐私政策</block>
  <block id="c0227cef6f07a8cd2ac72f2945b031aa" category="section-title">开放源代码</block>
  <block id="9b73989307c1975dfa4d5e1581e4afe8" category="paragraph">通知文件提供有关 NetApp 软件中使用的第三方版权和许可证的信息。</block>
  <block id="cc1ba14f8dc9bd7ba20e2aa654cde10b" category="inline-link">E 系列 /EF 系列 SANtricity 操作系统注意事项</block>
  <block id="2dae7f81af3097152530b0bc519d7eb1" category="paragraph"><block ref="2dae7f81af3097152530b0bc519d7eb1" category="inline-link-rx"></block></block>
  <block id="e3b88cba18358b065044f4788449026b" category="summary">解决方案 支持在高性能、低延迟NetApp E系列存储上运行的BeeGFS并行集群文件系统。一款经济高效、易于管理且高度可用的HPC解决方案 、并获得NetApp的支持。</block>
  <block id="28e8b3e83af233fe7085ba954fc6fd36" category="doc">NetApp上的BeeGFS与E系列存储</block>
  <block id="be11c74c1dd7f307bb80183a90dc2067" category="sidebar">入门</block>
  <block id="12623d7cc9dff74b7325aa809ffc84df" category="sidebar">博客—了解BeeGFS和E系列</block>
  <block id="0af9e7bf64a8e8c1b37ec554248f3d14" category="sidebar">博客—适合新手的BeeGFS</block>
  <block id="6316c96cdd51a54d33d0011cf5f10c81" category="sidebar">博客—BeeGFS的HA</block>
  <block id="b89fcecfac1f6b8376165aabe5b6c5ee" category="sidebar">其他文档</block>
  <block id="bc4fe2352063642d68529f2aa0ca7ca3" category="sidebar">NetApp 产品文档</block>
  <block id="dbd68e15f4c30d2a47d780a9bf4f3da1" category="sidebar">BeeGFS文档</block>
  <block id="974ad78dc53c253ebfe5b2b8b376f353" category="sidebar">工具支持</block>
  <block id="d564be87f67790fe4b92faa0eea29c48" category="sidebar">Ansible GALAXY上的NetApp E系列集合</block>
  <block id="bc8be72fdc9d6054f356bb2b7f80fd12" category="sidebar">NetApp 互操作性表</block>
  <block id="668e2078ef1b1722c77cdb5c523a4463" category="sidebar">NetApp 知识库</block>
  <block id="2bae42f280067110dfd52cc69a468364" category="sidebar">Active IQ （需要登录）</block>
  <block id="c35665ae18bf4eff9afa413fcb281b07" category="sidebar">BeeGFS on NetApp文档</block>
  <block id="f40341c80e215542b4fdfe4e2f2e2a21" category="sidebar">此站点包含的内容</block>
  <block id="539652fdf317cc6e27c7373dc6fe13d3" category="sidebar">查看解决方案 设计</block>
  <block id="6c24b1b24585abc1454b91e5eb163103" category="sidebar">部署解决方案</block>
  <block id="c5d1e465274381bca5df236c2a5a7d57" category="sidebar">部署软件</block>
  <block id="97ecf64b4f2550ec2c53f49bb9fde847" category="sidebar">设置Ansible控制节点</block>
  <block id="f99ff2e7716d2f6aa55979e838f0a328" category="sidebar">创建Ansible清单</block>
  <block id="da7f5c02044100badae24523f01941a2" category="sidebar">定义BeeGFS组件</block>
  <block id="8025f3ce3e3e1dd003430788c4be8b5e" category="sidebar">扩展BeeGFS集群</block>
  <block id="e304a70d2f42f62cefb9b474f73a1e91" category="sidebar">建议的卷百分比</block>
  <block id="ba13e086fe19056a379b6240e05651a8" category="sidebar">TR-4915—使用E系列和BeeGFS进行数据移动以实现AI</block>
  <block id="bc893b2686532fc683cb056beffd08aa" category="cell">驱动器大小(10+2 RAID 6)存储卷组</block>
  <block id="64dc43320ec1a44c390fafb5e2408f4b" category="inline-link">NVIDIA DGX基本POD</block>
  <block id="33d753992c8525a016e60650889ef7a9" category="paragraph">有关详细信息，请参见<block ref="917e0b817a1bc5579c3d00c8de7a0790" category="inline-link-rx"></block> 和<block ref="d4d49ddfca3de3daecdc231399362db8" category="inline-link-rx"></block>。</block>
  <block id="53c31a8ba69af9d096629948d271d34d" category="paragraph-title">布线以利用带宽</block>
  <block id="bbe48fb854ea022537208eeeff822f91" category="paragraph-title">关于此任务</block>
  <block id="48c7c41b72e1d678923ce3571aa65b2d" category="paragraph-title">步骤</block>
  <block id="015dd422187100bd2a53cae756db5bcd" category="paragraph-title">一个BeeGFS基础(管理、元数据和存储)组件</block>
  <block id="2eb32f267ab2864aa50a3171522c1574" category="paragraph-title">BeeGFS元数据+存储组件</block>
  <block id="2cf619569e1d3422599fa7ba3fff04f2" category="paragraph-title">BeeGFS纯存储组件</block>
  <block id="9443a11095bad63a50d95ece24842fb2" category="paragraph-title">三个BeeGFS组件</block>
  <block id="3c793d71f0d81892f28ab10f661381c8" category="paragraph-title">一个BeeGFS元数据+存储组件</block>
  <block id="94c5de0e8c5b79f8b061a00a2d638234" category="paragraph-title">两个BeeGFS元数据+存储组件</block>
  <block id="aa00436c66c8456a1c9ef0a12178a4ab" category="paragraph-title">子网A：100.127.0.0/16</block>
  <block id="079e5887eeb92f6f17c9fa25fd464e2a" category="paragraph-title">子网B：100.128.0.0/16</block>
  <block id="02cf3373667b246c17c8d054c073a372" category="paragraph">部署建议各不相同的衍生架构：</block>
  <block id="2e93d3c37349d17095fd0dca7d6fe097" category="inline-link-macro">高容量组件</block>
  <block id="8a43f7c3e77834cf43b5398c116033e3" category="list-text"><block ref="8a43f7c3e77834cf43b5398c116033e3" category="inline-link-macro-rx"></block></block>
  <block id="119c6b2e3908d75335ad13f9fead045a" category="cell">1、938、572、200</block>
  <block id="753b107ce954fb125f0557af947a86c5" category="cell">51.77 TB</block>
  <block id="bb586a502f621b433b3966d68c887364" category="cell">3、880、388、400</block>
  <block id="8b2e1597e74fb68a87ef415a1ce004fc" category="cell">103.55 TB</block>
  <block id="9c0aa8a6ddcfe00cef8951f0edd99c58" category="cell">8、125、278、000</block>
  <block id="b0baa6e5c027744d7e7f2a93d8686bf5" category="cell">216.74 TB</block>
  <block id="edd8590257b34c7c6f57e06f28bb9460" category="cell">17、262、854、000</block>
  <block id="0d9c02ec5b1f4c4a835073aa142d0b7f" category="cell">460.60 TB</block>
  <block id="f8ed0cba5469cc89e05fa4d3025eca1b" category="summary">高容量组件的设计变体。</block>
  <block id="8b074fc693c7d8fd35c61de8fe2dee9a" category="doc">高容量组件</block>
  <block id="fb5708557d5e7c6d44ac55ef4c09a054" category="paragraph">标准BeeGFS解决方案 设计充分考虑了高性能工作负载。寻求高容量使用情形的客户应观察此处所述的设计和性能特征的差异。</block>
  <block id="800f7da804cf784ad962d085fbc70486" category="section-title">硬件和软件配置</block>
  <block id="90f177623f1131fc7f45e82db6189a1b" category="paragraph">高容量组件的硬件和软件配置是标准配置、但EF600控制器应更换为EF300控制器、并可选择在1到7个IOM扩展托盘之间连接、每个存储阵列使用60个驱动器。每个组件总共有2到14个扩展托盘。</block>
  <block id="467fccc62f2ea7630303f15d47a54aa7" category="paragraph">部署高容量构建块设计的客户可能仅使用基础构建块模式配置、该配置包含每个节点的BeeGFS管理、元数据和存储服务。为了节省成本、高容量存储节点应在EF300控制器机箱中的NVMe驱动器上配置元数据卷、并为扩展托盘中的NL-SAS驱动器配置存储卷。</block>
  <block id="774f4231e5651061791e65cf90314897" category="paragraph"><block ref="774f4231e5651061791e65cf90314897" category="inline-image-macro-rx" type="image"></block></block>
  <block id="267aa4fef181a2097a06345c854cc106" category="paragraph">这些规模估算准则假定高容量组件在基础EF300机箱中配置了一个2+2 NVMe SSD卷组用于元数据、并在每个IOM扩展托盘中配置了6个8+2 NL-SAS卷组用于存储。</block>
  <block id="963320465e8fcfa25188a669a43858c4" category="cell">驱动器大小(容量HDD)</block>
  <block id="55fd8e839de07671a6869fad80279ab9" category="cell">每个BB的容量(1个托盘)</block>
  <block id="001115a96afe0add22e654316239365a" category="cell">每个BB的容量(2个托盘)</block>
  <block id="b9781606af717d9b153714ca7a3a2d33" category="cell">每个BB的容量(3个托盘)</block>
  <block id="345ffe7c9ac213823037fbcdca8f4ef2" category="cell">每个BB的容量(4个托盘)</block>
  <block id="6b7e0bcfc566b639bc0d10bad9f871dd" category="cell">4 TB</block>
  <block id="676efbc64df1b4909842616f91027d96" category="cell">439 TB</block>
  <block id="25c359cf674976f1bd282922ff6ed0e3" category="cell">878 TB</block>
  <block id="1416acbb13ce37c62934fde6e37b3c6b" category="cell">1317 TB</block>
  <block id="3aa071e61efaac2113f5fc251c03b688" category="cell">1756 TB</block>
  <block id="0706c165b0123479cffaac9b374484f0" category="cell">8 TB</block>
  <block id="76a91245e71b558dbe0040ea8b7b3c21" category="cell">2634 TB</block>
  <block id="dd9fa1084ca34ce21c6b127bd37446b9" category="cell">3512 TB</block>
  <block id="1191f788083da9194f8eef9400d10898" category="cell">10 TB</block>
  <block id="6587b6d3747beeadda1eccb500e9771b" category="cell">1097 TB</block>
  <block id="3a89d830e84dc7715fe902bb9adac448" category="cell">2195 TB</block>
  <block id="1024776bf84a4c2469e49539ac248790" category="cell">3292 TB</block>
  <block id="0af601e969fa263e021792cfd1dfd4af" category="cell">4390 TB</block>
  <block id="aad11c7dd0feb18c08cb728eea0a8c46" category="cell">12 TB</block>
  <block id="0fc4914bd341e29e4eef438ff8c44bdb" category="cell">3951 TB</block>
  <block id="4d63a00ef9361479d55d2914d7f75e28" category="cell">5268 TB</block>
  <block id="324f218b8144e744b54eb58e0bf14eea" category="cell">16 TB</block>
  <block id="af4d6969d11876b269a31ebb39d7c34e" category="cell">7024 TB</block>
  <block id="7ba1b40b5eed0a67df50aa00c907f9ac" category="cell">18 TB</block>
  <block id="23f86ea0b6ba63be94542d36e1d0ac20" category="cell">1975-TB</block>
  <block id="01dbb09e4b3f7243c1cae305daf2972a" category="cell">5927 TB</block>
  <block id="547259566f92db3383cbd2575b9d68c1" category="cell">7902 TB</block>
  <block id="585389cefc924819e7ab6d5b7eba5f03" category="paragraph">设计和性能各不相同的衍生架构：</block>
  <block id="f45c646cffcf39011c125e7523fa9149" category="summary">高容量组件的部署变体。</block>
  <block id="fc6e06f3e4cfc328095f04c8f44c28f1" category="paragraph">标准BeeGFS解决方案 部署指南概述了满足高性能工作负载要求的过程和建议。希望满足高容量要求的客户应观察此处所述的不同部署和建议。</block>
  <block id="cbfb14f470701bf93424d757c624369a" category="section-title">控制器</block>
  <block id="174e6193fff9ed7c9b1839367e007f13" category="paragraph">对于高容量组件、EF600控制器应更换为EF300控制器、每个控制器都安装有一个级联HIC、用于SAS扩展。每个块节点将在阵列机箱中为BeeGFS元数据存储填充最少数量的NVMe SSD、并将其连接到为BeeGFS存储卷填充NL-SAS HDD的扩展架。</block>
  <block id="1ec9226d3745f2995d2686d2450831c7" category="paragraph">文件节点到块节点的配置保持不变。</block>
  <block id="af932b84cc0c8562c0e572647564048f" category="section-title">驱动器放置</block>
  <block id="f96a95c482225ca6a9b4c17bfa47d918" category="paragraph">每个块节点至少需要4个NVMe SSD才能存储BeeGFS元数据。这些驱动器应放置在机箱最外侧的插槽中。</block>
  <block id="fdd528ca6f274d102819b008b189961c" category="section-title">扩展托盘</block>
  <block id="6627fde89324d2cbb6afd245e3d32d35" category="paragraph">高容量组件的大小可以为每个存储阵列配备1到7个60个驱动器扩展托盘。</block>
  <block id="80b4ce0c4b11e4d8c7c4a14614b871f7" category="inline-link-macro">有关驱动器架的信息、请参见EF300布线</block>
  <block id="25ada85328148d5356ce4edd989b1f40" category="paragraph">有关为每个扩展托盘布线的说明、 <block ref="8c170f7da852d665db7cd9113b2ed6bb" category="inline-link-macro-rx"></block>。</block>
  <block id="0607ff4a53c90b270dd9fd9fce5c3d92" category="sidebar">高容量选项</block>
  <block id="23bc11ca7e09a55b459ef424efb98c36" category="summary">使用pcs查看集群的状态。</block>
  <block id="d4c39d91a1df6c7a7094c35722ec3ed5" category="doc">检查集群的状态</block>
  <block id="3b878279a04dc47d60932cb294d96259" category="section-title">概述</block>
  <block id="b6330a3d35150021353dc39d5bf1899a" category="paragraph">正在运行<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 从任何集群节点上、都是查看集群整体状态和每个资源(例如BeeGFS服务及其依赖关系)状态的最简单方法。本节将介绍的输出内容<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 命令：</block>
  <block id="a58022af0d3ce83b3b4031643fcdb7be" category="section-title">了解输出<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block></block>
  <block id="24b70b7dc179eb742a98eca1b4c954b3" category="paragraph">运行<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 在启动了集群服务(Pacemaker和Corosync)的任何集群节点上。输出顶部将显示集群的摘要：</block>
  <block id="9e1d70fa0d8e4964c3bd135b73fa8375" category="paragraph">以下部分列出了集群中的节点：</block>
  <block id="ce0c86ab66a5ecdcc820da60194c7abc" category="paragraph">这主要表示处于备用或脱机状态的任何节点。处于备用状态的节点仍在参与集群、但被标记为不符合运行资源的条件。处于脱机状态的节点表示该节点上未运行集群服务、原因可能是已手动停止或节点已重新启动/关闭。</block>
  <block id="39dd7b2f17eda84e2e8059bb568493c9" category="admonition">节点首次启动时、集群服务将停止、需要手动启动、以避免意外将资源故障恢复到运行状况不正常的节点。</block>
  <block id="cbc566d6b815d43dd99c76ca8f2fd4f8" category="paragraph">如果节点由于非管理原因(例如故障)处于备用或脱机状态、则会在节点状态旁边用圆括号显示其他文本。例如、如果禁用了隔离、并且某个资源遇到了您将看到的故障<block ref="1db3c4bcbb494ae3b1b2e86c57842a69" prefix=" " category="inline-code"></block>。另一种可能的状态是<block ref="3fd6d1573d7af30709095c1a01f1fdd9" prefix=" " category="inline-code"></block>、该节点会被简要视为已隔离节点、但如果隔离失败、则此隔离将持续存在、指示集群无法确认节点的状态(这可能会阻止其他节点上启动资源)。</block>
  <block id="56cfcb8bfa2e43de0547ffbf4a2edd0e" category="paragraph">下一节显示了集群中所有资源及其状态的列表：</block>
  <block id="45caf63eb71a242bf4ef160a8aeeb2a4" category="paragraph">与节点类似、如果资源存在任何问题、则会在资源状态旁边用圆括号显示其他文本。例如、如果Pacemaker请求停止资源、但此操作无法在分配的时间内完成、则Pacemaker将尝试隔离此节点。如果禁用了隔离或隔离操作失败、则资源状态将为<block ref="bb38152bf8b813a142650a06ad87363e" prefix=" " category="inline-code"></block> Pacemaker将无法在其他节点上启动它。</block>
  <block id="028c86c0d3bdc4a78f8123e9fad41847" category="paragraph">值得注意的是、BeeGFS HA集群使用了许多经过BeeGFS优化的自定义OCF资源代理。特别是、BeeGFS监控器负责在特定节点上的BeeGFS资源不可用时触发故障转移。</block>
  <block id="0532f63b7151a82cb4b5e3351e2371d0" category="summary">正常停止和启动HA集群。</block>
  <block id="7479b021f04933331bfad4de007ca0c2" category="doc">停止并启动集群</block>
  <block id="2b884da4a956e42f63bc07b5d20c50b1" category="paragraph">本节介绍如何正常关闭和重新启动BeeGFS集群。可能需要执行此操作的示例场景包括电气维护或在数据中心或机架之间迁移。</block>
  <block id="c61d5048d10a534a03e7687782b475e2" category="paragraph">如果出于任何原因需要停止整个BeeGFS集群并关闭、则会运行所有服务：</block>
  <block id="3ad6e9988864aeae2ef386345946dc6d" category="inline-link-macro">故障转移</block>
  <block id="9e94ba8f70ed52b0ae6c2a8725f97a9f" category="paragraph">要在所有节点上启动集群服务和资源、请运行：</block>
  <block id="80bd5673b361d19dc46e6b882f98b061" category="paragraph">或使用以下命令在特定节点上启动服务：</block>
  <block id="56ad9ec5396c5f035697d1e62c4b0926" category="paragraph">此时、请运行<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 并验证集群和BeeGFS服务是否已在所有节点上启动、以及服务是否正在预期节点上运行。</block>
  <block id="9cdd9805effd30bec624c806fd980309" category="summary">在集群节点之间移动BeeGFS服务。</block>
  <block id="f6054493b235622c6d85c56597db1eb1" category="doc">故障转移和故障恢复服务</block>
  <block id="2c053c4f4aa73d509803b712a335712b" category="paragraph">BeeGFS服务可以在集群中的节点之间进行故障转移、以确保客户端能够在节点发生故障或您需要执行计划内维护时继续访问文件系统。本节介绍管理员在从故障中恢复后修复集群或在节点之间手动移动服务的各种方法。</block>
  <block id="07216bb55061288a2fa29cda954742e3" category="section-title">故障转移和故障恢复</block>
  <block id="23709dbf750335ca35bb098cb16932f2" category="section-title">故障转移(计划内)</block>
  <block id="805e61a2ff2aebdab58587660993241c" category="paragraph">通常、当您需要使单个文件节点脱机进行维护时、您需要从该节点移动(或消耗)所有BeeGFS服务。要实现此目的、可以先将节点置于备用状态：</block>
  <block id="ecbf8d7e7d9f1eb0a529231cebd2199c" category="paragraph"><block ref="45235c2d84b11e465f5ed5176cc9fc73" prefix="" category="inline-code"></block></block>
  <block id="badd2ea7f58914039bb51471883e3461" category="paragraph">验证后使用<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 已在备用文件节点上重新启动所有资源、您可以根据需要关闭此节点或对其进行其他更改。</block>
  <block id="1343bdd328b646934d900b04ee8ba9bd" category="section-title">故障恢复(计划内故障转移之后)</block>
  <block id="746bffd8542d5a995ff4e29343881c45" category="paragraph">准备好先将BeeGFS服务还原到首选节点时、请先运行<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 并在"节点列表"中验证状态是否为备用。如果节点已重新启动、它将显示脱机、直到您使集群服务联机为止：</block>
  <block id="91e6580245db1e731f9ba78076973736" category="paragraph">节点联机后、使用以下命令将其置于备用状态：</block>
  <block id="040901cb649ee5383b238c42c7746fca" category="paragraph">最后、使用以下命令将所有BeeGFS服务重新定位回其首选节点：</block>
  <block id="6ebfd7088ae3d5d766caee83ef99e7bc" category="section-title">故障恢复(计划外故障转移之后)</block>
  <block id="e09245effc62059e51f926fad603e413" category="inline-link-macro">故障排除</block>
  <block id="364ed45bbda2e3fd57309efe24fc0d55" category="paragraph">如果节点在计划外(或计划内)重新启动后启动、则集群服务不会设置为自动启动、因此您首先需要使用以下命令使节点联机：</block>
  <block id="f00b2994ca5cfc6ab0328a63736caa02" category="paragraph">接下来、清理任何资源故障并重置节点的隔离历史记录：</block>
  <block id="ac161f403f36186463574a43968aa121" category="paragraph">在中验证<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 节点已联机且运行状况良好。默认情况下、BeeGFS服务不会自动进行故障恢复、以避免意外将资源移回运行状况不正常的节点。准备好后、使用以下命令将集群中的所有资源返回到其首选节点：</block>
  <block id="a65e0cef92147365de773d870438a30d" category="section-title">将单个BeeGFS服务移动到备用文件节点</block>
  <block id="606a28acf3a90904d7e27f3497573da7" category="section-title">将BeeGFS服务永久移动到新文件节点</block>
  <block id="8f56c19ef179745c1437a4f477337649" category="paragraph">如果要永久更改单个BeeGFS服务的首选文件节点、请调整Ansible清单、以便首先列出首选节点、然后重新运行Ansible攻略手册。</block>
  <block id="346788f496d57b1e768d1dfaccdb3660" category="section-title">临时将BeeGFS服务移动到备用文件节点</block>
  <block id="bad9cbcf702b276e1564c24e67ad301c" category="paragraph">通常、如果某个节点正在进行维护、您需要使用[故障转移和故障恢复步骤](#故障转移和故障恢复)将所有服务从该节点移出。</block>
  <block id="0a51cf78eac085426260a02c70378519" category="paragraph">如果出于某种原因需要将单个服务移动到其他文件节点、请运行：</block>
  <block id="15bda9336e0e061125e3b40fe7bfbb0f" category="paragraph">要将BeeGFS服务移回其首选节点、请先清除临时资源限制(根据需要对多个服务重复此步骤)：</block>
  <block id="d5c46792adbb43a012cbc1e858dc8bf4" category="paragraph">然后、在准备好将服务实际移回其首选节点时、运行：</block>
  <block id="05ccfd1bb05ec0cb0ad0dbc5cfa2b32d" category="paragraph">注意：此命令将重新定位不再具有临时资源限制的任何服务、而这些服务不位于其首选节点上。</block>
  <block id="b64fbf2b70c0da78d7c165d234dbde59" category="summary">如果原始服务器出现故障、请更换文件节点。</block>
  <block id="813789e46622daf96cc8a246b7123900" category="doc">替换文件节点</block>
  <block id="7d8e819a8720821d1bda4944e3b284f8" category="paragraph">本节概述了更换集群中的文件节点所需的步骤。以下步骤假定文件节点因硬件问题描述 而失败、并替换为新的相同文件节点。</block>
  <block id="0ca6560aa88bd22fa1b3bb69d8594555" category="section-title">步骤</block>
  <block id="237c1293f678bb3fb45da7ff985bc6ff" category="list-text">物理更换文件节点、并还原到块节点和存储网络的所有布线。</block>
  <block id="2fcfb8cbd69fbc9fbfe292049243f520" category="list-text">在文件节点上重新安装操作系统、包括添加Red Hat订阅。</block>
  <block id="54bf3b134460f90ada283da98dfe7f55" category="list-text">在文件节点上配置管理和BMC网络。</block>
  <block id="e07337279837c08243349fd1812b45ad" category="list-text">如果主机名、IP、PCIe到逻辑接口映射或有关新文件节点的任何其他更改、请更新Ansible清单。通常、如果节点已更换为相同的服务器硬件、而您使用的是原始网络配置、则不需要执行此操作。</block>
  <block id="1092a09068da1d54ef98835a92b7ae93" category="list-text">例如、如果主机名发生更改、请创建(或重命名)节点的清单文件 <block ref="68c99491876298ad1740f875d0009eb1" prefix="(" category="inline-code"></block>)、然后在Ansible清单文件中 <block ref="d28e452e49fc926f32af1d87afcff3ce" prefix="(" category="inline-code"></block>)、将旧节点的名称替换为新节点名称：</block>
  <block id="4e77e3629d6cf2dd24d01cd0816444dc" category="list-text">从集群中的其他一个节点中、删除旧节点：<block ref="0b3c8b6f1b9e3417f6658a2d7bf57e50" prefix=" " category="inline-code"></block>。</block>
  <block id="80b3f35b9a09098f23ac89ae2b86b045" category="admonition">请勿在运行此步骤之前继续操作。</block>
  <block id="b13bbcb9af62574d6f02dd11fb1e8467" category="list-text">在Ansible控制节点上：</block>
  <block id="bdd8d1913bd5c9a453285898025b96c3" category="list-text">使用删除旧SSH密钥：</block>
  <block id="357f3d871a04ba99dca4088160a070c7" category="list-text">使用以下命令为替换节点配置无密码SSH：</block>
  <block id="7142a43bd39c703832e1dedd5cc1781d" category="list-text">重新运行Ansible攻略手册以配置节点并将其添加到集群：</block>
  <block id="cb6fdf37da197d680c43c0f6f18ad11d" category="list-text">此时、请运行<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 并验证已更换的节点现在是否已列出并正在运行服务。</block>
  <block id="7728706b8b42de0081920e7246a76547" category="summary">防止HA集群意外对环境中的预期更改做出响应。</block>
  <block id="e1fee8e589d1f622a7c4194531dd6d51" category="doc">将集群置于维护模式</block>
  <block id="de51662eceb9c88ae773c201eb0345d1" category="paragraph">将集群置于维护模式将禁用所有资源监控、并阻止Pacemaker移动或以其他方式管理集群中的资源。所有资源都将在其原始节点上保持运行状态、无论是否出现临时故障情况、从而使其无法访问。建议/有用的情形包括：</block>
  <block id="ea4d028cbc39da373f2405d19e55ab0f" category="list-text">网络维护、可能会暂时中断文件节点与BeeGFS服务之间的连接。</block>
  <block id="fb9f2ee248fa11ccfb854f09fcda2a80" category="list-text">块节点升级。</block>
  <block id="92a6e3227dfe7be15777e64043fb613f" category="list-text">文件节点操作系统、内核或其他软件包更新。</block>
  <block id="6c1cf36b91fdf2375e857652291bab2e" category="paragraph">通常、手动将集群置于维护模式的唯一原因是、防止集群对环境中的外部更改做出响应。如果集群中的单个节点需要物理修复、请勿使用维护模式、只需按照上述操作步骤 将该节点置于备用状态即可。请注意、重新运行Ansible会自动将集群置于维护模式、以便于进行大多数软件维护、包括升级和配置更改。</block>
  <block id="bbf6745fae83e12806200feeb795f0ef" category="paragraph">要检查集群是否处于维护模式、请运行：</block>
  <block id="4ecbc8384cde54344112e6ab08db42be" category="paragraph">您可以通过运行pcs状态并确保所有资源显示"(非受管)"来进行验证。要使集群退出维护模式、请运行：</block>
  <block id="9afe1c93907babebeb4d7a466e216a3e" category="summary">在集群中添加或删除组件。</block>
  <block id="da82c1c93eafcb34930ae3da89361e1e" category="doc">扩展或缩减集群</block>
  <block id="c8fb5d104008cab3ab8a229181f5dfac" category="paragraph">本节介绍了调整BeeGFS HA集群大小的各种注意事项和选项。通常、可以通过添加或删除组件来调整集群大小、这些组件通常是将两个文件节点设置为HA对的组件。如果需要、还可以添加或删除单个文件节点(或其他类型的集群节点)。</block>
  <block id="711c6d6edaed786b4dc0203b75460778" category="section-title">向集群添加组件</block>
  <block id="ea61e2c2ff507048203824add1eb7c21" category="section-title">注意事项</block>
  <block id="f29b9abf87c880782cf8c378e24a1668" category="paragraph">通过添加更多组件来扩展集群是一个简单的过程。开始之前、请牢记每个HA集群中集群节点的最小和最大数量限制、并确定是否应向现有HA集群添加节点或创建新的HA集群。通常、每个组件都包含两个文件节点、但每个集群的最小节点数为三个节点(用于建立仲裁)、建议的最大值为十个(已测试)。对于高级情形、可以在部署双节点集群时添加一个不运行任何BeeGFS服务的"Tiebreaker "节点。如果您考虑进行此类部署、请联系NetApp支持部门。</block>
  <block id="662a466b951b1af4fe3b4c3fd2e0370c" category="paragraph">在决定如何扩展集群时、请记住这些限制以及任何预期的未来集群增长。例如、如果您有一个六节点集群、并且需要再添加四个节点、则建议您只启动一个新的HA集群。</block>
  <block id="2b988a3f29ebee8dccd80147a22c1bc6" category="admonition">请记住、一个BeeGFS文件系统可以由多个独立的HA集群组成。这样、文件系统就可以继续扩展、远远超出底层HA集群组件的建议/硬限制。</block>
  <block id="c9e209235fa71f94c6ca46692bb327a3" category="inline-link-macro">使用自定义架构</block>
  <block id="0a9e15a6a510b24d4e6ac91c02152457" category="paragraph">创建正确的文件后、只需使用命令重新运行自动化即可：</block>
  <block id="8d695d37ced4690199d537aed9d4bd55" category="section-title">从集群中删除组件</block>
  <block id="b68ea55d7263db6f96db88774fb7b864" category="paragraph">在需要停用组件时、需要牢记一些注意事项、例如：</block>
  <block id="c26cc9593863fbf09a98a7c1809d4501" category="list-text">此组件正在运行哪些BeeGFS服务？</block>
  <block id="64e344a53d6a50c0b641de71dcc0d0e6" category="list-text">是否只是文件节点停用、块节点应附加到新的文件节点？</block>
  <block id="de3bc01ba61503e7b8699b9318d0fd0b" category="list-text">如果停用整个组件、数据应移至新的组件、分散到集群中的现有节点中、还是移动到新的BeeGFS文件系统或其他存储系统？</block>
  <block id="b6bb45be6629ebff573a5364d6abba3e" category="list-text">是否可以在中断期间发生这种情况、或者是否应在无中断的情况下进行？</block>
  <block id="9b0ed7965704c34f1d45d89e7afe7bfc" category="list-text">该组件是否正在使用中、或者它是否主要包含不再处于活动状态的数据？</block>
  <block id="2f1f874ab85cc95aedb0e31639ddd1be" category="paragraph">由于可能的起始点和所需的最终状态各不相同、因此请联系NetApp支持部门、以便我们能够根据您的环境和要求确定并帮助实施最佳策略。</block>
  <block id="1819205ce38618cd2752bb84e2b73e58" category="summary">对BeeGFS HA集群进行故障排除。</block>
  <block id="d60c463bb4096f3ed4bd1618626dfe10" category="doc">故障排除</block>
  <block id="b162a91192a0936d7593cb252c65dfd8" category="paragraph">本节将介绍如何调查各种故障以及在运行BeeGFS HA集群时可能出现的其他情形并对其进行故障排除。</block>
  <block id="40327cd11d60bd1f114b3e4566f94e50" category="section-title">故障排除指南</block>
  <block id="e1c58302972da23d09a5ab5fe221a170" category="section-title">正在调查意外故障转移</block>
  <block id="4fbaa99fc13cc42ed40e8b05969de8fb" category="paragraph">当节点意外隔离并将其服务移至另一个节点时、第一步应是查看集群是否在底部指示任何资源故障<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block>。如果成功完成隔离且资源已在另一节点上重新启动、则通常不会显示任何内容。</block>
  <block id="31288ba37f67baa9a96377c197fd16b4" category="paragraph">通常、下一步是使用搜索整个systemd日志<block ref="eed23a3d2310f43954a09887cb36b398" prefix=" " category="inline-code"></block> 在其余任何一个文件节点上(所有节点上的Pacemaker日志均会同步)。如果您知道发生故障的时间、则可以在发生故障之前开始搜索(通常建议至少提前十分钟)：</block>
  <block id="adc8528fced336e7a819071c746b5738" category="paragraph">以下各节显示了您可以在日志中查看的常见文本、以进一步缩小调查范围。</block>
  <block id="a6dea15cd908ef20a94b7b92df902f0b" category="section-title">调查/解决步骤</block>
  <block id="d418f50c5ddea28b4ca856017b36cb20" category="section-title">第1步：检查BeeGFS监控器是否检测到故障：</block>
  <block id="a0d295ceecafcdade2e77c52fee836e0" category="paragraph">如果故障转移是由BeeGFS监控器触发的、则应看到错误(如果不是、请继续执行下一步)。</block>
  <block id="ba35f78b5ee9757310a818131880e7ba" category="admonition">与Pacemaker中的日志不同、BeeGFS服务的日志不会分发到集群中的所有节点。要调查这些类型的故障、需要原始节点中发生故障的日志。</block>
  <block id="e7ed0a662a65a2b9a77688262294bdeb" category="paragraph">监控器可能报告的问题包括：</block>
  <block id="7cdeb72a25ab193e904385b516b1b346" category="list-text">无法访问目标！</block>
  <block id="b5937b98653f70b6902650183cf4ec74" category="list-text">问题描述 ：表示无法访问块卷。</block>
  <block id="2fe85519f178203eb9e17cd7d958eff5" category="list-text">故障排除：</block>
  <block id="a337b1ea21fcd18ca666a6d53d5d43cd" category="list-text">如果此服务也无法在备用文件节点上启动、请确认块节点运行状况良好。</block>
  <block id="1a92a4c3328c821522ae4b4f7b7939f4" category="list-text">检查是否存在任何可能阻止从此文件节点访问块节点的物理问题、例如、InfiniBand适配器或缆线出现故障。</block>
  <block id="07d73b1c441d1587365e83eab249cc0e" category="list-text">无法访问网络！</block>
  <block id="640de5e4317b2b6b4cdfc75056c11dc1" category="list-text">问题描述 ：客户端用于连接到此BeeGFS服务的适配器均未联机。</block>
  <block id="a6fe0c48e93a5942e6a707553dc58b72" category="list-text">如果多个/所有文件节点受到影响、请检查用于连接BeeGFS客户端和文件系统的网络是否存在故障。</block>
  <block id="89af81e10eaa132cd26657feb6c0255d" category="list-text">检查是否存在任何可能阻止从此文件节点访问客户端的物理问题、例如InfiniBand适配器或缆线出现故障。</block>
  <block id="74a668540699bf39afc1015b6ce839e7" category="list-text">BeeGFS服务未处于活动状态！</block>
  <block id="d297ccf512793d172de0cfd4051e2e96" category="list-text">问题描述 ：BeeGFS服务意外停止。</block>
  <block id="4937184e80e5bebefae7244965d351b9" category="list-text">在报告错误的文件节点上、检查受影响的BeeGFS服务的日志以查看它是否报告崩溃。如果发生这种情况、请向NetApp支持部门创建一个案例、以便可以调查崩溃情况。</block>
  <block id="feec20659fe99c02d4979b8ad026cc97" category="list-text">如果BeeGFS日志中未报告任何错误、请检查日志日志以查看systemd是否记录了服务停止的原因。在某些情况下、BeeGFS服务可能没有机会在进程终止之前记录任何消息(例如、有人运行时)<block ref="c287e2fa9b978b64df6b25bc14f4ebad" prefix=" " category="inline-code"></block>）。</block>
  <block id="6c187654c83a0705225e629e5ef0e690" category="section-title">第2步：检查节点是否意外离开集群</block>
  <block id="48de5b8ba61031259301e7dcfed5f30f" category="paragraph">如果节点发生了一些灾难性硬件故障(例如、系统主板已损坏)或发生内核崩溃或类似的软件问题描述 、BeeGFS监控器将不会报告错误。而是查找主机名、此时您应看到Pacemaker发出的消息、指出节点意外丢失：</block>
  <block id="e2c890774d7c7d0dbdd940e9e70a6e38" category="section-title">第3步：验证Pacemaker是否能够隔离节点</block>
  <block id="233ac49c948b907a2f3ece7ba249837e" category="paragraph">在所有情况下、您都应看到Pacemaker尝试隔离节点、以验证其是否实际脱机(确切消息可能因隔离的发生原因 而异)：</block>
  <block id="43878a52c3fd9ee95d536dd53db82be8" category="paragraph">如果隔离操作成功完成、您将看到如下消息：</block>
  <block id="c9fc2871ff88666659a1639b7bc7a907" category="paragraph">如果隔离操作因某种原因失败、则BeeGFS服务将无法在另一个节点上重新启动、以避免出现数据损坏的风险。如果隔离设备(PDU或BMC)不可访问或配置不当、则该问题描述 将单独进行调查。</block>
  <block id="824b5f569e1c282ba489e1d3fe24611f" category="section-title">解决失败的资源操作(位于pcs状态的底部)</block>
  <block id="ac9c4f2d9dc79954795119e7ac4da835" category="inline-link-macro">计划外故障转移后的故障恢复</block>
  <block id="afdd1f65895e11b4a9ab295926e39116" category="paragraph">否则、通常只能在两种情况下看到"资源操作失败"。</block>
  <block id="43c78de0154f6f48f749527f62bfd41c" category="section-title">场景1：检测到使用隔离代理的临时或永久问题描述 、并且已重新启动或将其移动到其他节点。</block>
  <block id="b06e37c96b80ada3e042c0997f9d54a6" category="paragraph">某些隔离代理比其他隔离代理更可靠、每个隔离代理都将实施自己的监控方法、以确保隔离设备已准备就绪。特别是、我们发现Redffish隔离代理报告的资源操作失败、即使它仍显示为已启动：</block>
  <block id="13ff1974a31501c1a357c51cda2ff685" category="paragraph">如果隔离代理报告某个特定节点上的资源操作失败、则不会触发该节点上运行的BeeGFS服务的故障转移。只需在同一节点或不同节点上自动重新启动即可。</block>
  <block id="549252a4b6f49c6993519d622a3e9c5d" category="paragraph">解决步骤：</block>
  <block id="51f376a71f801714c5dbbdfa83541a86" category="list-text">如果隔离代理始终拒绝在全部或部分节点上运行、请检查这些节点是否能够连接到隔离代理、并验证是否已在Ansible清单中正确配置隔离代理。</block>
  <block id="1ae58017c838c0e0ed1e3299e7c683d5" category="list-text">例如、如果Redsfish (BMC)隔离代理与它负责隔离的节点运行在同一个节点上、而操作系统管理和BMC IP位于同一个物理接口上、则某些网络交换机配置将不允许这两个接口之间进行通信(以防止网络环路)。默认情况下、HA集群会尝试避免在其负责隔离的节点上放置隔离代理、但在某些情形/配置中可能会发生这种情况。</block>
  <block id="217b4320fb1b29ae95bb478645ec6ba8" category="list-text">解决所有问题后(或者如果问题描述 似乎是临时的)、请运行<block ref="b292ce60014c1c0e30e4db1f177243d3" prefix=" " category="inline-code"></block> 重置失败的资源操作。</block>
  <block id="5e2b597167eb07cb64833681dcd53f6f" category="section-title">场景2：BeeGFS监控器检测到问题描述 并触发故障转移、但出于某种原因、资源无法在二级节点上启动。</block>
  <block id="cf41377d64715247d22bef68c671d9dc" category="paragraph">如果已启用隔离且未阻止资源在原始节点上停止(请参见"备用(故障)"故障排除部分)、则最可能的原因包括在二级节点上启动资源时出现问题、因为：</block>
  <block id="ecbc2fa36aa8e4ccfd535f315ff5a1bc" category="list-text">二级节点已脱机。</block>
  <block id="9fc9f95992286a812b388e7c2def3cde" category="list-text">物理或逻辑配置问题描述 会阻止二级系统访问用作BeeGFS目标的块卷。</block>
  <block id="1ffc42a5bdee5039a96dffea4901017d" category="list-text">对于失败的资源操作中的每个条目：</block>
  <block id="fb6dc7c10276db82fd903122c9aa6780" category="list-text">确认失败的资源操作为启动操作。</block>
  <block id="6ec17a9b3e2983ef695c793467180ed8" category="list-text">根据出现故障的资源操作中指示的资源和指定的节点：</block>
  <block id="15cdec9d63ec68e3300810746f7c66c5" category="list-text">查找并更正可能会阻止节点启动指定资源的任何外部问题。例如、如果BeeGFS IP地址(浮动IP)无法启动、请确认至少有一个所需接口已连接/联机并已连接到正确的网络交换机。如果BeeGFS目标(块设备/E系列卷)发生故障、请验证与后端块节点的物理连接是否按预期连接、并验证块节点是否运行正常。</block>
  <block id="66f0528ed6c9cd01b92486aef88bca25" category="list-text">如果没有明显的外部问题、并且您希望在此事件中使用根发生原因 、建议您先与NetApp支持部门一起创建案例进行调查、然后再继续操作、因为以下步骤可能会使根发生原因 分析(Root Analysis、RCA)变得极具挑战性/不可能。</block>
  <block id="3f79d63c01f8e573f1485641a01784f5" category="list-text">解决任何外部问题后：</block>
  <block id="0fc5581e5e588d921d0659c6725c8bb7" category="list-text">从Ansible inventory.yml文件中注释掉所有无法正常工作的节点、然后重新运行完整的Ansible攻略手册、以确保在二级节点上正确设置所有逻辑配置。</block>
  <block id="837bc4d502bb7c6e4bb1557e18c0d778" category="list-text">注意：在节点运行状况良好且您准备好进行故障恢复后、请勿忘记取消对这些节点的注释并重新运行攻略手册。</block>
  <block id="7198cccc6bdd4a3f49c6f73aecb797e3" category="list-text">或者、您也可以尝试手动恢复集群：</block>
  <block id="6db4e0b9e5f080b1d47896ae71390476" category="list-text">使用以下命令将所有脱机节点重新联机：<block ref="2e6a9bc781ade1dd9ff94654afbc34bd" prefix=" " category="inline-code"></block></block>
  <block id="0292b418af30a3106696db822913b4fd" category="list-text">使用以下命令清除所有失败的资源操作：<block ref="b292ce60014c1c0e30e4db1f177243d3" prefix=" " category="inline-code"></block></block>
  <block id="8177fac49f20d8c76b3afe0ead42fe89" category="list-text">运行pcs状态并验证所有服务是否按预期启动。</block>
  <block id="0a584da0f19f70578ae419f6c3de1804" category="list-text">如果需要、请运行<block ref="31b8a2d98f4312a9e7b7ac373d9cca6a" prefix=" " category="inline-code"></block> 将资源移回其首选节点(如果有)。</block>
  <block id="b34551a00d39152d67273fc8e1fc4a52" category="section-title">常见问题</block>
  <block id="e728c5fcf9b4ab50066868a6b637a709" category="section-title">BeeGFS服务在请求时不会进行故障转移或故障恢复</block>
  <block id="07f7fa9ba2b669bb79d185d75b136e12" category="paragraph">*可能的问题描述 ：*<block ref="960b2f261f11ad1988eea18a4ecc34c9" prefix=" " category="inline-code"></block> 运行命令已执行、但从未成功完成。</block>
  <block id="844f68b15c1713a6baa4b0ec6aa225df" category="paragraph">*如何检查：*运行<block ref="5a4892b5d40be89d668321c86afd400b" prefix=" " category="inline-code"></block> 并检查ID为的任何位置约束<block ref="2fcf6d99d76b884a404fa4e359bf2b59" prefix=" " category="inline-code"></block>。</block>
  <block id="9e43dd5b3ec5864eaeb73e8dc9a4a445" category="paragraph">*如何解决：*运行<block ref="3132f7183339b30b65d4c94ec98e59c6" prefix=" " category="inline-code"></block> 然后重新运行<block ref="5a4892b5d40be89d668321c86afd400b" prefix=" " category="inline-code"></block> 以验证是否已删除额外的约束。</block>
  <block id="1950007e622fca4ac1ecb2dca5c5b0ca" category="section-title">禁用隔离后、处于pcs状态的一个节点将显示"standby (on-fail)"</block>
  <block id="7f73632b6cb42dac5be42f899b8f3075" category="paragraph">*可能的问题描述 ：* Pacemaker无法成功确认故障节点上的所有资源均已停止。</block>
  <block id="62e46498125737c7dea16f67e65f663b" category="paragraph">*如何解决：*</block>
  <block id="2443318955c1e9ac3d484a3a95366847" category="list-text">运行<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 并检查输出底部是否存在未"启动"或显示错误的任何资源、并解决任何问题。</block>
  <block id="fde999fddc7a609f9b1112a0d74b811e" category="list-text">要使节点恢复联机、请运行<block ref="22c6d25b4cef458448bf6ec7b072cfdc" prefix=" " category="inline-code"></block>。</block>
  <block id="0b566700630488a9f296399143b71b21" category="section-title">在发生意外故障转移后、如果启用了隔离、则资源将以pcs状态显示"started (on-fail)"</block>
  <block id="d82216004991d1ee26d8a39d995fd037" category="paragraph">*可能的问题描述 ：*发生了一个问题、触发了故障转移、但Pacemaker无法验证节点是否已隔离。发生这种情况的原因可能是隔离配置不当或存在具有隔离代理的问题描述 (例如：PDU已与网络断开连接)。</block>
  <block id="d9377bb89128ecc3849d522366a1bc0e" category="list-text">验证节点是否已实际关闭。</block>
  <block id="26cf4911b5df9522d0b71ba51aa2797f" category="admonition">如果您指定的节点实际上未关闭、但正在运行集群服务或资源、则会发生数据损坏/集群故障。</block>
  <block id="eb7adca6805c8d7130032cd721d69726" category="list-text">手动确认隔离：<block ref="5448b9bc8364c2b3f706918cda259325" prefix=" " category="inline-code"></block></block>
  <block id="1c0ee784ecf6c6dae18bd342462b0460" category="paragraph">此时、服务应完成故障转移并在另一个运行正常的节点上重新启动。</block>
  <block id="144c35532a298805242b9831523175df" category="section-title">常见故障排除任务</block>
  <block id="e78d742ead1e3187a4781d20c9f53692" category="section-title">重新启动单个BeeGFS服务</block>
  <block id="5bd968465c3ccdeb171ce7ade4907d6f" category="paragraph">通常、如果需要重新启动BeeGFS服务(例如、为了便于更改配置)、应通过更新Ansible清单并重新运行攻略手册来完成此操作。在某些情况下、可能需要重新启动单个服务以加快故障排除速度、例如更改日志记录级别而无需等待整个攻略手册运行。</block>
  <block id="57f3d071d972e615cf2b21fc580b3981" category="admonition">除非同时将任何手动更改添加到Ansible清单中、否则将在下次运行Ansible攻略手册时还原这些更改。</block>
  <block id="e6ec687230170238fbff13af150aac11" category="section-title">选项1：由系统d控制的重新启动</block>
  <block id="8bd682031ba8c79bdc3518a66ecb5f1d" category="paragraph">如果存在BeeGFS服务无法使用新配置正确重新启动的风险、请先将集群置于维护模式、以防止BeeGFS监控器检测到服务已停止并触发不需要的故障转移：</block>
  <block id="e445f63138e0cf42d48b191e7212fba5" category="paragraph">如果需要、可通过对服务配置进行任何更改<block ref="7b2e56941196b9587e16891bfbec2093" prefix=" " category="inline-code"></block> (例如：<block ref="e3cb2c4f0757837b4a51b638bed0ec4d" prefix=" " category="inline-code"></block>)、然后使用systemd重新启动它：</block>
  <block id="fc618f42db9108f58f9c7fc76181a551" category="paragraph">示例<block ref="d1adfe915ae154bb103f4a2e2d28183d" prefix=" " category="inline-code"></block></block>
  <block id="b8a88c45f80fb4ad388f6cfe0958b272" category="section-title">选项2：起搏器控制的重新启动</block>
  <block id="b28d67df7faeb6762f0262ed21fd5c44" category="paragraph">如果您不关心新配置是否可能发生原因 会使服务意外停止(例如、更改日志记录级别)、或者您处于维护窗口而不担心停机、则只需为要重新启动的服务重新启动BeeGFS监控器即可：</block>
  <block id="1ea90ec9ad2232dc8536efa244b502cd" category="paragraph">例如、要重新启动BeeGFS管理服务、请执行以下操作：<block ref="19191ce739dde363bc25ef750853010b" prefix=" " category="inline-code"></block></block>
  <block id="647328604bd666deba44b0caaea998a2" category="summary">了解如何在部署BeeGFS HA集群后对其进行管理。</block>
  <block id="0aa1ffb15625f418cfc560deda2535bb" category="doc">概述、关键概念和术语</block>
  <block id="d051e95d54ee33ed5c79e05f582bab59" category="paragraph">本节面向需要在部署BeeGFS HA集群后对其进行管理的集群管理员。即使是熟悉Linux HA集群的用户也应阅读本指南、因为在管理集群方面存在许多差异、尤其是在使用Ansible进行重新配置方面。</block>
  <block id="612b7c650263f39248b97e7e57b35a77" category="section-title">关键概念</block>
  <block id="db7e5dec439a7c83d48d86330a62e954" category="inline-link-macro">术语和概念</block>
  <block id="8961c26dabe98c278717f1cb0fc25fdc" category="paragraph">"*集群节点：*运行Pacemaker和Corosync服务并加入HA集群的服务器。</block>
  <block id="e0a3a06b3c015009967896eb40327e82" category="paragraph">*文件节点：*用于运行一个或多个BeeGFS管理、元数据或存储服务的集群节点。</block>
  <block id="1985ebdeb71d83b6b551914e77b2b178" category="paragraph">"*块节点：*一种为文件节点提供块存储的NetApp E系列存储系统。这些节点不会加入BeeGFS HA集群、因为它们可以提供自己的独立HA功能。每个节点都包含两个存储控制器、这些控制器可在块层提供高可用性。</block>
  <block id="31a3205f29074295100fad4351661826" category="paragraph">"BeeGFS服务：* BeeGFS管理、元数据或存储服务。每个文件节点将运行一个或多个服务、这些服务将使用块节点上的卷来存储其数据。</block>
  <block id="495f4cf25a1d9d4e5a1258aafbbf0c8d" category="paragraph">*构建块：* BeeGFS文件节点、E系列块节点以及在其上运行的BeeGFS服务的标准化部署、可简化按照NetApp经验证的架构横向扩展BeeGFS HA集群/文件系统的过程。自定义HA集群也受支持、但通常会采用类似的组件方法来简化扩展。</block>
  <block id="f1816719094f9c5af3f9f2666c1c5666" category="paragraph">"BeeGFS HA Cluster"：*用于运行由块节点提供支持的BeeGFS服务以高可用性方式存储BeeGFS数据的文件节点数量可扩展。基于行业认可的开源组件Pacemaker和Corosync构建、并使用Ansible进行打包和部署。</block>
  <block id="830f6f39f3eb0533714fc986605bb0fc" category="paragraph">"*集群服务："*是指在加入集群的每个节点上运行的Pacemaker和Corosync服务。请注意、如果只需要两个文件节点、则节点可能不会运行任何BeeGFS服务、而是仅以"Tiebreaker "节点的形式加入集群。</block>
  <block id="ac47f8eb4b50e1f3fefe94fafff761c2" category="paragraph">"*集群资源："*对于集群中运行的每个BeeGFS服务、您将看到一个BeeGFS监控资源和一个资源组、其中包含BeeGFS目标、IP地址(浮动IP)和BeeGFS服务本身的资源。</block>
  <block id="25d0c377de7b7699ce796352723a7a41" category="paragraph">"*可访问：*一种用于软件配置、配置管理和应用程序部署的工具、可将基础架构作为代码来启用。如何打包BeeGFS HA集群、以简化在NetApp上部署、重新配置和更新BeeGFS的过程。</block>
  <block id="53ece6444fc3a7adacd61f55a3d5e410" category="paragraph">"* pcs："* a command line interface available from any of the file nodes in the cluster used to query and control the state of nodes and resources in the cluster.</block>
  <block id="1ed63b060fea1b0497535f402b308312" category="section-title">通用术语</block>
  <block id="d3d43886ce330c5bc1abf87c9da84517" category="paragraph">**故障转移：*每个BeeGFS服务都有一个首选文件节点、除非该节点发生故障。当BeeGFS服务在非首选/二级文件节点上运行时、该服务称为处于故障转移状态。</block>
  <block id="360fc740d5a934107e93d720053a8a24" category="paragraph">"*。*故障恢复：*将BeeGFS服务从非首选文件节点移回其首选节点的操作。</block>
  <block id="1687b43e3f76609bd3a5dda1cdbd29b3" category="paragraph">"HA对："*可以访问同一组块节点的两个文件节点有时也称为HA对。这是整个NetApp通用的一个术语、指可以相互"接管"的两个存储控制器或节点。</block>
  <block id="3663bc32267b225ac55e52a4e99f2b3c" category="inline-link-macro">维护模式</block>
  <block id="e7f8a11794ad2275f244bec012ef84de" category="paragraph">** HA集群：*一个或多个运行BeeGFS服务的文件节点、这些文件节点可以在集群中的多个节点之间进行故障转移、以创建高可用性的BeeGFS文件系统。通常、文件节点会配置为HA对、这些HA对能够在集群中运行一部分BeeGFS服务。</block>
  <block id="c8c3d1dbab26a87a3652e84d9f35d37f" category="summary">何时应使用Ansible与pcs命令行工具来管理HA集群？</block>
  <block id="932c5a738d1d867e858cd1dbc1391b1a" category="doc">何时使用Ansible与pcs工具</block>
  <block id="272d3f535988cc62fbddd197f2ce0477" category="paragraph">所有集群部署和重新配置任务都应使用外部Ansible控制节点上的Ansible完成。集群状态的临时更改(例如、将节点置于待机状态和非待机状态)通常通过登录到集群的一个节点(最好是未降级或即将进行维护的节点)并使用pcs命令行工具来执行。</block>
  <block id="5b94af0d2c18b35c22f5cfa622f91a3c" category="paragraph">修改任何集群配置(包括资源、约束、属性和BeeGFS服务本身)都应始终使用Ansible完成。维护集群是为了维护Ansible清单和攻略手册的最新副本(理想情况下是为了控制源以跟踪更改)。如果需要更改配置、请更新清单并重新运行导入BeeGFS HA角色的Ansible攻略手册。</block>
  <block id="636c6afe41e34a0f4dc30a8fee8de25c" category="paragraph">HA角色将处理将集群置于维护模式的问题、然后在重新启动BeeGFS或集群服务以应用新配置之前进行任何必要的更改。由于在初始部署之外通常不需要完全重新启动节点、因此重新运行Ansible通常被视为"安全"操作步骤 、但始终建议在维护时段或非工作时间重新启动任何BeeGFS服务。这些重新启动通常不应发生发生原因 应用程序错误、但可能会影响性能(某些应用程序可能比其他应用程序处理得更好)。</block>
  <block id="cfe79eee27daf73a913f7b76cbb46461" category="paragraph">如果您希望将整个集群恢复为完全最佳状态、也可以选择重新运行Ansible、并且在某些情况下、与使用pcs相比、恢复集群状态可能更容易。尤其是在集群因某种原因关闭的紧急情况下、所有节点都备份后、重新运行Ansible可能会比尝试使用pcs更快、更可靠地恢复集群。</block>
  <block id="c94162d41104b03145716ac6946bd39a" category="summary">使用Ansible重新配置集群。</block>
  <block id="388a6dd09725cda0da5d81c2d32f9c19" category="doc">重新配置HA集群和BeeGFS</block>
  <block id="cb584c33a4eae31ed6d0c6ae575a915c" category="inline-link-macro">指定通用文件节点配置</block>
  <block id="f7f37d848a0be4caeb97d6886778dc2a" category="paragraph">有关管理员在执行集群维护或维护时应注意的部分配置选项的其他详细信息、请参见下文。</block>
  <block id="d876616b83b1231cc28d82f157ed29c5" category="section-title">如何禁用和启用隔离</block>
  <block id="22228968b8b77db0d4e57d7cb284feb3" category="paragraph">设置集群时、默认情况下会启用/需要隔离。在某些情况下、可能需要暂时禁用隔离、以确保在执行某些维护操作(例如升级操作系统)时节点不会意外关闭。虽然可以手动禁用此功能、但管理员应注意一些利弊权衡。</block>
  <block id="bdb2b6bd7635150b7e92a51e70612e12" category="section-title">选项1：使用Ansible禁用隔离(建议)。</block>
  <block id="619a84cba5006df3e436e2a726ca2871" category="paragraph">使用Ansible禁用隔离后、BeeGFS监控器的"发生故障"操作将从"隔离"更改为"备用"。这意味着、如果BeeGFS监控器检测到故障、它将尝试将节点置于备用状态并对所有BeeGFS服务进行故障转移。在外部主动故障排除/测试中、这通常比选项2更理想。缺点是、如果某个资源无法在原始节点上停止、则会被阻止从其他位置启动(这就是生产集群通常需要隔离的原因)。</block>
  <block id="0809fe829e193f81980e79631c9c15cc" category="list-text">位于Ansible清单中<block ref="24eab3114da61057c831607cf391b3b9" prefix=" " category="inline-code"></block> 添加以下配置：</block>
  <block id="d73646db1bf30029f2486d5b7462cde5" category="list-text">重新运行Ansible攻略手册、将所做的更改应用于集群。</block>
  <block id="50a460b97c563d3429b629b6911db7d5" category="section-title">选项2：手动禁用隔离。</block>
  <block id="28850c63d2fb8db15eeb1664c121e11b" category="paragraph">在某些情况下、您可能希望在不重新运行Ansible的情况下临时禁用隔离、以便于对集群进行故障排除或测试。</block>
  <block id="e0740d4e01fcc73df3a73294627cd292" category="admonition">在此配置中、如果BeeGFS监控器检测到故障、集群将尝试停止相应的资源组。它不会触发完全故障转移、也不会尝试重新启动受影响的资源组或将其移动到其他主机。要进行恢复、请解决所有问题、然后运行<block ref="b292ce60014c1c0e30e4db1f177243d3" prefix=" " category="inline-code"></block> 或者手动将节点置于备用状态。</block>
  <block id="99f83169540f1c3e08a1e696707dcbee" category="list-text">要确定是否全局启用或禁用了隔离(stonith")、请运行：<block ref="f9bc36eebaadfbe3971849dbb1a7a291" prefix=" " category="inline-code"></block></block>
  <block id="88653da28715cbac123466935349c7b2" category="list-text">要禁用隔离、请运行：<block ref="d3749d5705f2a9af97f05b0c5c91b235" prefix=" " category="inline-code"></block></block>
  <block id="79c811c32be072ba96828f7eaf67e191" category="list-text">要启用隔离、请运行：<block ref="65795833f6c4653caabc1cbacafe84d8" prefix=" " category="inline-code"></block></block>
  <block id="54dfcc160f4c7fc21df07ee9c7df6f86" category="paragraph">注意：下次运行Ansible攻略手册时、此设置将被覆盖。</block>
  <block id="d60c67e58f8b774cb2aa20f043f8db60" category="summary">使用Ansible更新BeeGFS和HA集群。</block>
  <block id="51e0180a7b3c2158984fbbe6e8f869a0" category="paragraph">所有BeeGFS升级都应使用Ansible、包括在BeeGFS的主要、次要和修补版本之间移动。要更新BeeGFS、您首先需要更新BeeGFS Ansible集合、该集合还将提供有关部署/管理自动化和底层HA集群的最新修复和增强功能。即使更新到最新版本的集合、BeeGFS也不会升级、直到<block ref="6afa1ad605a4192ba2e50e8be9966e68" prefix=" " category="inline-code"></block> 与一起运行<block ref="1c5a0082b7b70fba66dc89c5dcadda70" prefix=" " category="inline-code"></block> 设置。</block>
  <block id="c647c561b083b3d7395174f66f8631ea" category="inline-link-macro">BeeGFS升级文档</block>
  <block id="c24ac53eed3b244d067e62d9a64dfd49" category="admonition">有关BeeGFS版本的详细信息、请参见 <block ref="8574fc3a2a061b998ddd0369208f121a" category="inline-link-macro-rx"></block>。</block>
  <block id="47d550a414d88378d8af3a8ee7202f43" category="paragraph">每个版本的BeeGFS集合都会使用特定版本的BeeGFS进行测试、以确保所有组件之间的互操作性。此外、还会执行测试、以确保可以从收集的最后一个版本支持的BeeGFS版本升级到最新版本支持的版本。</block>
  <block id="898fd772d03120abb80bc290103408c1" category="cell">原始版本</block>
  <block id="6b109fe64fc40b0f8653da2a76f4622d" category="cell">升级版本</block>
  <block id="4805ea9349955c3f72d0d2a6e29e9599" category="cell">多导轨</block>
  <block id="3ec365dd533ddb7ef3d1c111186ce872" category="cell">详细信息</block>
  <block id="0cbcbda5109bcde6b94054595b5c2163" category="cell">7.3.2</block>
  <block id="93cba07454f06a4a960172bbd6e2a435" category="cell">是的。</block>
  <block id="80af1bca395a5729dba29bf239d414de" category="cell">将beegfs收集从v3.0.1升级到v3.1.0、添加了多轨</block>
  <block id="cd0d3c01d5de47172fb0980b9e484085" category="cell">7.2.8</block>
  <block id="bafd7322c6e97d25b6299b5d6fe8920b" category="cell">否</block>
  <block id="f8c6df0b95129e4f957da4faa69e9a95" category="cell">将beegfs收集从v3.0.1升级到v3.1.0</block>
  <block id="90e738eca301c4d89366b1a4d15fe37f" category="cell">7.3.1</block>
  <block id="37ee8dee8daa5fa1f91e93f31f1e4548" category="cell">使用beegfs集合v3.1.0进行升级、并添加了多轨</block>
  <block id="35aee211b7a94a90469b8820e9b58379" category="cell">使用beegfs Collection v3.1.0进行升级</block>
  <block id="2f4c1ac28e39c823ee4c1a07b7cd93aa" category="paragraph">用于升级可访问的集合 <block ref="d8617fd1dfbd628e2360b843d6070e54" category="inline-link-macro-rx"></block>下，运行以下命令：</block>
  <block id="c199206a11a9882502e88de065338656" category="paragraph">要进行脱机收集升级、请从下载此收集 <block ref="d8617fd1dfbd628e2360b843d6070e54" category="inline-link-macro-rx"></block> 单击所需的<block ref="5ab34c986ae1945ee0c548bc8d6ac4a8" prefix=" " category="inline-code"></block> 然后<block ref="80af28150f2ffd9a902b18cd4e9b6656" prefix=" " category="inline-code"></block>。将tarball传输到Ansible控制节点并运行以下命令。</block>
  <block id="dd26fb41f43f69172e0099b87c9d0732" category="inline-link-macro">正在安装收集</block>
  <block id="6aa260cc14fabe54e7e9f6efd513b871" category="paragraph">请参见 <block ref="78e19afa50f5104f13264e857fffab2b" category="inline-link-macro-rx"></block> 有关详细信息 ...</block>
  <block id="e6811430a0324887ba2ad63393a262e1" category="inline-link-macro">版本升级说明</block>
  <block id="800371603b58ee549a4a9674cd231cfd" category="inline-link-macro">部署BeeGFS HA集群</block>
  <block id="5c349c42761230bd8e50fff98f6e7508" category="paragraph">要应用BeeGFS更新、请执行以下操作：</block>
  <block id="a2dd7653f3025e7feb8e282bcc0bde84" category="paragraph">BeeGFS HA角色将在后台处理：</block>
  <block id="2d304ec0e0fbeec292dc41145e2eecb0" category="list-text">确保集群处于最佳状态、每个BeeGFS服务都位于其首选节点上。</block>
  <block id="5f143f3872f8df75b9266e40b2272406" category="list-text">将集群置于维护模式。</block>
  <block id="400df38ef11abbe30ea67fa8e7200a0d" category="list-text">更新HA集群组件(如果需要)。</block>
  <block id="33421319eb71c7eeb0ce5b0e4a6e4b8f" category="list-text">按照以下步骤逐个升级每个文件节点：</block>
  <block id="e8e28076de7654eb24e044afdf734b1a" category="list-text">将其置于备用状态并将其服务故障转移到二级节点。</block>
  <block id="428a1ecc41f6178248f2f8dadec2f62b" category="list-text">升级BeeGFS软件包。</block>
  <block id="8a1d7e8d1dce93a3d4fb9150570283c2" category="list-text">回退服务。</block>
  <block id="f4a4c394b32e613eb518abe373f40c37" category="list-text">将集群移出维护模式。</block>
  <block id="2e5a7ec61feb5cc6bfdf6e50d5cc9a86" category="section-title">从BeeGFS 7.2.6或7.3.0版升级</block>
  <block id="7202d449c02688973a53bb72a0090f19" category="inline-link-macro">基于BeeGFS连接的身份验证</block>
  <block id="334d537e5273e4291972dbb772133d23" category="paragraph">7.3.1之后发布的BeeGFS版本将不再允许在未指定的情况下启动服务<block ref="6097b6e95af2579f2147a330c21f7b59" prefix=" " category="inline-code"></block> 或设置<block ref="194193db6aa10dc83a871ef82dae32ce" prefix=" " category="inline-code"></block> 在服务的配置文件中。强烈建议启用基于连接的身份验证安全性。请参见 <block ref="f745eac1796bcd7c76bb4ab7bb03be5b" category="inline-link-macro-rx"></block> 有关详细信息 ...</block>
  <block id="37075250adff19201f1f54be05b5a07a" category="paragraph">默认情况下、<block ref="59544be57ace17b034c14f8d12510eee" prefix=" " category="inline-code"></block> 角色将生成并分发此文件、同时将其添加到的Ansible控制节点<block ref="d60ea3ba7610ba191573b69dca307efb" prefix=" " category="inline-code"></block>。。<block ref="84f7933b4ff9fefcfc60fd5fff4b3b54" prefix=" " category="inline-code"></block> 角色还会检查此文件是否存在、并将其提供给客户端(如果有)。</block>
  <block id="1ea32c7c84666a27c0f0add65b2c620e" category="admonition">如果<block ref="84f7933b4ff9fefcfc60fd5fff4b3b54" prefix=" " category="inline-code"></block> 角色未用于配置客户端、需要手动将此文件分发到每个客户端和<block ref="6097b6e95af2579f2147a330c21f7b59" prefix=" " category="inline-code"></block> 中的配置<block ref="1b33ed41c854e3144951352c24ab4653" prefix=" " category="inline-code"></block> 要使用的文件集。从先前版本的BeeGFS升级时、如果未启用基于连接的身份验证、则客户端将丢失访问权限、除非在升级过程中通过设置禁用基于连接的身份验证<block ref="2ff6bdfeb6b3a41d28029b9ff7bdb93c" prefix=" " category="inline-code"></block> 在中<block ref="4003590e6e5408f8e5272e50f909dfac" prefix=" " category="inline-code"></block> (不建议)。</block>
  <block id="cc211dfb7bfb2c913740671716097933" category="summary">NetApp解决方案 上的BeeGFS将BeeGFS并行文件系统与NetApp E系列存储系统相结合、打造了一个可靠、可扩展且经济高效的基础架构、可满足苛刻的工作负载要求。</block>
  <block id="49274a22f777d8ee156d9a597e66731d" category="doc">概述和要求</block>
  <block id="4fde5e2673b7e14764688237d98539a4" category="paragraph">使用Ansible部署BeeGFS高可用性集群时、请使用任何NetApp E/EF系列存储系统作为BeeGFS块节点、使用x86服务器作为BeeGFS文件节点。</block>
  <block id="0b79795d3efc95b9976c7c5b933afce2" category="section-title">简介</block>
  <block id="58d7101385af8eaef1dc397806989cbb" category="inline-link-macro">经过NetApp验证的架构</block>
  <block id="6d2bf94f38d1fdf840fe9b231866899c" category="section-title">部署概述</block>
  <block id="00298d02a62e3ad710061bdb858bc72b" category="paragraph">通常、部署BeeGFS文件系统涉及以下步骤：</block>
  <block id="a3f59792a4244ec442fe3d6689ce5a5d" category="list-text">初始设置：</block>
  <block id="bed2a4653b2c422bf2632c104da5c873" category="list-text">安装硬件/为硬件布线。</block>
  <block id="a2d48c839c25c269a71b232a366cdfbc" category="list-text">设置文件和块节点。</block>
  <block id="e8ec50ce42367b5c2125ba84ee0b2b07" category="list-text">设置Ansible控制节点。</block>
  <block id="1166a5354ac02035abc5f968f7ed4570" category="list-text">将BeeGFS文件系统定义为Ansible清单。</block>
  <block id="45a41d17b919852e176b0bef9ba18dde" category="list-text">对文件和块节点运行Ansible以部署BeeGFS。</block>
  <block id="b29828241f384dfaa560eb24d45c7035" category="list-text">也可以设置客户端并挂载BeeGFS。</block>
  <block id="3b5256e7140e65040f9635a6b8b884ee" category="paragraph">后续章节将更详细地介绍这些步骤。</block>
  <block id="216c2fbf006b3f1ca9acdd60d04a9b4b" category="paragraph">Ansible负责处理所有软件配置和配置任务、包括：</block>
  <block id="fd699aca3f31bc5416fca3a153cc4779" category="list-text">在块节点上创建/映射卷。</block>
  <block id="7565e19b34a4d2460620720a599da376" category="list-text">格式化/调整文件节点上的卷。</block>
  <block id="8744d71fb56c3e75f875de0a416ea912" category="list-text">在文件节点上安装/配置软件。</block>
  <block id="dcc4901f1f1938989ed2264f42fd1104" category="list-text">建立HA集群并配置BeeGFS资源和文件系统服务。</block>
  <block id="077a8397a5f4ba0711faf87b91f8906c" category="paragraph">在Ansible中支持BeeGFS的发布时间为 <block ref="e5bec9f043c86b9afcbef28a688a4cdd" category="inline-link-macro-rx"></block> 作为一组角色和模块、用于自动执行BeeGFS HA集群的端到端部署和管理。</block>
  <block id="5207de659c47ed66a8f04540f2cf7d28" category="paragraph">BeeGFS本身采用&lt;major&gt; &lt;major&gt;。&lt;minor&gt;。&lt;patch&gt; 版本控制方案进行版本控制、该集合会为每个受支持的BeeGFS的BeeGFS &lt;minor&gt; 版本维护角色、例如BeeGFS 7.2或BeeGFS 7.3。发布此集合的更新后、每个角色中的修补程序版本将更新为指向该版本分支的最新可用BeeGFS版本(例如：7.2.8)。此外、该集合的每个版本还会通过特定的Linux分发版和版本进行测试并受支持、当前的Red Hat用于文件节点、RedHat和Ubuntu用于客户端。不支持运行其他分发版、也不建议运行其他版本(尤其是其他主要版本)。</block>
  <block id="ff58765d6c48f433685b2f9354c057ed" category="section-title">Ansible控制节点</block>
  <block id="267dc210028d3a563bde0eb07ca563a0" category="paragraph">此节点将包含用于管理BeeGFS的清单和攻略手册。它需要：</block>
  <block id="fa364b2fe46e5e06529d637ca126add1" category="list-text">Ansible 6.x (Ansible核心2.13)</block>
  <block id="3ac4555ed79bcb16976991998d5a957c" category="list-text">Python 3.6 (或更高版本)</block>
  <block id="44ebd117631269d8cc52eda82b890ecc" category="list-text">Python (pip)软件包：ipaddr和netaddr</block>
  <block id="8486bce50d4152772da3c4531a015ab8" category="paragraph">此外、建议您将控制节点中的无密码SSH设置为连接到所有BeeGFS文件节点和客户端。</block>
  <block id="5bca534f5a45c18ffc0306e63b306c62" category="section-title">BeeGFS文件节点</block>
  <block id="676b08aacbe937f16d558f23d90b29da" category="section-title">BeeGFS客户端节点</block>
  <block id="dc203cff346fc33ab19584264833d533" category="paragraph">可以使用BeeGFS客户端Ansible角色安装BeeGFS客户端软件包并管理BeeGFS挂载。此角色已通过RedHat 8.4和Ubuntu 22.04的测试。</block>
  <block id="2e0da5c1c3cbd1cda1312f57209c96e4" category="inline-link-macro">BeeGFS支持的Linux分发版和内核</block>
  <block id="b44b294130612c32e5f179fb81f347ec" category="paragraph">如果未使用Ansible设置BeeGFS客户端并挂载BeeGFS、则为any <block ref="ed8f85054917a214583881f0e58e2825" category="inline-link-macro-rx"></block> 可以使用。</block>
  <block id="03a96e493f11c9bdee76520257a1462d" category="summary">使用主机变量(host_vars)指定各个文件节点的配置。</block>
  <block id="021fa309ed559d86433974a82c934acb" category="doc">配置单个文件节点</block>
  <block id="882d9f125986842da2dd0a55dab49692" category="paragraph">本节将逐步介绍填充<block ref="6ec1b7d2e07359817e585e3cab8e078f" prefix=" " category="inline-code"></block> 集群中每个文件节点的文件。这些文件只能包含特定文件节点独有的配置。这通常包括：</block>
  <block id="3a67b6422642abadfa758fc6684f8438" category="list-text">定义Ansible连接到节点时应使用的IP或主机名。</block>
  <block id="fc0fd95b8cee27585e1c24e4d4a97663" category="list-text">配置用于HA集群服务(Pacemaker和Corosync)的其他接口和集群IP、以便与其他文件节点进行通信。默认情况下、这些服务与管理接口使用相同的网络、但应提供更多接口以实现冗余。通常的做法是、在存储网络上定义其他IP、从而避免需要额外的集群或管理网络。</block>
  <block id="a557d06b3a2f8ed98f967366125754a4" category="list-text">配置用于通过所需协议连接到块节点的接口(例如：iSCSI/iSER、NVMe/IB、NVMe/RoCE、FCP等)</block>
  <block id="3990d1c8eb99844fa4339dea97a4f692" category="inline-link-macro">规划文件系统</block>
  <block id="625cd1f9698fddb4256f18db4fbe2c9f" category="list-text">在顶部、指定Ansible通过SSH连接到节点并对其进行管理时应使用的IP或主机名：</block>
  <block id="2c411df90af25473ca34f96c5d61fdbd" category="list-text">配置可用于集群流量的其他IP：</block>
  <block id="13252baac98263adb995638740670156" category="inline-link-macro">InfiniBand (使用IPoIB)</block>
  <block id="4ec9f0d4c55bed99ab83189074c79fda" category="list-text">网络类型为 <block ref="ce64f086b1422863947177e8ac3c3f3f" category="inline-link-macro-rx"></block>：</block>
  <block id="703a1e1ae0933c0197e1615ce5751d82" category="inline-link-macro">基于融合以太网的RDMA (RoCE)</block>
  <block id="e8f5d6c59a43e4d1004ee930d690ba27" category="list-text">网络类型为 <block ref="513b838786f4a360fbbf4a58f2a48329" category="inline-link-macro-rx"></block>：</block>
  <block id="1e6c082cb30ec9603b75d0e43e10ed58" category="inline-link-macro">以太网(仅限TCP、无RDMA)</block>
  <block id="022fdafc43fcb01f91b57ea09f74ecea" category="list-text">网络类型为 <block ref="0d1150d6d50cb438873f5f691ec395a3" category="inline-link-macro-rx"></block>：</block>
  <block id="caec0146669daf8b955fbc692dce520b" category="list-text">指示哪些IP应用于集群流量、优先IP列在上面：</block>
  <block id="8ab316490a957aa5fb5fe572defa9604" category="admonition">步骤2中配置的IP不会用作集群IP、除非它们包含在中<block ref="736da50e459ba4f3c37629db79164765" prefix=" " category="inline-code"></block> 列表这样、您就可以使用Ansible配置其他IP /接口、如果需要、这些IP /接口可用于其他目的。</block>
  <block id="fe608507c9e692b58aed73b8f11125e4" category="list-text">如果文件节点需要通过基于IP的协议与块节点进行通信、则需要在相应的接口上配置IP、并安装/配置该协议所需的任何软件包。</block>
  <block id="e4e1c13bb0b14f6cb7608cbecea948ef" category="inline-link-macro">iSCSI</block>
  <block id="e38ebb7478bbd7c30fcefbdd68c36a12" category="list-text">如果使用 <block ref="c46eb98747333d3b3d4803c99165252d" category="inline-link-macro-rx"></block>：</block>
  <block id="04363472361fdfa664dfcfdfa289d7f8" category="inline-link-macro">iSER</block>
  <block id="25d076d8b955ae9a10c335a6a41c5dac" category="list-text">如果使用 <block ref="fa0a3baed35abd76cdb7d05d37537402" category="inline-link-macro-rx"></block>：</block>
  <block id="10c103240eb7689c62b54e419902d174" category="inline-link-macro">NVMe/IB</block>
  <block id="17e6fab71004356520b6a05746233689" category="list-text">如果使用 <block ref="cb33aa2303f4543f0ddc6cc084dc11e2" category="inline-link-macro-rx"></block>：</block>
  <block id="bb0b9e255a3bf215a4f994ef912a5fd7" category="inline-link-macro">NVMe/RoCE</block>
  <block id="7b049824318ebce7d5761f9928468034" category="list-text">如果使用 <block ref="dcd6a35349a26dd7f2ff0413151122c4" category="inline-link-macro-rx"></block>：</block>
  <block id="7de7f0266a638e2b92287e19c3daa0c0" category="list-text">其他协议：</block>
  <block id="26bcb9f1cb6f391f4b2c18e676bb458d" category="inline-link-macro">NVMe/FC</block>
  <block id="22c518d1512a40bae5f92e178ec69be7" category="list-text">如果使用 <block ref="20d003b59b6b0f29fbb82550734ddf9c" category="inline-link-macro-rx"></block>、不需要配置各个接口。BeeGFS集群部署将根据需要自动检测协议和安装/配置要求。如果您使用网络结构连接文件和块节点、请确保按照NetApp和交换机供应商的最佳实践正确对交换机进行分区。</block>
  <block id="cfaa375bf6c7f9fcc1bc04d4f30c9154" category="inline-link-macro">NetApp</block>
  <block id="59153461462a6c82d6207480cde38687" category="list-text">使用FCP或SAS不需要安装或配置其他软件。如果使用FCP、请确保交换机已正确分区、如下所示 <block ref="6839ca80f3cddcad48af8ac7c3fe1eba" category="inline-link-macro-rx"></block> 以及交换机供应商的最佳实践。</block>
  <block id="31887cc493f03e51b901bf0def837d66" category="list-text">目前不建议使用IB SRP。根据E系列块节点支持的内容、使用NVMe/IB或iSER。</block>
  <block id="6c92285fa6d3e827b198d120ea3ac674" category="inline-link-macro">此处</block>
  <block id="02613a7c8b7a72805b5196cbf7ed0def" category="paragraph">单击 <block ref="6ff86e054594e10fe2118d48eb3fbd14" category="inline-link-macro-rx"></block> 有关表示单个文件节点的完整清单文件的示例。</block>
  <block id="310ccb00662c7e9dcc32789c0d9b1b7a" category="section-title">高级：在以太网模式和InfiniBand模式之间切换NVIDIA ConnectX VPI适配器</block>
  <block id="2b4c9bc157bda4a68fe7b673b411f9cd" category="paragraph">例如、要将InfiniBand模式下的接口电流更改为以太网、以便用于RoCE：</block>
  <block id="f352db79870cb8a06a0551761aba6955" category="list-text">对于要配置的每个接口、请指定<block ref="366fe119442ebda85ac564541700d0b5" prefix=" " category="inline-code"></block> 作为指定的映射(或词典)<block ref="ced82128b540acaf7a5a55ad007dc9fc" prefix=" " category="inline-code"></block> 其中：<block ref="ecb5fc74e9cd1f249d43a2bdbf2f239d" prefix=" " category="inline-code"></block> 由接口的HCA端口号决定。。<block ref="ecb5fc74e9cd1f249d43a2bdbf2f239d" prefix=" " category="inline-code"></block> 可以通过运行来确定值<block ref="2ea620f2a9b9bed90c46047fef7e151b" prefix=" " category="inline-code"></block> 并从PCI插槽名称中将1添加到最后一个数字、然后转换为十进制值。</block>
  <block id="070b28e93cab063481c989d1404f9835" category="list-text">例如给定<block ref="92c00058a177a7a840386578304e1345" prefix=" " category="inline-code"></block> (2 + 1 -&gt; HCA端口3)-&gt;<block ref="f5e96e67a1ff914902859c7140e258c6" prefix=" " category="inline-code"></block>：</block>
  <block id="5656da44562ac70934e97182890aa356" category="inline-link-macro">NetApp E系列主机集合的文档</block>
  <block id="62a3f60b673661ad66352505cb4f5f47" category="paragraph">有关更多详细信息、请参见 <block ref="9ec6c7f8da9119d3e119ae207cfbe732" category="inline-link-macro-rx"></block> 所使用的接口类型/协议。</block>
  <block id="7b56de51b6636ae6d5c0129d3aa799db" category="summary">使用组变量(group_vars)指定通用文件节点配置。</block>
  <block id="db3a70a0b14fbd38f2ad1025900202fe" category="paragraph">应连接到所有文件节点的配置在中进行定义<block ref="4003590e6e5408f8e5272e50f909dfac" prefix=" " category="inline-code"></block>。通常包括：</block>
  <block id="8a78a1a399a517e776a6453f500e5c3c" category="list-text">有关如何连接和登录到每个文件节点的详细信息。</block>
  <block id="d749e2ca3efe2efbf2d8495c53fa6cb8" category="list-text">通用网络配置。</block>
  <block id="01166eafe622404b58002e5aa76ca528" category="list-text">是否允许自动重新启动。</block>
  <block id="109b40c80787d84c2b222ada208f2967" category="list-text">应如何配置防火墙和SELinux状态。</block>
  <block id="cd29db396a81799f9eb0187ecae937b1" category="list-text">集群配置、包括警报和隔离。</block>
  <block id="8b4f60df6198db9d4eb1c6bbb19def6d" category="list-text">性能调整。</block>
  <block id="8ae73df7c749e2eb45a156f0c39fcc04" category="list-text">常见BeeGFS服务配置。</block>
  <block id="787446c6f7e5e0f4a50705b5035eba79" category="admonition">此外、还可以在各个文件节点上定义此文件中设置的选项、例如、如果使用的是混合硬件型号、或者每个节点的密码不同。单个文件节点上的配置将优先于此文件中的配置。</block>
  <block id="0971602076ba9dff100f7cfc2d9e6059" category="paragraph">创建文件<block ref="4003590e6e5408f8e5272e50f909dfac" prefix=" " category="inline-code"></block> 并按如下所示进行填充：</block>
  <block id="84531cf8a820148a6599e174baf94979" category="list-text">指示Ansible Control节点应如何向远程主机进行身份验证：</block>
  <block id="2d33afd54604fb6475c44a1bc47fe2b1" category="admonition">尤其是在生产环境中、不要以纯文本格式存储密码。请改用Ansible Vault (请参见 <block ref="37147a1e5d41497ae56472e8a2868a2a" category="inline-link-macro-rx"></block>)或<block ref="13d87b4892426ec19bdc58a4643d3104" prefix=" " category="inline-code"></block> 运行攻略手册时的选项。如果<block ref="f2bf771afbc16045e1951ded58c56f98" prefix=" " category="inline-code"></block> 已为root用户、则可以选择省略<block ref="424240cd4e5c359372b7f199431603d5" prefix=" " category="inline-code"></block>。</block>
  <block id="0a94da3169c04bc12f2c561654269433" category="list-text">如果要在以太网或InfiniBand接口上配置静态IP (例如集群IP)、并且多个接口位于同一IP子网中(例如、ib0使用192.168.1.10/24、ib1使用192.168.1.11/24)、要使多主机支持正常工作、必须设置其他IP路由表和规则。只需按如下所示启用提供的网络接口配置挂钩：</block>
  <block id="502d35f94d5c17779c9050bbed75f65f" category="list-text">部署集群时、根据存储协议的不同、可能需要重新启动节点、以便于发现远程块设备(E系列卷)或应用配置的其他方面。默认情况下、节点将在重新启动之前进行提示、但您可以通过指定以下内容来允许节点自动重新启动：</block>
  <block id="ff31dc05d095d346c18f3e8f2d758fe0" category="list-text">默认情况下、重新启动后、为确保块设备和其他服务准备就绪、Ansible将等待系统完成<block ref="dbd7cb25a43d1cd2bbc3bac871dad694" prefix=" " category="inline-code"></block> 将在继续部署之前访问。在某些使用NVMe/IB的情况下、此过程可能不够长、无法初始化、发现和连接到远程设备。这可能会导致自动部署过早继续并失败。为避免在使用NVMe/IB时出现这种情况、还应定义以下内容：</block>
  <block id="c41782825542f82199bd141519f37211" category="list-text">要使BeeGFS和HA集群服务进行通信、需要使用多个防火墙端口。除非您要手动配置固件(不建议)、否则请指定以下内容以创建所需的防火墙区域并自动打开端口：</block>
  <block id="2514951e199c5ba1bae751dec2faccfa" category="list-text">目前不支持SELinux、建议将状态设置为disabled以避免冲突(尤其是在使用RDMA时)。设置以下内容以确保SELinux已禁用：</block>
  <block id="97a322f05bd6e92c24c84cd8a09de904" category="list-text">配置身份验证以使文件节点能够进行通信、并根据组织策略根据需要调整默认值：</block>
  <block id="d6521cd21608c38eda94ff4b2607ebac" category="list-text">根据需要启用电子邮件警报：</block>
  <block id="369512731d385e76ab6ae5702e43d88e" category="list-text">强烈建议启用隔离、否则、在主节点发生故障时、可能会阻止服务在二级节点上启动。</block>
  <block id="679f9b26ee84fb8a265eb6a80d1141b0" category="list-text">通过指定以下内容全局启用隔离：</block>
  <block id="2b86513417433b960c2a9628820cce70" category="inline-link-macro">集群属性</block>
  <block id="a4a918a45181164207929d52aec36aec" category="inline-link-macro">默认值</block>
  <block id="8cb3e998c7b1e4cbe36289f2177363b5" category="list-text">接下来、选择并配置隔离代理：</block>
  <block id="bc6b3ed04c45895c341d99b6765c1caa" category="list-text">选项1：要使用APC配电单元(PDU)启用隔离、请执行以下操作：</block>
  <block id="94ebb967d1a890978b9758e3f2aac3bb" category="list-text">选项2：要使用联想XCC (及其他BMC)提供的Redffish API启用隔离：</block>
  <block id="7f2e85da597afbbb84c30c58c72fc4a2" category="inline-link-macro">RedHat文档</block>
  <block id="1242eea64a7ebfd7464359e597a4ec62" category="inline-link-macro">性能调整参数</block>
  <block id="e535abe8b416a666cd34177ff6bbe395" category="list-text">为了确保用于BeeGFS服务的浮动IP地址(有时称为逻辑接口)可以在文件节点之间进行故障转移、所有网络接口的名称必须一致。默认情况下、网络接口名称由内核生成、即使在安装了相同PCIe插槽中的网络适配器的相同服务器型号上、也不能保证生成一致的名称。在部署设备之前创建清单并知道生成的接口名称时、这一点也很有用。以确保设备名称一致、具体取决于服务器或的方框图<block ref="6efa276570b668a53eaf7bf29c69d544" prefix=" " category="inline-code"></block> 输出中、按如下所示指定所需的PCIe地址到逻辑接口映射：</block>
  <block id="b577b9bc7da15f148c6521018b1c26f7" category="list-text">对于InfiniBand (IPoIB)网络接口：</block>
  <block id="10b951f140b750e6d3b9a61a2aa51fc1" category="list-text">对于以太网网络接口：</block>
  <block id="e71729643558be7be36227d3edb537a5" category="admonition">为避免重命名接口时发生冲突(防止重命名接口)、不应使用任何可能的默认名称、例如eth0、ens9f0、ib0或ibs4f0。一种常见的命名约定是、对以太网或InfiniBand使用"e"或"i"、后跟PCIe插槽编号和一个字母以指示端口。例如、插槽3中安装的InfiniBand适配器的第二个端口为：i3b。</block>
  <block id="62e75ccd7f725aa6905f33580950953f" category="admonition">如果您使用的是经验证的文件节点型号、请单击 <block ref="3d76a23cff20eb55b7795ee99a64cc43" category="inline-link-macro-rx"></block> PCIe地址到逻辑端口映射示例。</block>
  <block id="1644ff30bfdd323dac0e52e1620614b2" category="list-text">BeeGFS管理服务：</block>
  <block id="c9c23b537bdcdcf7e82ad149d3e28ab1" category="list-text">BeeGFS元数据服务：</block>
  <block id="b292484ec320b2afcb3a63fdbff30bd3" category="list-text">BeeGFS存储服务：</block>
  <block id="69e81fdce48c1bfa30329304eaa6d50d" category="inline-link-macro">连接身份验证</block>
  <block id="d636cd57abce18fc564705e1931029aa" category="list-text">截至BeeGFS 7.2.7和7.3.1 <block ref="770c4b58b3b364c4ac52cf5cc555453f" category="inline-link-macro-rx"></block> 必须配置或显式禁用。使用基于Ansible的部署可以通过以下几种方式进行配置：</block>
  <block id="2beb66fd9b0c065cfc742ee53ee1055d" category="list-text">默认情况下、部署将自动配置连接身份验证并生成<block ref="cd304377fdc20285a5aa94e55ae85aa7" prefix=" " category="inline-code"></block> 该文件将分发到所有文件节点、并与BeeGFS服务结合使用。此文件还将放置/维护在位于的Ansible控制节点上<block ref="eee2923df30539b680421ca53d7c066b" prefix=" " category="inline-code"></block> 应(安全)维护的位置、以便在需要访问此文件系统的客户端中重复使用。</block>
  <block id="a6eacd255bbcfb7c0ed5589f3f4b3b80" category="list-text">要生成新密钥、请指定<block ref="34efb4240137e7a93d7ad83bde309514" prefix=" " category="inline-code"></block> 运行Ansible攻略手册时。请注意、如果出现、则会忽略此问题<block ref="8b76cf2fb65e09dad03ca686be5cd464" prefix=" " category="inline-code"></block> 已定义。</block>
  <block id="4d93b986f0992f2770f494a3ced4bd11" category="inline-link-macro">BeeGFS HA角色</block>
  <block id="ca03fa9d55c2bc9aa4bb21f10949f48a" category="list-text">可以通过在中定义以下内容来使用自定义密钥<block ref="3cd295e6aaa39e2510aff65b801cc5ab" prefix=" " category="inline-code"></block>：</block>
  <block id="00d80f50123e52756def9093de1ba2aa" category="list-text">可以完全禁用连接身份验证(不建议使用)：</block>
  <block id="b8a5eb74062e4ce8ebe0914712be3ae2" category="paragraph">单击 <block ref="632283d8f4d8d92337070d81c0b8ed5f" category="inline-link-macro-rx"></block> 有关表示通用文件节点配置的完整清单文件的示例。</block>
  <block id="74acf7796c51f1f58661f8cf66f5b969" category="section-title">将HDR (200 GB) InfiniBand与NetApp EF600块节点结合使用：</block>
  <block id="9e152ebb462ebe95f96d2711a934ec01" category="paragraph">要将HDR (200 GB) InfiniBand与EF600结合使用、子网管理器必须支持虚拟化。如果使用交换机连接文件和块节点、则需要在子网管理器管理器上为整个网络结构启用此功能。</block>
  <block id="11f007a0a372dd0901653de91029d3d8" category="inline-link-macro">配置文件节点存储接口</block>
  <block id="b13b4c123d075f5df5e6f618489fde5f" category="inline-link-macro">技术要求</block>
  <block id="df1f716d0a26eb697eb7605722643850" category="list-text">下<block ref="4003590e6e5408f8e5272e50f909dfac" prefix=" " category="inline-code"></block> 定义以下配置：</block>
  <block id="c25698c0b0a8b21ec89a22a39d05b4e4" category="summary">使用主机变量(host_vars)指定各个块节点的配置。</block>
  <block id="007670379f88b0b437948cd7ffd18854" category="doc">配置单个块节点</block>
  <block id="c04b45b2e867c15ec034a753c3caad42" category="paragraph">本节将逐步介绍填充<block ref="e401274046660da23cecf42c63b0dc71" prefix=" " category="inline-code"></block> 集群中每个块节点的文件。这些文件只能包含特定块节点特有的配置。这通常包括：</block>
  <block id="718e1c8b260f855e4dfed258432c772c" category="list-text">系统名称(如System Manager中所示)。</block>
  <block id="d6535083366c5efbc468368177b26a11" category="list-text">其中一个控制器的HTTPS URL (用于使用其REST API管理系统)。</block>
  <block id="d34a9e5f2aea0e08afe426c3db560f6f" category="list-text">用于连接到此块节点的存储协议文件节点。</block>
  <block id="ac7d8826ccdecec74ae70f73a19ab9d6" category="list-text">配置主机接口卡(HIC)端口、例如IP地址(如果需要)。</block>
  <block id="80eb8027c5428b5220f76ca5617cdbef" category="list-text">在顶部指定其中一个控制器的系统名称和HTTPS URL：</block>
  <block id="81788ba0d7d02d81c063dbca621ba11b" category="inline-link-macro">协议</block>
  <block id="d1ac4a3f6cf15e4c501caf76560363b8" category="list-text">选择 <block ref="42254e7bd4c71b16c1c0d21e675ced23" category="inline-link-macro-rx"></block> 文件节点将用于连接到此块节点：</block>
  <block id="c2e9d327966d74c358df1c68e849c85b" category="list-text">支持的协议：<block ref="9df22f196a33acd0b372fe502de51211" prefix=" " category="inline-code"></block>，<block ref="39eea648dab96b0ee6022dabb38bc420" prefix=" " category="inline-code"></block>，<block ref="e05fe30750d3ea262a610d17ebc07019" prefix=" " category="inline-code"></block>，<block ref="a8a64cef262a04de4872b68b63ab7cd8" prefix=" " category="inline-code"></block>，<block ref="7aee267b2c70d17165e6fa56dc01795a" prefix=" " category="inline-code"></block>，<block ref="11104f7e32c1e7884522b538834ffd9a" prefix=" " category="inline-code"></block>，<block ref="0ab2fb14820281e536188e7478368635" prefix=" " category="inline-code"></block>，<block ref="99e6ba7d601220dd39e915ce4c6ff74c" prefix=" " category="inline-code"></block>，<block ref="384fddfa43cdca25e66ad1b9a278e6c7" prefix=" " category="inline-code"></block>。</block>
  <block id="0c5c276a533c6231e1004931dde34c40" category="list-text">根据所使用的协议、HIC端口可能需要额外配置。如果需要、应定义HIC端口配置、以便每个控制器配置中的顶部条目与每个控制器上最左侧的物理端口相对应、底部端口对应最右侧的端口。所有端口都需要有效配置、即使它们当前未在使用中也是如此。</block>
  <block id="95e06a898133e12b42adf8c80aafb2f7" category="admonition">如果要将HDR (200 GB) InfiniBand或200 GB RoCE与EF600块节点结合使用、另请参见以下部分。</block>
  <block id="2a6f3123e92916a549d4843b0432ee15" category="list-text">对于iSCSI：</block>
  <block id="b405e253b7123d507b950877cb495779" category="list-text">对于iSER：</block>
  <block id="3becb61841658038a043e3eca2dc705e" category="list-text">对于NVMe/IB：</block>
  <block id="5f42fe6193c58ec9a447a090be2e17b8" category="list-text">对于NVMe/RoCE：</block>
  <block id="4b9c9e1cc0a87604a342176becdb9d29" category="list-text">FC和SAS协议不需要额外配置。不正确建议使用SRP。</block>
  <block id="55876228853abf632dec9346a4f372ec" category="inline-link-macro">文档。</block>
  <block id="d487c72028a8f41291fa35df82cfe348" category="paragraph">有关配置HIC端口和主机协议的其他选项、包括配置iSCSI CHAP的功能、请参见 <block ref="03b4e8c5a2a4120cb0ea20ad53010d79" category="inline-link-macro-rx"></block> 包含在SANtricity 集合中。注意在部署BeeGFS时、存储池、卷配置以及配置存储的其他方面将在其他位置进行配置、不应在此文件中定义。</block>
  <block id="ca752ddde33be986f431e89edb589ac1" category="paragraph">单击 <block ref="4b43b7669fad4b5b712c0fa73fdf7e2c" category="inline-link-macro-rx"></block> 表示单个块节点的完整清单文件示例。</block>
  <block id="bb3b75abe4dc6581c40f5061474bb17f" category="section-title">将HDR (200 GB) InfiniBand或200 GB RoCE与NetApp EF600块节点结合使用：</block>
  <block id="2636cdb2e4c8c163e637fb4b1be7ef57" category="summary">使用组变量(group_vars)指定通用块节点配置。</block>
  <block id="42379f3693325579ec45c17436f3fa30" category="doc">指定通用块节点配置</block>
  <block id="f3b82d936104a57a294cfa3abe47b556" category="paragraph">应通过定义适用于所有块节点的配置<block ref="7bc866ffde9914c7ef21768fcf6f0683" prefix=" " category="inline-code"></block>。通常包括：</block>
  <block id="8265488ffd9c98f3bf95687c608f6db9" category="list-text">有关Ansible控制节点应如何连接到用作块节点的E系列存储系统的详细信息。</block>
  <block id="e6a6b0e56e4888732076684459908257" category="list-text">节点应运行的固件、NVSRAM和驱动器固件版本。</block>
  <block id="432cd2d056edf811cddfd42fe9367df2" category="list-text">全局配置、包括缓存设置、主机配置以及应如何配置卷的设置。</block>
  <block id="b34cde4ef9da9f08725d6c62977d706a" category="admonition">此外、还可以在各个块节点上定义此文件中设置的选项、例如、如果使用的是混合硬件型号、或者每个节点的密码不同。单个块节点上的配置将优先于此文件中的配置。</block>
  <block id="6afa815954c372aee339049211ead69a" category="paragraph">创建文件<block ref="7bc866ffde9914c7ef21768fcf6f0683" prefix=" " category="inline-code"></block> 并按如下所示进行填充：</block>
  <block id="35604a35256cdb2079414a606f693bc3" category="list-text">Ansible不使用SSH连接到块节点、而是使用REST API。为此、我们必须设置：</block>
  <block id="c4cb5f6ece988910c4cb1a90025fb6fd" category="list-text">指定用于管理每个节点的用户名和密码。用户名可以选择省略(并默认为admin)、否则您可以指定具有管理员权限的任何帐户。此外、还应指定是验证SSL证书还是忽略SSL证书：</block>
  <block id="4b47eaf1cc2e42fd7841edf5ee136cf9" category="admonition">不建议以纯文本格式列出任何密码。使用Ansible存储或提供<block ref="b59049923d63016545b743560345fa56" prefix=" " category="inline-code"></block> 使用-extra vars运行Ansible时。</block>
  <block id="7a48384bf61ccc1cd67f79e20b2946b0" category="list-text">也可以指定应在节点上安装的控制器固件、NVSRAM和驱动器固件。需要将这些文件下载到<block ref="93501a11e921083efbd154e0cdff5f10" prefix=" " category="inline-code"></block> 目录、然后运行Ansible。可以下载E系列控制器固件和NVSRAM <block ref="66d434b6c80c5839cd158404e9040bf6" category="inline-link-macro-rx"></block> 和驱动器固件 <block ref="289e1473afcefdacfca9006e22cec3f7" category="inline-link-macro-rx"></block>：</block>
  <block id="9f068c46b4a825d808c2c9767e358bf4" category="admonition">如果指定了此配置、Ansible将自动更新所有固件、包括重新启动控制器(如有必要)、而不会出现其他提示。这对BeeGFS/主机I/O预期不会造成中断、但发生原因 性能可能会暂时下降。</block>
  <block id="e34a3cd38452267edb183f6fec7d3128" category="list-text">调整全局系统配置默认值。此处列出的选项和值通常建议用于NetApp上的BeeGFS、但可以根据需要进行调整：</block>
  <block id="959afa15d8283f663da6fb31c0931335" category="list-text">配置全局卷配置默认值。此处列出的选项和值通常建议用于NetApp上的BeeGFS、但可以根据需要进行调整：</block>
  <block id="36aa3776a01484babb7b935f0790e38d" category="list-text">如果需要、请根据以下最佳实践调整Ansible为存储池和卷组选择驱动器的顺序：</block>
  <block id="9ddcb68f677516aceffc3293429a25e8" category="list-text">列出应首先用于管理和/或元数据卷、最后用于存储卷的任何(可能较小)驱动器。</block>
  <block id="6857ed48db753853948c52afd2297877" category="list-text">确保根据磁盘架/驱动器机箱型号在可用驱动器通道之间平衡驱动器选择顺序。例如、如果使用EF600且不进行扩展、则驱动器0-11位于驱动器通道1上、驱动器12-23位于驱动器通道上。因此、要选择一种平衡驱动器选择的策略<block ref="22527cd74d7cc7f48375817974dc1712" prefix=" " category="inline-code"></block> 99：0、99：23、99：1、99：22等如果存在多个机箱、则第一个数字表示驱动器架ID。</block>
  <block id="1f28da07b9b1480e254e0e0fe280f3a2" category="paragraph">单击 <block ref="85c5b5287ec04e7c836b5655b59fd26c" category="inline-link-macro-rx"></block> 有关表示通用块节点配置的完整清单文件的示例。</block>
  <block id="e20d89701cb46cf38953e6dc25a2dc3d" category="summary">使用inventory.yml文件指定哪些文件节点可以运行每个BeeGFS服务。</block>
  <block id="02e4c76e0e6e5414c70765451a79b37c" category="doc">将BeeGFS服务映射到文件节点</block>
  <block id="3e99717578ba1478873bc5c3269e4086" category="paragraph">使用指定可以运行每个BeeGFS服务的文件节点<block ref="d28e452e49fc926f32af1d87afcff3ce" prefix=" " category="inline-code"></block> 文件</block>
  <block id="24c07a5a77746e85d21882c88bdd5b03" category="paragraph">本节将介绍如何创建<block ref="d28e452e49fc926f32af1d87afcff3ce" prefix=" " category="inline-code"></block> 文件其中包括列出所有块节点并指定可以运行每个BeeGFS服务的文件节点。</block>
  <block id="5ee7bf1a42518812c2b87b463bf96a31" category="paragraph">创建文件<block ref="d28e452e49fc926f32af1d87afcff3ce" prefix=" " category="inline-code"></block> 并按如下所示进行填充：</block>
  <block id="7aec62cda467a76d024911e74e1fec38" category="list-text">从文件顶部、创建标准Ansible清单结构：</block>
  <block id="5923f18af043b9957bf5541e595cc0f5" category="list-text">创建一个包含参与此HA集群的所有块节点的组：</block>
  <block id="b084d86d2b539345bcda62aaa5bceb0f" category="list-text">创建一个组、其中包含集群中的所有BeeGFS服务以及要运行这些服务的文件节点：</block>
  <block id="eec391bff48a7ed3bbf30e3280fbe9e3" category="list-text">对于集群中的每个BeeGFS服务、定义应运行该服务的首选文件节点和任何二级文件节点：</block>
  <block id="e26a68a8ce5809998083f351bf56677e" category="paragraph">单击 <block ref="00544a89e642f3f5a354362c58d52f2e" category="inline-link-macro-rx"></block> 有关完整清单文件的示例。</block>
  <block id="9df40d55a663f7c179e328bf937587fe" category="summary">BeeGFS服务使用组变量(group_vars)进行配置。</block>
  <block id="29ee3861e1e5ac6fa4281c3c3fddd958" category="doc">定义BeeGFS元数据服务</block>
  <block id="60513084f53d0d484c55e212d6a9248e" category="paragraph">本节将介绍如何定义BeeGFS元数据服务。对于特定文件系统、HA集群中应至少存在一个此类型的服务。配置此服务包括定义：</block>
  <block id="ef1af77af85196869032232af1a07f87" category="list-text">服务类型(元数据)。</block>
  <block id="164d597920f7afac5bd1bc14b783ff41" category="list-text">定义应仅适用于此BeeGFS服务的任何配置。</block>
  <block id="9e4755a30f0ec19b232cf1ce068ab8d4" category="list-text">配置可访问此服务的一个或多个浮动IP (逻辑接口)。</block>
  <block id="fc266b5cc64e2d259e49bb24b0c186d0" category="list-text">指定卷存储此服务数据的位置/方式(BeeGFS元数据目标)。</block>
  <block id="9cef1e732270bc660ef17d29df58c49c" category="list-text">指示此文件表示BeeGFS元数据服务的配置：</block>
  <block id="d1bbe7b3631d4fdecc7637f7f28f2cd9" category="list-text">定义应仅应用于此BeeGFS服务的任何配置。您必须至少指定所需的TCP和UDP端口、无论这些端口来自哪个受支持的配置参数<block ref="672e512128cc9536bcf9f16964b20c49" prefix=" " category="inline-code"></block> 也可以包括在内。请注意、以下参数是自动/在其他位置配置的、不应在此处指定：<block ref="6ea5464abdaaa0243bf0db8481a9a52b" prefix=" " category="inline-code"></block>，<block ref="dbca95678907e2f2bf827d44042c16c5" prefix=" " category="inline-code"></block>，<block ref="6097b6e95af2579f2147a330c21f7b59" prefix=" " category="inline-code"></block>，<block ref="1c285a92de2348d33dd1fc333fb66c45" prefix=" " category="inline-code"></block>，<block ref="7f8e8358da4bb8d8e7f6f717ad9eb0e9" prefix=" " category="inline-code"></block>，和<block ref="b61a9cecccc8e8db252dd5200883c7cc" prefix=" " category="inline-code"></block>。</block>
  <block id="71529044e633eb2a4b25c87eb3ea0358" category="list-text">配置一个或多个浮动IP、供其他服务和客户端连接到此服务时使用(此操作将自动设置BeeGFS<block ref="7f8e8358da4bb8d8e7f6f717ad9eb0e9" prefix=" " category="inline-code"></block> 选项)：</block>
  <block id="db6bbb0bcb13fc624704b26d5d879534" category="list-text">或者、指定一个或多个允许用于传出通信的IP子网(此操作将自动设置BeeGFS<block ref="b61a9cecccc8e8db252dd5200883c7cc" prefix=" " category="inline-code"></block> 选项)：</block>
  <block id="d3de182528701519a47cbe276590393a" category="list-text">根据以下准则指定此服务将在其中存储数据的BeeGFS元数据目标(此操作也会自动配置)<block ref="dbca95678907e2f2bf827d44042c16c5" prefix=" " category="inline-code"></block> 选项)：</block>
  <block id="e0f52cfdc30da3e272257c8783119a56" category="list-text">同一存储池或卷组名称可用于多个BeeGFS服务/目标、只需确保使用相同的即可<block ref="b068931cc450442b63f5b3d276ea4297" prefix=" " category="inline-code"></block>，<block ref="2d0e37110968341728e47095df64a19c" prefix=" " category="inline-code"></block>，<block ref="48658e2ad8eaaf7daff452601ea618db" prefix=" " category="inline-code"></block>，和<block ref="e241a8daa5b8e1af3b82b1e1a8ec24a9" prefix=" " category="inline-code"></block> 每个服务的配置(为每个服务列出的卷应不同)。</block>
  <block id="339c4b049c3a7e5cdf355daceda6f43a" category="list-text">单击 <block ref="0a71609ed00bd9652e70cd5b106f9ae3" category="inline-link-macro-rx"></block> 以获取可用于的配置选项的完整列表<block ref="8ca968d07b3817015da8919c700152f5" prefix=" " category="inline-code"></block>。请注意一些选项、例如<block ref="9ed39e2ea931586b6a985a6942ef573e" prefix=" " category="inline-code"></block>，<block ref="67b3dba8bc6778101892eb77249db32e" prefix=" " category="inline-code"></block>，<block ref="99bd6603c88a46584bf9b94ffab3d6c9" prefix=" " category="inline-code"></block>，<block ref="db137bf87e9c1a766b82885236ac8b87" prefix=" " category="inline-code"></block>，和<block ref="7951c85f8306dda4792beb0e6a356282" prefix=" " category="inline-code"></block> 和卷名称将自动生成、不应在此指定。</block>
  <block id="df5fc0ef6e9aaec0f45d18fdd7ee8f12" category="paragraph">单击 <block ref="c59646481b474fffe5bc2a736ab8653d" category="inline-link-macro-rx"></block> 有关表示BeeGFS元数据服务的完整清单文件的示例。</block>
  <block id="0badcf73673abd8a3f15cc4e386caafa" category="doc">定义BeeGFS存储服务</block>
  <block id="624bf455f36c44a126036391cd39a75c" category="paragraph">本节将介绍如何定义BeeGFS存储服务。对于特定文件系统、HA集群中应至少存在一个此类型的服务。配置此服务包括定义：</block>
  <block id="e03fff2a92d72a09b4f9f5d0e895d1fd" category="list-text">服务类型(存储)。</block>
  <block id="e5e9883649f056a718503df3542a70d4" category="list-text">指定卷存储此服务数据的位置/方式(BeeGFS存储目标)。</block>
  <block id="204caa9915a25307074d637daed7faba" category="list-text">指示此文件表示BeeGFS存储服务的配置：</block>
  <block id="d03efed3ebed6860068fb8a5123ef4c6" category="list-text">定义应仅应用于此BeeGFS服务的任何配置。您必须至少指定所需的TCP和UDP端口、无论这些端口来自哪个受支持的配置参数<block ref="8a87bdd1964512794d560f1af3699fa1" prefix=" " category="inline-code"></block> 也可以包括在内。请注意、以下参数是自动/在其他位置配置的、不应在此处指定：<block ref="6ea5464abdaaa0243bf0db8481a9a52b" prefix=" " category="inline-code"></block>，<block ref="facec0675a87a8e14bef255e83e40f1e" prefix=" " category="inline-code"></block>，<block ref="6097b6e95af2579f2147a330c21f7b59" prefix=" " category="inline-code"></block>，<block ref="1c285a92de2348d33dd1fc333fb66c45" prefix=" " category="inline-code"></block>，<block ref="7f8e8358da4bb8d8e7f6f717ad9eb0e9" prefix=" " category="inline-code"></block>，和<block ref="b61a9cecccc8e8db252dd5200883c7cc" prefix=" " category="inline-code"></block>。</block>
  <block id="b0e2ab52d86028182775498a8ba8dcc3" category="list-text">根据以下准则指定此服务要存储数据的BeeGFS存储目标(此操作也会自动配置)<block ref="facec0675a87a8e14bef255e83e40f1e" prefix=" " category="inline-code"></block> 选项)：</block>
  <block id="b18c6fe32d4f2f076f7c708ea5be89c1" category="paragraph">单击 <block ref="7bc3fba5853c696254cf4264774b5d50" category="inline-link-macro-rx"></block> 有关表示BeeGFS存储服务的完整清单文件的示例。</block>
  <block id="973cf6ca298b6ecfb5f2f3290ca4cd2f" category="doc">定义BeeGFS管理服务</block>
  <block id="a461b810f49c26d9dc6d92a1e3a344bc" category="paragraph">本节将介绍如何定义BeeGFS管理服务。对于特定文件系统、HA集群中只应存在一个此类型的服务。配置此服务包括定义：</block>
  <block id="a9da9d90de8c8b13991c884b03f76658" category="list-text">服务类型(管理)。</block>
  <block id="b966cc65076783762d4b37aff48e5a1f" category="list-text">指定卷存储此服务数据的位置/方式(BeeGFS管理目标)。</block>
  <block id="66969fa0d9af9f38ebaa31ea1c4b7051" category="list-text">指示此文件表示BeeGFS管理服务的配置：</block>
  <block id="968fc19eb9be6283a0d5f79c8536f855" category="list-text">定义应仅应用于此BeeGFS服务的任何配置。管理服务通常不需要执行此操作、除非您需要启用配额、无论您的任何受支持的配置参数如何<block ref="025b9ec9690bfeefef6aedbac6e66c87" prefix=" " category="inline-code"></block> 可以包括在内。请注意、以下参数是自动/在其他位置配置的、不应在此处指定：<block ref="02a09b36e77ebbfe1d499e597daef0d5" prefix=" " category="inline-code"></block>，<block ref="6097b6e95af2579f2147a330c21f7b59" prefix=" " category="inline-code"></block>，<block ref="1c285a92de2348d33dd1fc333fb66c45" prefix=" " category="inline-code"></block>，<block ref="7f8e8358da4bb8d8e7f6f717ad9eb0e9" prefix=" " category="inline-code"></block>，和<block ref="b61a9cecccc8e8db252dd5200883c7cc" prefix=" " category="inline-code"></block>。</block>
  <block id="8e19ae7e081dee60d1c86f207028684b" category="list-text">根据以下准则指定此服务将在其中存储数据的BeeGFS管理目标：</block>
  <block id="1511cb861f1160e48d8e9c07e416cd1a" category="paragraph">单击 <block ref="ffb907e2c03168946e1e4d8df77e6e36" category="inline-link-macro-rx"></block> 有关表示BeeGFS管理服务的完整清单文件的示例。</block>
  <block id="234c05131256028f5ab7ea9b87261ff3" category="summary">Ansible清单是一组配置文件、用于定义所需的BeeGFS HA集群。</block>
  <block id="e520383c76f5e72226ebb572b987380c" category="doc">Ansible清单概述</block>
  <block id="7a1eabc3deb7fd02ceb1e16eafc41073" category="inline-link-macro">清单</block>
  <block id="283c77f47e33325beac16dfcff1fbdc4" category="inline-link-macro">子目录/文件</block>
  <block id="3a6e55a49a2cdf7c86076b810d565fc2" category="paragraph">建议遵循标准的Ansible实践来组织 <block ref="6c37acba8ff27fe32f3259d928e2df83" category="inline-link-macro-rx"></block>、包括使用 <block ref="0b746a370389b97701184b02d91b44b0" category="inline-link-macro-rx"></block> 而不是将整个清单存储在一个文件中。</block>
  <block id="21c8e198e85188d23c3e8ec1332bc84c" category="paragraph">单个BeeGFS HA集群的Ansible清单组织如下：</block>
  <block id="8c57469570cfaa1ea4910df225230163" category="admonition">由于一个BeeGFS文件系统可以跨越多个HA集群、因此大型安装可能具有多个Ansible清单。通常、不建议尝试将多个HA集群定义为一个Ansible清单以避免出现问题。</block>
  <block id="1b1ad4049313d49cd09961eea7b62a6f" category="list-text">在Ansible控制节点上、创建一个空目录、该目录将包含要部署的BeeGFS集群的Ansible清单。</block>
  <block id="697c53131c77d1cf7ff864d4f02aca2d" category="list-text">如果您的文件系统最终将包含/可能包含多个HA集群、建议先为文件系统创建一个目录、然后为表示每个HA集群的清单创建子目录。例如：</block>
  <block id="aa4b0754e84122851b5c983186feaa49" category="list-text">在包含要部署的HA集群清单的目录中、创建两个目录<block ref="96fa973cda8809ad84f646e3d8fbbc1c" prefix=" " category="inline-code"></block> 和<block ref="3342582e194d63e4c91b56623752c9c6" prefix=" " category="inline-code"></block> 和两个文件<block ref="d28e452e49fc926f32af1d87afcff3ce" prefix=" " category="inline-code"></block> 和<block ref="2f78c4e27feaf25ffb33d97e8ff7e7a6" prefix=" " category="inline-code"></block>。</block>
  <block id="20034aab6a0bc59dc9804ff9d5960982" category="paragraph">以下各节将逐步介绍如何定义每个文件的内容。</block>
  <block id="cd3a8919c565c37be6e50322a583eac4" category="summary">在构建Ansible清单之前规划文件系统部署。</block>
  <block id="6ec9184bd478b3b836d1c92fa51f1baa" category="paragraph">在部署文件系统之前、您应定义集群中运行的所有文件节点、块节点和BeeGFS服务需要哪些IP地址、端口和其他配置。虽然具体配置会因集群架构而异、但本节定义了一般适用的最佳实践和应遵循的步骤。</block>
  <block id="229ad1ff2fa862e1fa317520fe78ad42" category="list-text">如果您使用基于IP的存储协议(例如iSER、iSCSI、NVMe/IB或NVMe/RoCE)将文件节点连接到块节点、请为每个组件填写以下工作表。一个构建块中的每个直接连接都应具有一个唯一的子网、并且不应与用于客户端-服务器连接的子网重叠。</block>
  <block id="0611f793ccd40e910f3d7f82c1bb6d66" category="cell">虚拟IP (仅适用于具有HDR IB的EF600)</block>
  <block id="6d68d27a364d17c3c6b36281d161a34e" category="cell">&lt;HOSTNAME&gt;</block>
  <block id="2feb1f8d58fa960c8d2635cb910ad7ec" category="cell">&lt;PORT&gt;</block>
  <block id="a87d961719c43a8065ad6f09b292f547" category="cell">&lt;IP/SUBNET&gt;</block>
  <block id="5d52f332806d779c548497e97b6050ed" category="admonition">如果每个构建块中的文件和块节点直接连接、您通常可以对多个构建块重复使用相同的IP/方案。</block>
  <block id="0eca8abaad32a83698b54d0fcea93ad3" category="list-text">无论您是在存储网络中使用InfiniBand还是基于融合以太网的RDMA (RoCE)、请填写以下工作表以确定将用于HA集群服务、BeeGFS文件服务和客户端进行通信的IP范围：</block>
  <block id="0c2bd0118b2766abe77c40b1bd393b44" category="cell">BeeGFS集群IP</block>
  <block id="c4aa072ba75aa28cd14308257fee1a08" category="cell">&lt;INTERFACE(s)&gt;</block>
  <block id="65b5aefed3041b5dccc318ffe87431b7" category="cell">&lt;RANGE&gt;</block>
  <block id="1ec0a19ea7a783b022b53265dd90c383" category="cell">&lt;IP(s)&gt;</block>
  <block id="0353e2599d6ca03a78f42855abe0a6f4" category="list-text">如果您使用的是一个IP子网、则只需要一个工作表、否则还需要填写第二个子网的工作表。</block>
  <block id="c19e3d6f1cb2b9ed96d0553ef0363080" category="list-text">根据上述内容、为集群中的每个组件填写以下工作表、以定义要运行的BeeGFS服务。对于每个服务、请指定首选/二级文件节点、网络端口、浮动IP、NUMA分区分配(如果需要)以及要用于其目标的块节点。填写工作表时、请参见以下准则：</block>
  <block id="501d4d9b0f3910c0d30a4a828247f2b0" category="list-text">将BeeGFS服务指定为<block ref="5670713387ceeca6a99ea4c5d6381de9" prefix=" " category="inline-code"></block>，<block ref="adc521b987f8d17684929a7814fb39a6" prefix=" " category="inline-code"></block>或<block ref="13e9e938499f52dc5dd76a5f625aef19" prefix=" " category="inline-code"></block> 其中ID表示此文件系统中此类型的所有BeeGFS服务的唯一编号。此约定将简化在创建用于配置每个服务的文件时在后续章节中引用此工作表的过程。</block>
  <block id="d5164729d98e85db7b7cb0282c74163d" category="list-text">用于BeeGFS服务的端口只需在特定组件中是唯一的。确保具有相同端口号的服务不能在同一文件节点上运行、以避免端口冲突。</block>
  <block id="8a18a5a52ba3b55c805c94f8ac3889c9" category="list-text">如果需要、服务可以使用多个块节点和/或存储池中的卷(并非所有卷都需要归同一控制器所有)。多个服务也可以共享同一个块节点和/或存储池配置(各个卷将在后面的章节中进行定义)。</block>
  <block id="80a7df0cf1674016cc4cc2588c911429" category="cell">BeeGFS服务(文件名)</block>
  <block id="5515295c9721b17faa0365ab7a888791" category="cell">文件节点</block>
  <block id="7428caa4314139d517357edc7bd85e13" category="cell">&lt;SERVICE TYPE&gt; &lt;ID&gt;</block>
  <block id="05dbd6a9ac1e738536c568b9c76b6d9f" category="cell">&lt;PREFERRED FILE NODE&gt; &lt;SECONDARY FILE NODE(s)&gt;</block>
  <block id="ce434f7769160d97da3ed0d746a4d983" category="cell">&lt;INTERFACE&gt; ：&lt;IP/SUBNET&gt; &lt;INTERFACE&gt; ：&lt;IP/SUBNET&gt;</block>
  <block id="0f9b262f92ad6ba4a547abbe4c98c80b" category="cell">&lt;NUMA NODE/ZONE&gt;</block>
  <block id="9746b3183301bae601d6d3e7479f01f9" category="cell">&lt;BLOCK NODE&gt;</block>
  <block id="b95d182f851d32de39590b07917d6dc2" category="cell">&lt;STORAGE POOL/VOLUME GROUP&gt;</block>
  <block id="fe1341a187350b5203bdf2c08baa2ac8" category="cell">&lt;A OR B&gt;</block>
  <block id="78ff65afbf92a15cd30dea91aefc1e9b" category="inline-link-macro">最佳实践</block>
  <block id="b7121c47f4a8776d685a934610733179" category="inline-link-macro">定义BeeGFS组件</block>
  <block id="0d4f2647b7895adb046a3392c35f6828" category="summary">安装用于在NetApp上运行BeeGFS的硬件并为其布线所需的步骤。</block>
  <block id="7cb1df0e9acb4e346f49d40865ebd99f" category="doc">安装硬件并为其布线</block>
  <block id="d0dde32750edec525fffdeacdfe54a80" category="section-title">规划安装</block>
  <block id="694daa4aca75c61a285846a5ec0b4b0c" category="paragraph">每个BeeGFS文件系统将包含一些文件节点、这些文件节点运行BeeGFS服务、并使用由某些数量的块节点提供的后端存储。文件节点配置为一个或多个高可用性集群、以便为BeeGFS服务提供容错功能。每个块节点都已是一个主动/主动HA对。每个HA集群中支持的文件节点的最小数量为3个、每个集群中支持的文件节点的最大数量为10个。BeeGFS文件系统可以通过部署多个独立的HA集群来扩展到10个以上节点、这些集群可以协同工作来提供一个文件系统命名空间。</block>
  <block id="bb4d2a6e482d18af607ee0f07c23d049" category="paragraph">通常、每个HA集群都部署为一系列"组件"、其中、一些文件节点(x86服务器)直接连接到某些数量的块节点(通常为E系列存储系统)。此配置会创建一个非对称集群、在此集群中、BeeGFS服务只能在某些文件节点上运行、这些文件节点可以访问用于BeeGFS目标的后端块存储。每个组件中的文件到块节点与直接连接所使用的存储协议的平衡取决于特定安装的要求。</block>
  <block id="f1fafc095d6233cf2f9c8d299f6427bb" category="paragraph">另一种HA集群架构使用文件节点和块节点之间的存储网络结构(也称为存储区域网络或SAN)来建立对称集群。这样、BeeGFS服务便可在特定HA集群中的任何文件节点上运行。由于增加了SAN硬件、一般对称集群的成本效益不高、因此本文档假定使用的是部署为一系列一个或多个组件的非对称集群。</block>
  <block id="edda5f6836a1cf72ee14894e512b7707" category="admonition">在继续安装之前、请确保已充分了解特定BeeGFS部署所需的文件系统架构。</block>
  <block id="767202c8efedcb9c8edf20f9fce9818d" category="section-title">机架硬件</block>
  <block id="14511f2f5564650d129ca7cabc333278" category="inline-link-macro">块</block>
  <block id="d5e81e99079cfbb27d893365b01c6733" category="paragraph">在规划安装时、每个组件中的所有设备都必须安装在相邻的机架单元中。最佳实践是、将文件节点直接机架安装在每个构建块中的块节点上方。按照文件和型号对应的文档进行操作 <block ref="3876eb55ee0ffaac1627ebbb7ea8fad8" category="inline-link-macro-rx"></block> 在机架中安装导轨和硬件时所使用的节点。</block>
  <block id="39979c4d8cb83fc0443baa4ff7f48f07" category="paragraph">单个组件示例：</block>
  <block id="98ac29120ce31a8b9f17cc6bcad239b1" category="paragraph">大型BeeGFS安装示例、其中每个HA集群中有多个组件、文件系统中有多个HA集群：</block>
  <block id="bdc136e73217b9254f82f3e521e32772" category="section-title">为文件和块节点布线</block>
  <block id="f6f19d063d8a1cc74be9ed77236d08df" category="inline-link-macro">基于经过NetApp验证的第二代BeeGFS架构</block>
  <block id="40bc85e53495ab0b176af4ef17ea6072" category="section-title">使用缆线将文件节点连接到客户端网络</block>
  <block id="1899ae951504892f3420f88e3162b84d" category="paragraph">每个文件节点都将为BeeGFS客户端流量指定一定数量的InfiniBand或以太网端口。根据架构的不同、每个文件节点将有一个或多个连接到高性能客户端/存储网络、也可能连接到多个交换机以实现冗余并增加带宽。以下是使用冗余网络交换机进行客户端布线的示例、其中以深绿色和浅绿色突出显示的端口连接到不同的交换机：</block>
  <block id="90a31af51bc017a18f8f032fa49cf901" category="section-title">连接管理网络和电源</block>
  <block id="b213f1ea719142ad3112dd64e712e06a" category="paragraph">建立带内和带外网络所需的任何网络连接。</block>
  <block id="2f967ed85c3e532e8aee39997f97a27c" category="paragraph">连接所有电源、确保每个文件和块节点都连接到多个配电单元以实现冗余(如果可用)。</block>
  <block id="90791b7e8bfac5f0631992c1a7269f5e" category="summary">设置Ansible控制节点以部署和管理文件系统。</block>
  <block id="9cdd817721bc924d0da9d43995b6cf7d" category="doc">设置Ansible控制节点</block>
  <block id="31996051b4f5b99834fd90885ae099c1" category="paragraph">Ansible控制节点是用于管理集群的物理或虚拟Linux计算机。它必须满足以下要求：</block>
  <block id="b4851e92b19af0c5c82447fc0937709d" category="inline-link-macro">要求</block>
  <block id="5f4740da5b8ab13112ebf332f879cc6e" category="list-text">与官方人员会面 <block ref="37e11d19f014e84f10fff4770a09b235" category="inline-link-macro-rx"></block> 包括操作系统版本。</block>
  <block id="2bce5080fcc3d6b8a54a49745dd28d52" category="list-text">对所有文件和块节点具有SSH和HTTPS访问权限。</block>
  <block id="9635e0061cd355a35e70799e909727af" category="summary">在运行Ansible之前设置文件和块节点所需的手动步骤。</block>
  <block id="f5878e619c266b2ac6254dd1e4d95bfb" category="doc">设置文件和块节点</block>
  <block id="d3f9f418681aaa08eb617366f4e167e0" category="section-title">配置基板管理控制器(BMC)</block>
  <block id="d387b972fad59cf81f9a534bd8f6c654" category="paragraph">基板管理控制器(Baseboard Management Controller、BMC)有时也称为服务处理器、它是内置于各种服务器平台中的带外管理功能的通用名称、即使操作系统未安装或无法访问、也可以提供远程访问。供应商通常会使用自己的品牌推广此功能。例如、在联想SR665上、BMC称为联想XicLityController (XCC)。</block>
  <block id="9f9fca437c1db2135d8b5e17bdc36ff6" category="paragraph">按照服务器供应商的文档启用访问此功能所需的任何许可证、并确保BMC已连接到网络并已正确配置用于远程访问。</block>
  <block id="d4519b3f996eace0908217fda1966da8" category="admonition">如果需要使用Redfish进行基于BMC的隔离、请确保已启用Redfish、并且可以从文件节点上安装的操作系统访问BMC界面。如果BMC和操作系统共享同一物理网络接口、则可能需要对网络交换机进行特殊配置。</block>
  <block id="f9fa015b01242f44a7319213f0a01ff2" category="section-title">调整系统设置</block>
  <block id="93f3e5d94e30643aac7f8755a6dcfeb4" category="inline-link-macro">已验证文件节点型号</block>
  <block id="b9a7b8c50025e62b9e91f9baf3ba2304" category="section-title">安装操作系统</block>
  <block id="a82007c47b25723539a00ff94e8b3d27" category="section-title">RedHat</block>
  <block id="5ab261ccc77c613b4430d72688133ef7" category="paragraph">使用RedHat订阅管理器注册并订阅系统、以便可以从官方Red Hat存储库安装所需的软件包、并将更新限制为受支持的Red Hat版本：<block ref="77a4421cc9f01b777ceaeda595865c3c" prefix=" " category="inline-code"></block>。有关说明，请参见<block ref="2e2e1be81972e19947d90393d5319b6e" category="inline-link-rx"></block> 和 <block ref="bbd834e2960f33a50fb102fd4d31a6d9" category="inline-link-rx"></block>。</block>
  <block id="9a7877d2d6f43233661b52c31362cb32" category="paragraph">启用包含高可用性所需软件包的Red Hat存储库：</block>
  <block id="5ea84babe2cd259121a70aff2652769b" category="section-title">配置管理网络</block>
  <block id="45f7cb03ff15b64d9405b68be6bdcc97" category="paragraph">配置所需的任何网络接口、以便对操作系统进行带内管理。具体步骤取决于所使用的特定Linux版本。</block>
  <block id="6c2e3de482271e18e34375218bcbbfcd" category="admonition">确保已启用SSH、并且可从Ansible控制节点访问所有管理接口。</block>
  <block id="ab2b3440ca9e61bb50d98cdd593fea31" category="section-title">更新HCA和HBA固件</block>
  <block id="48206a73aaea76911a94b52a97986f4a" category="section-title">块节点</block>
  <block id="76752be68c87426437dc7d4a501b481c" category="inline-link-macro">启动并运行E系列</block>
  <block id="871d3d62a8d11ed96c7c911ca5961c83" category="paragraph">按照步骤执行操作 <block ref="4525dc880e156901740411dc7fd56b26" category="inline-link-macro-rx"></block> 在每个块节点控制器上配置管理端口、并可选择为每个系统设置存储阵列名称。</block>
  <block id="20c7fe47a0acb373f79e663a36dd1e25" category="admonition">除了确保可从Ansible控制节点访问所有块节点之外、无需进行其他配置。其余系统配置将使用Ansible进行应用/维护。</block>
  <block id="40df644de3579bec4038eafb77eb26fe" category="summary">也可以使用Ansible配置BeeGFS客户端并挂载文件系统。</block>
  <block id="107dafc3c3dfc88c15a7700fd40a35dc" category="doc">部署BeeGFS客户端</block>
  <block id="fc9048a17c6ddc968465bcc02c0ea486" category="inline-link-macro">Ansible角色</block>
  <block id="dcce328dbfa187984479bbc5ace17bf2" category="paragraph">要访问BeeGFS文件系统、需要在需要挂载文件系统的每个节点上安装和配置BeeGFS客户端。本节介绍如何使用可用执行这些任务 <block ref="0ceebef54e9df7cedfb22dd6dcf5ed37" category="inline-link-macro-rx"></block>。</block>
  <block id="2106244b87f596d4fefd89f77dae13da" category="section-title">创建客户端清单文件</block>
  <block id="7dc2ac40c1549980b4ac09d940856f47" category="list-text">下<block ref="4d729f58293c8a48f1f8d918cdd1d28f" prefix=" " category="inline-code"></block>下、为名为的每个BeeGFS客户端创建一个文件<block ref="a0253f5b8f5dd7be8b02cda13da40729" prefix=" " category="inline-code"></block> 使用以下内容、在占位符文本中填写适用于您环境的正确信息：</block>
  <block id="689b0940ce8c21b1ecd3dafd9cc19d56" category="list-text">如果要使用NetApp E系列主机集合的角色配置InfiniBand或以太网接口、以便客户端连接到BeeGFS文件节点、也可以包括以下选项之一：</block>
  <block id="825f3be2c17c36c0e4901143db982773" category="list-text">创建新文件<block ref="c28f9364916e661fea858844d2b96b81" prefix=" " category="inline-code"></block> 并指定Ansible应用于连接到每个客户端的用户、Ansible应用于权限升级的密码(这需要<block ref="f2bf771afbc16045e1951ded58c56f98" prefix=" " category="inline-code"></block> 为root用户或具有sudo权限)：</block>
  <block id="c5a4ae1aa23001e8780b413f175b50b3" category="admonition">请勿以纯文本格式存储密码。请改用Ansible Vault (请参见) <block ref="f2e33a881c3eb75b68333af99119c0b8" category="inline-link-macro-rx"></block> 使用Ansible Vault对内容进行加密)或使用<block ref="13d87b4892426ec19bdc58a4643d3104" prefix=" " category="inline-code"></block> 运行攻略手册时的选项。</block>
  <block id="848f64fc57104cb2b416f6102d34e699" category="list-text">在中<block ref="c28f9364916e661fea858844d2b96b81" prefix=" " category="inline-code"></block> 文件中、列出应在下配置为BeeGFS客户端的所有主机<block ref="fc2e11772a55c48ed2b4ec7bc5d94664" prefix=" " category="inline-code"></block> 组、然后参考实时注释、取消注释在系统上构建BeeGFS客户端内核模块所需的任何其他配置：</block>
  <block id="c378775497a55638adcb42719d8daddb" category="list-text">在中<block ref="c28f9364916e661fea858844d2b96b81" prefix=" " category="inline-code"></block> 文件中、列出要在先前定义的任何下挂载的BeeGFS文件系统<block ref="b63119da730344b345cdc8f62a4711e9" prefix=" " category="inline-code"></block>：</block>
  <block id="508ccac845ca75d6cdda20dfa455a2bd" category="inline-link-macro">通用文件节点配置</block>
  <block id="a7d7def0ef1d6627e10199d423565e7e" category="list-text">默认情况下、HA集群部署将自动配置连接身份验证并生成<block ref="cd304377fdc20285a5aa94e55ae85aa7" prefix=" " category="inline-code"></block> 该位置将放置/维护在位于的Ansible控制节点上<block ref="eee2923df30539b680421ca53d7c066b" prefix=" " category="inline-code"></block>。默认情况下、BeeGFS客户端角色设置为读取此文件或将其分发到中定义的客户端<block ref="c28f9364916e661fea858844d2b96b81" prefix=" " category="inline-code"></block>、不需要执行其他操作。</block>
  <block id="2c96dc448de9d0218bb361afae4689c8" category="inline-link-macro">BeeGFS客户端角色</block>
  <block id="cb7223c9ecb20da5826418267937cb4b" category="list-text">有关高级选项、请参阅随附的默认值完整列表 <block ref="1507a901cf67edf9930d46c852b1993d" category="inline-link-macro-rx"></block>。</block>
  <block id="f4c29fbb6bcbcc6c55ae76c0a5254687" category="list-text">如果选择使用指定自定义密钥<block ref="8b76cf2fb65e09dad03ca686be5cd464" prefix=" " category="inline-code"></block> 在中指定<block ref="c28f9364916e661fea858844d2b96b81" prefix=" " category="inline-code"></block> 文件：</block>
  <block id="2f01d79351dcc30d05b4a5a46dee42df" category="list-text">如果选择完全禁用基于连接的身份验证<block ref="6c8dd8672ca377e74101ad236282225a" prefix=" " category="inline-code"></block>、在中指定<block ref="c28f9364916e661fea858844d2b96b81" prefix=" " category="inline-code"></block> 文件：</block>
  <block id="4debabcfd87e8aaf710a4ef0b5fc0fbc" category="inline-link-macro">完整的BeeGFS客户端文档</block>
  <block id="be564dd8130b7faafb95d140037162bb" category="paragraph">有关支持的参数的完整列表和其他详细信息、请参见 <block ref="28ce7a1eece2b507c973d3cca2a82121" category="inline-link-macro-rx"></block>。有关客户端清单的完整示例、请单击 <block ref="b0d51f66522ad4d9697fdf435a95c97a" category="inline-link-macro-rx"></block>。</block>
  <block id="da7e04a55b40629ae3a62baa9635b36d" category="section-title">创建BeeGFS客户端攻略手册文件</block>
  <block id="964a26fa475bbef370601a9a9fb613cb" category="list-text">创建新文件<block ref="34bd6e27c43e6508a64d0a1bf093c7d2" prefix=" " category="inline-code"></block></block>
  <block id="ac25f4ce0e4e52459d58c2db4ebda280" category="list-text">可选：如果要使用NetApp E系列主机集合的角色配置客户端连接到BeeGFS文件系统的接口、请导入与要配置的接口类型对应的角色：</block>
  <block id="9f7ee0cead06efb0babbaca7b021e3ed" category="list-text">如果您使用的是使用InfiniBand (IPoIB)：</block>
  <block id="54b431528476178eb45a6c2570eff415" category="list-text">如果您使用的是基于融合以太网的RDMA (RoCE)：</block>
  <block id="ea7cb942473ffddb52c2661da2f3b951" category="list-text">如果您使用的是以太网(仅限TCP、无RDMA)：</block>
  <block id="975fc05779caaf583c3a8ab6b5c5adf1" category="list-text">最后、导入BeeGFS客户端角色以安装客户端软件并设置文件系统挂载：</block>
  <block id="02870b17064b23fcbf2e080b9624fd6d" category="paragraph">有关客户端攻略手册的完整示例、请单击 <block ref="dee50bfc7f141fd7ad52d525c94ac7f5" category="inline-link-macro-rx"></block>。</block>
  <block id="354895762186e608f5675b1498c26501" category="section-title">运行BeeGFS客户端攻略手册</block>
  <block id="831a82eacd2203b1049bc6c01826fbef" category="paragraph">要安装/构建客户端并挂载BeeGFS、请运行以下命令：</block>
  <block id="31a21a1e42c30056168ee5a4cca695a9" category="summary">使用攻略手册指定部署BeeGFS HA集群时应运行的任务。</block>
  <block id="aca5a5a6b413ed0913ad90f87766df63" category="paragraph">本节介绍如何组合用于在NetApp上部署/管理BeeGFS的标准攻略手册。</block>
  <block id="b3254ab5c14c4bb06dbb987f8ee20900" category="section-title">创建Ansible攻略手册</block>
  <block id="dc1e1a7b77e4fce07756f071e5ec7d8b" category="paragraph">创建文件<block ref="2f78c4e27feaf25ffb33d97e8ff7e7a6" prefix=" " category="inline-code"></block> 并按如下所示进行填充：</block>
  <block id="a3b34c0871dc2fd51eec5559b68f709d" category="inline-link-macro">播放</block>
  <block id="3b4e65c5ca327e9a010b0e69fb90e476" category="list-text">首先定义一组任务(通常称为 <block ref="6d76655a02e5cb4ca885a92d78a5ab31" category="inline-link-macro-rx"></block>)、并且只能在NetApp E系列块节点上运行。我们会使用暂停任务在运行安装之前进行提示(以避免意外运行攻略手册)、然后导入<block ref="504ead1cde99fc3bc223588114102919" prefix=" " category="inline-code"></block> 角色。此角色负责应用中定义的任何常规系统配置<block ref="7bc866ffde9914c7ef21768fcf6f0683" prefix=" " category="inline-code"></block> 或个人<block ref="7011fddbea4410953d6718ccf9ef966a" prefix=" " category="inline-code"></block> 文件。</block>
  <block id="19c06a0dc65b61c783f73d77e193957e" category="list-text">定义对所有文件和块节点运行的播放：</block>
  <block id="25296aae8975fe74b18a42af79a293d3" category="list-text">在此角色中、我们可以选择定义一组"预任务"、这些任务应在部署HA集群之前运行。这对于验证/安装Python等任何前提条件非常有用。我们还可以注入任何飞行前检查、例如验证是否支持提供的Ansible标记：</block>
  <block id="adcd434b091e5725531891ba91d50193" category="list-text">最后、此Play会为您要部署的BeeGFS版本导入BeeGFS HA角色：</block>
  <block id="d1b15e5b42308e0128908c431c40f477" category="inline-link-macro">升级指南</block>
  <block id="cf0e39575a3cd74789827d1f8d28bcb0" category="list-text">可选：如果要定义其他任务、请记住这些任务是否应定向到<block ref="a181a603769c1f98ad927e7367c7aa51" prefix=" " category="inline-code"></block> 主机(包括E系列存储系统)或仅文件节点。如果需要、可使用定义一个专门针对文件节点的新Play<block ref="0c748da7ba6880eb7537e471415afd58" prefix=" " category="inline-code"></block>。</block>
  <block id="abd8b7e36cb7499818727f42837b0025" category="paragraph">单击 <block ref="01ba4d718d4b882a06a17b3dab000fe7" category="inline-link-macro-rx"></block> 有关完整攻略手册文件的示例。</block>
  <block id="c6def9892d45d8f594a1141d759cff35" category="section-title">安装NetApp Ansible Collections</block>
  <block id="f996e211f2d82b62da74abbaa175d7bc" category="paragraph">Ansible和所有依赖关系的BeeGFS收集将在上进行维护 <block ref="d8617fd1dfbd628e2360b843d6070e54" category="inline-link-macro-rx"></block>。在Ansible控制节点上、运行以下命令以安装最新版本：</block>
  <block id="9a603171be277ec1f9319dc83b272723" category="paragraph">虽然通常不建议这样做、但也可以安装此集合的特定版本：</block>
  <block id="cb5da77fc5fc3c2fdb8aeff46789a9ca" category="section-title">运行攻略手册</block>
  <block id="440d2c1c46f7c70d35f630781d07e912" category="paragraph">位于包含的Ansible控制节点上的目录中<block ref="d28e452e49fc926f32af1d87afcff3ce" prefix=" " category="inline-code"></block> 和<block ref="2f78c4e27feaf25ffb33d97e8ff7e7a6" prefix=" " category="inline-code"></block> 文件、请按如下所示运行攻略手册：</block>
  <block id="b7a14d8dfd866e91a40ba8804324679a" category="paragraph">根据集群的大小、初始部署可能需要20分钟以上的时间。如果部署因任何原因失败、只需更正任何问题(例如布线不当、节点未启动等)、然后重新启动Ansible攻略手册即可。</block>
  <block id="86cd3363bcd965ea6807e544cdb56311" category="summary">在将系统投入生产之前、请验证文件系统部署。</block>
  <block id="0c947320dda2aecdd9ad8baca329d8a9" category="doc">验证BeeGFS部署</block>
  <block id="9f4d5d32220ec3141c624637c9a8b89f" category="paragraph">在将BeeGFS文件系统投入生产之前、请执行一些验证检查。</block>
  <block id="09b37befd9a82a1583041aaff8b9a03a" category="list-text">登录到任何客户端并运行以下命令、以确保所有预期节点均存在/可访问、并且未报告任何不一致或其他问题：</block>
  <block id="a1729ed32ceab91f7ef692e7af48a6b8" category="list-text">关闭整个集群、然后重新启动它。从任何文件节点运行以下命令：</block>
  <block id="989e28705c44d76a13ea323790377850" category="list-text">将每个节点置于备用状态、并验证BeeGFS服务是否能够故障转移到二级节点。要登录到任何文件节点并运行以下命令：</block>
  <block id="ba2b2e2a9229fbcedccdb09d825096ee" category="inline-link-macro">设计验证</block>
  <block id="fdb55059a4337ca76c138af7ad303efa" category="paragraph">应根据为特定站点/安装定义的验收标准执行其他测试。</block>
  <block id="71a6b27b610785178635f3c7fea0dc9c" category="summary">使用Ansible部署和管理BeeGFS HA集群。</block>
  <block id="03d8a35d2c337d83e9a0c791c0bde873" category="doc">Ansible攻略手册概述</block>
  <block id="dd3429f2a44e55e208032b591c258877" category="paragraph">前面几节介绍了构建表示BeeGFS HA集群的Ansible清单所需的步骤。本节介绍由NetApp开发的用于部署和管理集群的Ansible自动化功能。</block>
  <block id="531369b10b19be4aa811f6b1b1abfc32" category="section-title">Ansible：关键概念</block>
  <block id="c4c6df2bdb8451df5f63cc2602cd3266" category="paragraph">在继续操作之前、熟悉几个关键的Ansible概念会很有帮助：</block>
  <block id="0a4d7a775f170dc43fae102dc8eed0f1" category="list-text">根据Ansible清单执行的任务在称为*攻略手册*的内容中进行了定义。</block>
  <block id="503c50788505311e2737ca28bcfc6d1b" category="list-text">Ansible中的大多数任务都设计为*幂等*、这意味着可以多次运行这些任务、以验证所需的配置/状态是否仍然适用、而不会造成中断或进行不必要的更新。</block>
  <block id="fb3edd793b0a4233a87fc2742a893d8d" category="list-text">Ansible中最小的执行单位是*模块*。</block>
  <block id="d30cef0e8eb4eaf16c7181329c0d06bd" category="list-text">典型的攻略手册使用多个模块。</block>
  <block id="424107bb38bc62e70c34a281a355ca1d" category="list-text">示例：下载软件包、更新配置文件、启动/启用服务。</block>
  <block id="b34cf1156d6d4fc5d2020447509756c9" category="list-text">NetApp分发模块以自动执行NetApp E系列系统。</block>
  <block id="a5a68481f09270734c66ad9ff1dcd0af" category="list-text">更好地将复杂的自动化作为一个角色进行打包。</block>
  <block id="4eac750d0b9763378029ed193c50648c" category="list-text">基本上是分发可重复使用的攻略手册的标准格式。</block>
  <block id="caa4d8cd3e05670bd54bb0281f679498" category="list-text">NetApp为Linux主机和BeeGFS文件系统分发角色。</block>
  <block id="1aa532e3c0c6ac72094492dd5d4ad8fa" category="section-title">BeeGFS HA Role for Ansible：关键概念</block>
  <block id="8313d0dcd5307c834d7d37f194d4ea32" category="inline-link-macro">适用于BeeGFS的NetApp E系列Ansible资料集</block>
  <block id="8694b9bbf06f92b8fb6a129f90967b56" category="paragraph">在NetApp上部署和管理每个版本的BeeGFS所需的所有自动化功能均作为Ansible角色打包、并作为的一部分进行分发 <block ref="0d95f34d028d609c5e44d4c47f78ca03" category="inline-link-macro-rx"></block>：</block>
  <block id="e14542ae9d29391a92cc14f6b44e67fd" category="list-text">可以将此角色视为BeeGFS的*安装程序*和现代*部署/管理*引擎之间的某个位置。</block>
  <block id="3bcab18a67a5ea90f159f8f472ab0f9d" category="list-text">将现代基础架构应用为代码实践和理念、以简化任何规模的存储基础架构管理。</block>
  <block id="82877b38f579bedd3acfc034e6aa2a8e" category="inline-link-macro">Kubespray</block>
  <block id="34681b6b5fc6e725199f30a154956754" category="list-text">此角色是NetApp用于打包、分发和维护基于NetApp的BeeGFS解决方案的*软件定义*格式。</block>
  <block id="3c359db1a2bcb271a8a28e3381057655" category="list-text">无需分发整个Linux分发版或大型映像、即可努力打造"类似设备的"体验。</block>
  <block id="ebc3365fe74d7c659b1f0298995f6d39" category="list-text">包括NetApp编写的符合Open Cluster Framework (OCF)的集群资源代理、用于自定义BeeGFS目标、IP地址和监控、从而实现智能Pacemaker/BeeGFS集成。</block>
  <block id="8af5165ce6aabae36357e63702ba3fbf" category="list-text">此角色不仅仅是部署"自动化"、还用于管理整个文件系统生命周期、包括：</block>
  <block id="444e2df3560fe0281204fd385d895403" category="list-text">应用按服务或集群范围的配置更改和更新。</block>
  <block id="61ef90c42824e8e8c92d69c04046a94b" category="list-text">解决硬件问题后自动执行集群修复和恢复。</block>
  <block id="bb8450666975061db9804d65dbb5afbf" category="list-text">通过对BeeGFS和NetApp卷进行广泛测试来设置默认值、简化性能调整。</block>
  <block id="fded9f625af9335e3b78e65d6fd6abac" category="list-text">验证并更正配置偏差。</block>
  <block id="16a4e0aca277107b3401d2d33d4e5c00" category="inline-link-macro">BeeGFS客户端</block>
  <block id="1c82d73e983ef595a7c60ff4647716a7" category="paragraph">NetApp还为提供了Ansible角色 <block ref="b6cde77df9fbd5f549a35216e2ea351f" category="inline-link-macro-rx"></block>、可选择用于安装BeeGFS并将文件系统挂载到计算/GPU/登录节点。</block>
  <block id="33abf34a1ac99d306f38ad532ed75170" category="inline-link-macro">用户指南</block>
  <block id="55f7d3580cdac035324d4348b9dac05b" category="inline-link-macro">管理BeeGFS集群</block>
  <block id="3e3cee1fd1e1de5762df25400f62794a" category="paragraph">HPC集群中运行需要利用文件系统的应用程序的节点。有时也称为计算或GPU节点。</block>
  <block id="67d6c06d21e47a4c86e1be15e327370e" category="paragraph">存储网络/客户端网络</block>
  <block id="7829f14ded222e6be0bb1a1d28e8f977" category="paragraph">客户端用来与BeeGFS文件系统通信的网络。这通常与HPC集群节点之间用于并行消息传递接口(MPI)和其他应用程序通信的网络相同。</block>
  <block id="d02afad2b9d23614832a35187b8296bf" category="summary">本站点介绍了如何在NetApp上部署和管理BeeGFS。</block>
  <block id="f3ea919081d7ce9021ea4cd631632407" category="paragraph">本站点介绍了如何使用NetApp验证架构(NetApp Verified Architectures、NVA)和自定义架构在NetApp上部署和管理BeeGFS。NVA设计经过全面测试、可为客户提供参考配置和规模估算指导、从而最大程度地降低部署风险并加快上市速度。NetApp还支持在NetApp硬件上运行的自定义BeeGFS架构、使客户和合作伙伴可以灵活地设计文件系统、以满足广泛的要求。这两种方法都利用Ansible进行部署、从而提供了一种类似于设备的方法、可以在灵活的硬件范围内以任意规模管理BeeGFS。</block>
  <block id="2146c9256a2a3883605731032b6b8015" category="sidebar">使用经验证的架构</block>
  <block id="2c9d17683bf440abca82add607aa6a61" category="sidebar">初始设置</block>
  <block id="2186112c2fe23afc42ab96c76b10633c" category="sidebar">安装硬件并为其布线</block>
  <block id="d2c71dbf224d233986fd9fee484a1bff" category="sidebar">定义BeeGFS文件系统</block>
  <block id="d2b9bae490422ee64c78a0825f1c1d47" category="sidebar">定义文件和块节点</block>
  <block id="e0f1083c7a219d40d5f2cce31e733837" category="sidebar">配置单个文件节点</block>
  <block id="aaadb61f664f163c98ebee0c9c962dda" category="sidebar">配置单个块节点</block>
  <block id="2c6acfbd0549df84a730e9135dfa642a" category="sidebar">指定通用文件节点配置</block>
  <block id="de1a5ef51d1a1d949b60789be3110709" category="sidebar">指定通用块节点配置</block>
  <block id="8283d5b2387e743d14bda00c2176d402" category="sidebar">定义BeeGFS服务</block>
  <block id="4ea9c51458de5a50fcfc6ed1d6731376" category="sidebar">BeeGFS管理服务</block>
  <block id="fc0c3d42b552d41c96b314b10a5d8322" category="sidebar">BeeGFS元数据服务</block>
  <block id="941fb85375314e8f03181252062f8321" category="sidebar">BeeGFS存储服务</block>
  <block id="67f0f9eb53d18fde2907a79ffc52ab62" category="sidebar">部署BeeGFS文件系统</block>
  <block id="7d980eb0cd911c4219870701e3c4ffce" category="sidebar">管理BeeGFS集群</block>
  <block id="58f82a4575a638ca0eba992df08c4d2b" category="sidebar">何时使用Ansible与pcs</block>
  <block id="bbfb06821b506d64fdaee613711657d4" category="sidebar">维护和维护</block>
  <block id="52009bb7ee17227f566cd26a02caee56" category="inline-link-macro"><block ref="52009bb7ee17227f566cd26a02caee56" category="inline-link-rx"></block></block>
  <block id="a1a9afcf552a769c282769271829889a" category="paragraph"><block ref="a1a9afcf552a769c282769271829889a" category="inline-link-macro-rx"></block></block>
  <block id="f99aa604031e5049799e73b5c3748a98" category="inline-link-macro"><block ref="f99aa604031e5049799e73b5c3748a98" category="inline-link-rx"></block></block>
  <block id="5d545fe5152641e2ebe654e336e520e5" category="paragraph"><block ref="5d545fe5152641e2ebe654e336e520e5" category="inline-link-macro-rx"></block></block>
  <block id="88e5eabd3917048b6927c42496b98f86" category="inline-link-macro"><block ref="88e5eabd3917048b6927c42496b98f86" category="inline-link-rx"></block></block>
  <block id="dd38f906b37d412de7d1c1dcf4cbf31c" category="paragraph"><block ref="dd38f906b37d412de7d1c1dcf4cbf31c" category="inline-link-macro-rx"></block></block>
  <block id="8acb58cbd50ef1b468a020ee0bd351d3" category="inline-link-macro"><block ref="8acb58cbd50ef1b468a020ee0bd351d3" category="inline-link-rx"></block></block>
  <block id="2352c4e1f4d0024ade0869e00e6243f4" category="paragraph"><block ref="2352c4e1f4d0024ade0869e00e6243f4" category="inline-link-macro-rx"></block></block>
  <block id="e8afe31a21b6aae9717484d865743dae" category="sidebar">采用E系列存储的NetApp上的BeeGFS是一款经验证的集成解决方案、具有简单、可靠、可扩展且经济高效的HPC基础架构、可满足最极端工作负载的需求。</block>
  <block id="3a9aabbbb8c331319a41788bf5d1786a" category="paragraph">在物理组装和创建Ansible清单文件时、请遵循以下标准约定(有关详细信息、请参见 <block ref="dbbcb9482f49ee969cddb7f10864cbd0" category="inline-link-macro-rx"></block>）。</block>
  <block id="a743f5810f84b94eef8da441707ef9cb" category="paragraph">要将HDR (200 GB) InfiniBand与EF600结合使用、必须为每个物理端口配置第二个"虚拟" IP。下面是配置配备双端口InfiniBand HDR HIC的EF600的正确方法示例：</block>
  <block id="ba83328d8d0f6845114641c46fd328ed" category="paragraph">在本示例中、BeeGFS服务meta_08因某种原因停止。要继续进行故障排除，我们应启动beegfs_02并查看位于的服务日志<block ref="45434eee994714888e9eafad4993b0d3" prefix=" " category="inline-code"></block>。例如、BeeGFS服务可能由于内部问题描述 或节点问题而遇到应用程序错误。</block>
  <block id="12edeb5890095749089987982a1404ce" category="cell">7.4.1</block>
  <block id="edd2140e3bcb557a4bc234fc76e2dfb3" category="cell">使用beegfs Collection v3.2.0进行升级</block>
  <block id="fb6df547cfb7d95cb9b49b8301cad3ab" category="cell">7.4.2</block>
  <block id="549cabdee707d530b4b718071c2b04e9" category="paragraph">如果要在主要版本或次要版本之间切换、请在用于部署和维护集群的文件中<block ref="2f78c4e27feaf25ffb33d97e8ff7e7a6" prefix=" " category="inline-code"></block> 更新角色名称、<block ref="66b5cc4f55c22b7b05dfd4be1be47aab" prefix=" " category="inline-code"></block> 以反映所需的版本。例如，如果您要部署BeeGFS 7.4，则该文件为<block ref="bf8d782a5f25b975eee48d224688885f" prefix=" " category="inline-code"></block>：</block>
  <block id="e8c7ab07a88c53743d909983583625f9" category="paragraph">例如、在此示例文件中<block ref="d28e452e49fc926f32af1d87afcff3ce" prefix=" " category="inline-code"></block> 、beegfs_01是运行BeeGFS管理服务的首选文件节点：</block>
  <block id="cb7c9e260fba17d2ffcc93361a0eab2e" category="paragraph">反转顺序将使beegfs_02上的管理服务成为首选发生原因 ：</block>
  <block id="958b8a27f957bef8700299f8cafb9b9a" category="admonition">请勿指定单个资源或资源组。请始终为要重新定位的BeeGFS服务指定监控器的名称。例如，要将BeeGFS管理服务移至beegfs_02，请运行：<block ref="ad6bdcc4dd95b7dbe9e00b9894a08e42" prefix=" " category="inline-code"></block>。可以重复执行此过程、将一个或多个服务从其首选节点移出。使用服务验证<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block> 是否已在新节点上重新定位/启动。</block>
  <block id="de752721186f0ef334b71ac4b3fe9cb5" category="paragraph">文件节点必须运行RedHat 9.3、并有权访问包含所需软件包(pacemaker、corosync、fence-agents-all、resource-agents.)的HA存储库。例如、可以执行以下命令在RedHat 9上启用相应的存储库：</block>
  <block id="aaf17f2a8cba647c8702de94c1bef112" category="list-text">注意如果需要、也可以在此处指定任何受支持的 <block ref="f4efc844d4401fa0cd59f82e6a720d5a" category="inline-link-macro-rx"></block> 。通常不需要调整这些值，因为BeeGFS HA角色附带了许多经过充分测试的 <block ref="62cb44c0555eaba8953c22f475d751a4" category="inline-link-macro-rx"></block>。</block>
  <block id="064f7cc76dc5afb2fb3aa165873ba871" category="list-text">有关配置其他隔离代理的详细信息，请参见 <block ref="1e76955e0560eaf6ce328d55fb062eeb" category="inline-link-macro-rx"></block>。</block>
  <block id="b611c6838bc0b80a5b542ae4d720301f" category="list-text">BeeGFS HA角色可以应用多种不同的调整参数来帮助进一步优化性能。其中包括优化内核内存利用率和块设备I/O等参数。根据对NetApp E-Series块节点的测试、此角色会附带一组合理的 <block ref="e3e5af180e2cd561ad9b935d8101ce4e" category="inline-link-macro-rx"></block> 、但默认情况下、除非您指定以下内容、否则不会应用这些功能：</block>
  <block id="7353e78ee2c3bb2136aa1b29915ccf4b" category="list-text">如果需要、还可以在此处指定对默认性能调整所做的任何更改。有关更多详细信息、请参见完整 <block ref="df0e33f301a426939663a0f2db36079c" category="inline-link-macro-rx"></block> 文档。</block>
  <block id="37fa384fbce35691f87f5108b23924df" category="list-text">(可选)指定应应用于集群中所有BeeGFS服务的配置。可以找到默认配置值 <block ref="cb8aac20b4c821ca121d5c55cc4298ed" category="inline-link-macro-rx"></block>，并在其他位置指定每项服务配置：</block>
  <block id="61eef27bde9b61db5c00501b13e855d5" category="list-text">有关高级选项，请参阅附带的完整默认值列表 <block ref="cf22ff8e76067e7f0eed610c434ec47d" category="inline-link-macro-rx"></block>。</block>
  <block id="5452bc376e228dbfc0b465054f2483c7" category="paragraph">目前、受支持的Linux分发版附带的收件箱版本<block ref="d21519b2c7af8ce90e382199384a8c06" prefix=" " category="inline-code"></block> 不支持虚拟化。而是需要从NVIDIA OpenFabFabric企业分发版(OFED)安装和配置版本<block ref="d21519b2c7af8ce90e382199384a8c06" prefix=" " category="inline-code"></block> 。尽管仍支持使用Ansible进行部署、但还需要执行一些额外步骤：</block>
  <block id="a7d969bead9b9df7cbb19855a88e29f0" category="list-text">用于集群通信的任何网络的性能对于文件系统性能并不重要。使用默认集群配置时、通常至少1 Gb/秒的网络可为集群操作(例如同步节点状态和协调集群资源状态更改)提供足够的性能。慢速/繁忙网络可能会使发生原因 资源状态发生变化、所需时间比平常要长、在极端情况下、如果节点无法在合理的时间范围内发送检测信号、可能会导致节点被逐出集群。</block>
  <block id="b1c24e06350be92498850e67cc8d9f5b" category="inline-link-macro">NVIDIA软件工具(MFT)</block>
  <block id="042d56fca47b68c93d438d4b1275b212" category="paragraph">NVIDIA ConnectX-Virtual Protocol Interconnect &amp; reg；(VPI)适配器既支持InfiniBand、也支持以太网作为传输层。不会自动协商模式之间的切换，必须使用中包含的工具进行配置<block ref="366fe119442ebda85ac564541700d0b5" prefix=" " category="inline-code"></block> ，该工具<block ref="a55706c70f646ff289a7f6fb8ddc1353" prefix=" " category="inline-code"></block>是的一个开放源代码软件包 <block ref="feedb9cf3a554ef170c48364196566a1" category="inline-link-macro-rx"></block>。只需更改一次适配器的模式即可。这可以手动完成、也可以作为使用清单部分配置的任何接口的一部分包含在Ands得以 自动检查/应用的清单中<block ref="d6ca1855b29b160948694322764a86cb" prefix=" " category="inline-code"></block> 。</block>
  <block id="815feebb5e4cc6a260b0689a8647ef51" category="admonition">使用NVIDIA OFED驱动程序时、请确保beegfs_client_OFED_include_path指向适用于您的Linux安装的正确"header include path"。有关详细信息，请参见的BeeGFS文档 <block ref="a36a0245ff208157cbdf93cd51fc1311" category="inline-link-macro-rx"></block>。</block>
  <block id="fbe2ee36e5e515b0ea11d513d4edd60d" category="paragraph">NetApp上的BeeGFS解决方案已验证以下节点。</block>
  <block id="6c3a6944a808a7c0bbb6788dbec54a9f" category="cell">节点</block>
  <block id="3c02a379965ab0dfcd77b1c484450433" category="cell">硬件</block>
  <block id="e1e4c8c9ccd9fc39c391da4bcd093fb2" category="cell">块</block>
  <block id="11eae0b95e61cd22a675ac3a648e9f79" category="cell">NetApp EF600存储系统</block>
  <block id="318d8d02c042e4aa8cd7ae129f0a339b" category="cell">一款高性能全NVMe 2U存储阵列、专为要求苛刻的工作负载而设计。</block>
  <block id="0b27918290ff5323bea1e3b78a9cf04e" category="cell">文件</block>
  <block id="8c9b1d5381233aa78ea770058e6742e6" category="cell">Lenovo ThinkSystem SR6SR V3服务器</block>
  <block id="2a3586b2a3c3de10623ad3288a90f6dd" category="cell">双插槽2U服务器、采用PCIe 5.0、双AMD EPYC 9124处理器。有关Lenovo SR更 多功能的详细信息，请参阅<block ref="7f25034611c942664d16f6d0ddb47fad" category="inline-link-rx"></block>。</block>
  <block id="ae1c04d15a9494b2729aa9280c0120fa" category="cell">Lenovo ThinkSystem SR6SR服务器</block>
  <block id="d1c6fb9a2f602020b776764cc928e4c4" category="cell">双插槽2U服务器、采用PCIe 4.0和双AMD EPYC 7003处理器。有关联想SR想 使用的详细信息，请参阅<block ref="65dfa08d35b276d60d397ded9080ccd5" category="inline-link-rx"></block>。</block>
  <block id="62ecfeab471e0776b331e56e58d79d41" category="paragraph">该解决方案的组件(如下图所示)使用经过验证的文件节点服务器作为BeeGFS文件层、并使用两个EF600存储系统作为块层。</block>
  <block id="f220d8966f97bec043102cd415b93605" category="paragraph">NetApp解决方案 上的BeeGFS可跨部署中的所有组件运行。部署的第一个组件必须运行BeeGFS管理、元数据和存储服务(称为基础组件)。所有后续组件均可通过软件进行配置、以扩展元数据和存储服务、或者专门提供存储服务。通过这种模块化方法、可以根据工作负载的需求扩展文件系统、同时使用相同的底层硬件平台和组件设计。</block>
  <block id="2cad05d70c2bc093824c9105ad50dc45" category="paragraph">最多可以部署五个组件、以构成一个独立的Linux HA集群。这样可以优化PacMaker的资源管理、并保持与Corosync的高效同步。将一个或多个独立BeeGFS HA集群组合在一起、以创建一个BeeGFS文件系统、此文件系统可作为一个存储命名空间供客户端访问。在硬件方面、一个42U机架最多可容纳五个组件、并可为存储/数据网络配备两个1U InfiniBand交换机。有关可视化表示、请参见下图。</block>
  <block id="a4186acf84c4a49d9d83b2b83544a1c8" category="admonition">要在故障转移集群中建立仲裁、至少需要两个组件。双节点集群存在一些限制、可能会阻止成功进行故障转移。您可以通过将第三个设备整合为Tieb破碎 机来配置双节点集群；但是、本文档不会介绍这种设计。</block>
  <block id="7531d1760bee1e64b20f1f8975ccfc87" category="paragraph">例如，命名约定<block ref="6171c77957e7dd932771522d0f5313aa" prefix=" " category="inline-code"></block> 如下所示：<block ref="201b23a54c1ff68053f15f81feb28cbb" prefix=" " category="inline-code"></block>。</block>
  <block id="db94a118f0347e2dbe0ef8f3c0674d1f" category="paragraph">例如，名为的块节点<block ref="ca9fd584227ff345bca2ef90d5c56e63" prefix=" " category="inline-code"></block> 通常可以为每个控制器配置主机名，如<block ref="86ee3de8557579a76634023aa5ccc100" prefix=" " category="inline-code"></block> 和<block ref="32665fb108839c23a5db4a463e74176e" prefix=" " category="inline-code"></block>，但在Ans得 清单中称为<block ref="3d1a3866e5aadfdac8b0e07e6740b0fe" prefix=" " category="inline-code"></block>。</block>
  <block id="a0e2a91b693d9eb92fb3153f61dfe4fa" category="section-title">BeeGFS客户端-服务器IPoIB寻址方案</block>
  <block id="7f5258ce731ddb14570317599b9962d9" category="list-text">BeeGFS存储服务始终位于<block ref="7bda92dd6fa15b04835e990fcef5c6f7" prefix=" " category="inline-code"></block> 或<block ref="0dc2ee6e17afcd7bafe09a4e99667f35" prefix=" " category="inline-code"></block>。</block>
  <block id="888c436af0d0f519ac3018d0df7868cd" category="section-title">IPoIB单子网寻址方案</block>
  <block id="c9923a234c7bd25e331582479a38a503" category="inline-link-macro">软件架构</block>
  <block id="9159781ab55be88f1f26fb2b8e4e7420" category="paragraph">鉴于中列出的优势，本部署指南将使用单个子网模式 <block ref="2504f4d58c8f68628557b72cf70af5b4" category="inline-link-macro-rx"></block>。</block>
  <block id="8474461676c84fa210da74bbd55e916d" category="paragraph-title">子网：100.127.0.0/16</block>
  <block id="e7e7c18d006d81c97d299954457c88f1" category="paragraph">下表提供了单个子网的范围：100.127.0.0/16。</block>
  <block id="039d7982c08566a6ae03eaa24cb6c670" category="cell">i1b或i4b</block>
  <block id="56fd2b46f686fb44565e25ca28a93fc0" category="cell">100.127.102.0</block>
  <block id="437dac4e62a043183f68652e142fc4a3" category="cell">100.127.102.1 - 100.127.102.255</block>
  <block id="031082c8b0090f55cf416fb5aa46e723" category="cell">100.127.104.1 - 100.127.104.255</block>
  <block id="2cc4767a51c5d45fecfa3be2bb68037c" category="section-title">IPoIB双子网寻址方案</block>
  <block id="e1c71427409ff54c1742cb28f621dcd5" category="paragraph">不再建议使用双子网编址方案、但仍可实施。有关建议的双子网方案、请参见下表。</block>
  <block id="29ebd98b5bc8daaac03bfdeefabf090e" category="admonition">如果使用双子网寻址方案进行部署、则必须在每个客户端上配置两个InfiniBand接口、两个存储IPoIB子网中的每一个都配置一个。如果为此处列出的每个BeeGFS服务使用示例子网和建议范围，则客户端应在到范围内配置一个接口，而在到范围内配置另一个接口<block ref="0c41ff65aa6ae425a8c58863fcb3cef5" prefix=" " category="inline-code"></block><block ref="b4e6b2ab9469bd0c90a8b83c8ebc175f" prefix=" " category="inline-code"></block><block ref="ee8ceb74abe0adf268a6f4a36c7735d9" prefix=" " category="inline-code"></block><block ref="4a52c6bf091e6a4cd2fd08fa070352e3" prefix=" " category="inline-code"></block>。</block>
  <block id="6dc47c91cdf35bbb7cac1fd9e1ff29d7" category="admonition">使用NVIDIA OFED驱动程序时、请确保<block ref="f24d21b8b47b3902162911c8595514e9" prefix=" " category="inline-code"></block> 指向适用于您的Linux安装的正确"headerinclude path"。有关详细信息，请参见的BeeGFS文档<block ref="ad551773fffeead9219b565416da2397" category="inline-link-rx"></block>。</block>
  <block id="ba9cd5a8827de277f30213c3a9f74d65" category="list-text">为您的部署选择子网编址方案。由于中列出的优势 <block ref="2504f4d58c8f68628557b72cf70af5b4" category="inline-link-macro-rx"></block>，建议使用单个子网编址方案。</block>
  <block id="c9e946c487cb8ab99c1f1b0c16839f91" category="list-text">配置隔离代理。(有关详细信息，请参见<block ref="36285c27b4e0cfacce4f264137f7dfc3" category="inline-link-rx"></block>。)以下输出显示了配置常见隔离代理的示例。选择以下选项之一。</block>
  <block id="90fd7614ddbcf02d5873d67a7e08983a" category="paragraph">有关可调整的可用调整参数的完整列表，请参见中BeeGFS HA角色的“性能调整默认值”部分<block ref="88ca1124cd8a9bf4401c9daba82c5025" category="inline-link-rx"></block>。 可以覆盖此文件或单个节点的文件中集群中所有节点的默认值<block ref="3342582e194d63e4c91b56623752c9c6" prefix=" " category="inline-code"></block> 。</block>
  <block id="75d34bd8c0a1081d52b926e7b1b60689" category="inline-link-macro">文件节点要求</block>
  <block id="3762dd806b1df772618c9caeb19d9d43" category="list-text">要在块节点和文件节点之间实现完整的200GB/HDR连接、请使用NVIDIA开放式网络结构企业分发版(MLNR_OFED)中的开放式子网管理器(OpenSM)软件包。中列出的MLNR_OFED版本 <block ref="1dfb967627cb2f0e7f82d8713fd73b4c" category="inline-link-macro-rx"></block> 与建议的OpenSM软件包捆绑在一起。虽然支持使用Ansimply进行部署、但您必须先在所有文件节点上安装MLNR_OFED驱动程序。</block>
  <block id="c113a52851d26cf252ec05ac9628162e" category="list-text">从下载并安装可用于块节点中安装的驱动器的最新驱动器固件<block ref="df4241174f74102a38fc34a378114b68" category="inline-link-rx"></block>。您可以手动升级它们、也可以将其包含在Ansul任<block ref="93501a11e921083efbd154e0cdff5f10" prefix=" " category="inline-code"></block> 控制节点的目录中、然后在中填充以下参数<block ref="79d2514d0f856ef18e58ebf8b9716d05" prefix=" " category="inline-code"></block> 以使用Ansul任 升级：</block>
  <block id="a94e8f341d41dc36ead41bc0876ad6b6" category="cell">i1b：100.127.101.1/16 i2b：100.127.102.1/16</block>
  <block id="3d1a3866e5aadfdac8b0e07e6740b0fe" category="cell">netapp_01</block>
  <block id="ceff1390fad555137a9e76549f5c5c35" category="cell">i2b：100.127.102.2/16 i1b：100.127.101.2/ 16</block>
  <block id="4261093cdb58c46bcef081c2a8d50a22" category="cell">i3b：100.127.101.3/16 i4b：100.127.102.3/ 16</block>
  <block id="ae9471dd5ddb2f7bbf73f8df6d11ea8d" category="cell">netapp_02</block>
  <block id="6a4b726f26d557d3d41580df69e5f52c" category="cell">i4b：100.127.102.4/16 i3b：100.127.101.4/ 16</block>
  <block id="3468e3b520debc18497bb043da48a402" category="cell">i1b：100.127.101.5/16 i2b：100.127.102.5/ 16</block>
  <block id="661d119659a3196ad4ea3cd776db51f9" category="cell">i2b：100.127.102.6/16 i1b：100.127.101.6/ 16</block>
  <block id="5e4915a0b5172fe24086c6612e459a18" category="cell">i3b：100.127.101.7/16 i4b：100.127.102.7/ 16</block>
  <block id="d4255115c2508bc18adb598c6fb0b827" category="cell">i4b：100.127.102.8/16 i3b：100.127.101.8/ 16</block>
  <block id="8d05d453ff97ca9e3418e1655244d8d5" category="cell">i1b：100.127.103.1/16 i2b：100.127.104.1/ 16</block>
  <block id="f012b1a2bc162eecafcb880e45d300b3" category="cell">i2b：100.127.104.2/16 i1b：100.127.103.2/ 16</block>
  <block id="92947a5a536c1c49f8a56988362e49f9" category="cell">i3b：100.127.103.3/16 i4b：100.127.104.3/ 16</block>
  <block id="0b566e0d0703bad78bbac23313f53279" category="cell">i4b：100.127.104.4/16 i3b：100.127.103.4/ 16</block>
  <block id="d424257a0c5e62d3b63dc54431955dbb" category="cell">i1b：100.127.103.5/16 i2b：100.127.104.5/ 16</block>
  <block id="261805237e27c4db09ed2709c5b4ee1d" category="cell">i2b：100.127.104.6/16 i1b：100.127.103.6/ 16</block>
  <block id="85dab52b55c7182f1c63b93086d2f9ba" category="cell">i3b：100.127.103.7/16 i4b：100.127.104.7/ 16</block>
  <block id="4c348e39f74a16c489df29edbf00971e" category="cell">i4b：100.127.104.8/16 i3b：100.127.103.8/ 16</block>
  <block id="aaaaf06756bef5b0c236a0c7e8a41d11" category="cell">i1b：100.127.101.9/16 i2b：100.127.102.9/ 16</block>
  <block id="017d565d10fb6b2886e9ca05b035e9a9" category="cell">netapp_03</block>
  <block id="39496d413f74d010a0d1b0c2e9ccce4e" category="cell">i2b：100.127.102.10/16 i1b：100.127.101.10/ 16</block>
  <block id="6a413ad3d1000df8b4efef19a8814dce" category="cell">i3b：100.127.2.1.1/16 i4b：100.127.102.11/16</block>
  <block id="c5c0f84cd4efb77f7e5e98b314d5b73f" category="cell">netapp_04</block>
  <block id="e9be3165e6fc46ba149605e78b46fa81" category="cell">i4b：100.127.102.12/16 i3b：100.127.101.12/ 16</block>
  <block id="f3f421c2e886c62a1aec7be061c685b2" category="cell">i1b：100.127.107.13/16 i2b：100.127.102.13/16</block>
  <block id="ed8c3ab02a44fc84902022ddcb5fabe8" category="cell">i2b：100.127.102.14/16 i1b：100.127.101.14/ 16</block>
  <block id="1920edec824c590f137b449a0443311a" category="cell">i3b：100.127.101.15/16 i4b：100.127.102.15/ 16</block>
  <block id="73a812d8e4ab9aeff521f90df25f5e23" category="cell">i4b：100.127.102.16/16 i3b：100.127.101.16/ 16</block>
  <block id="d3ff883be9e23adf4e03697eb2b136f5" category="cell">i1b：100.127.103.9/16 i2b：100.127.104.9/ 16</block>
  <block id="6db8aa9802df58c38910ed6abe1ba11e" category="cell">i2b：100.127.104.10/16 i1b：100.127.103.10/ 16</block>
  <block id="0e507490f78723195265893fc3dd4a5b" category="cell">i3b：100.127.103.11/16 i4b：100.127.104.11/ 16</block>
  <block id="32ac4e07dd77b430c6297e3e8799efd2" category="cell">i4b：100.127.104.12/16 i3b：100.127.103.12/ 16</block>
  <block id="f82dba07589e57dfcaf71442a7d0cd71" category="cell">i1b：100.127.103.13/16 i2b：100.127.104.13/ 16</block>
  <block id="39c7f24708288668c898771cebf44864" category="cell">i2b：100.127.104.14/16 i1b：100.127.103.14/ 16</block>
  <block id="28800e3773b860f61c7a9b36b316ed98" category="cell">i3b：100.127.103.15/16 i4b：100.127.104.15/ 16</block>
  <block id="ce02872e166a5cf80f50cd4385d0d192" category="cell">i4b：100.127.104.16/16 i3b：100.127.103.16/ 16</block>
  <block id="e8ed9c2d9c49ed0524af7cf1d12ba639" category="cell">i1b：100.127.103.17/16 i2b：100.127.104.17/ 16</block>
  <block id="63e36b5f8b91c5859b9a169198da7feb" category="cell">netapp_05</block>
  <block id="caf800dba53971258bebfcd9348ac486" category="cell">i2b：100.127.104.18/16 i1b：100.127.103.18/ 16</block>
  <block id="7b25c9239b1b161705c2cb1b81a33c4a" category="cell">i3b：100.127.103.19/16 i4b：100.127.104.19/ 16</block>
  <block id="b9fc71cc5ff86544747cf2b210fbab78" category="cell">netapp_06</block>
  <block id="41510e449bb0d73d0aa0a826b53e7866" category="cell">i4b：100.127.104.20/16 i3b：100.127.103.20/ 16</block>
  <block id="0b2d0578110fe19b63e28d0502beb0c8" category="cell">i1b：100.127.103.21/16 i2b：100.127.104.21/ 16</block>
  <block id="30b35cb26fde8fb49ebb562dd442913e" category="cell">i2b：100.127.104.22/16 i1b：100.127.103.22/ 16</block>
  <block id="864d7d5e08731a767f391f837e7ef23e" category="cell">i3b：100.127.103.23/16 i4b：100.127.104.23/ 16</block>
  <block id="2c1d9121314a70e0d2a2ba89aec6fc0e" category="cell">i4b：100.127.104.24/16 i3b：100.127.103.24/ 16</block>
  <block id="254542384d1213a7d51adea301584149" category="paragraph">P状态</block>
  <block id="50d1288a06e5d81d403b256e91757cd8" category="paragraph">除非另有说明、否则以下步骤对于集群中的每个组件都是相同的、无论该组件是同时用于运行BeeGFS元数据和存储服务、还是仅用于运行存储服务。</block>
  <block id="2420c82686a86123afa7fb56270ebdba" category="list-text">使用中指定的型号为每个BeeGFS文件节点设置四个主机通道适配器(HCAS) <block ref="786d34f336ab7f462feb4fe8776c8670" category="inline-link-macro-rx"></block>。根据以下规格将HCA插入文件节点的PCIe插槽：</block>
  <block id="655bb8c05d377bb94fdb062b9b431c69" category="list-text">*联想凌科系统SR6SR V3服务器：*使用PCIe插槽1、2、4和5。</block>
  <block id="79d10643d6c05fba16a1207303e6a6c0" category="list-text">*Lenovo ThinkSystem SR6SR服务器:*使用PCIe插槽2、3、5和6。</block>
  <block id="32bf9d61588971ac8df90b5b33ea1a67" category="paragraph">将组件装入机架、使两个BeeGFS文件节点位于BeeGFS块节点上方。下图显示了使用Lenovo ThinkSystem SR点 来作为文件节点的BeeGFS组件的正确硬件配置(后视图)。</block>
  <block id="43c3123c89f5e279387f5f5375ace233" category="inline-link-macro">1米InfiniBand HDR 200 GB直连铜缆</block>
  <block id="3c75c93f121f7b2c649fd946b1a935cf" category="list-text">使用连接块节点和文件节点 <block ref="c748126fd5b6f4c3728762b1ce9f2698" category="inline-link-macro-rx"></block>，使它们与下图所示的拓扑相匹配。</block>
  <block id="be01bbade44d01019fcef77af9fc26e5" category="inline-link-macro">2米InfiniBand缆线</block>
  <block id="df8ecd3c13ed9e59d88fa90e10bcc47f" category="list-text">使用特定于InfiniBand存储交换机的将文件节点上的其余InfiniBand端口连接到存储网络的InfiniBand交换机 <block ref="661a89e8980e34439324f4cc2c4b1743" category="inline-link-macro-rx"></block> 。</block>
  <block id="8e4e4dc9d710c035afcec16817c6b5a3" category="paragraph">在使用分路器缆线将存储交换机连接到文件节点时、应从交换机分支出一根缆线、并连接到浅绿色所示的端口。另一根分离器电缆应从交换机分支出来、并连接到深绿色所示的端口。</block>
  <block id="5059e1c6d859e6d2e881b28d0a939639" category="paragraph">此外、对于具有冗余交换机的存储网络、浅绿色端口应连接到一个交换机、而深绿色端口应连接到另一个交换机。</block>
  <block id="2b2607ba10759a35b672629d844a4bfc" category="paragraph">要应用NetApp E-Series清单中所述的配置，请使用在"Ansil得"集合中提供的各种"Ansil得"模块和角色，特别是部署端到端解决方案的BeeGFS HA 7.4角色(可从获取<block ref="e65da35b507a01fbe5db4a35e8ffaf77" category="inline-link-rx"></block>)。</block>
  <block id="a3dbff02e88e9e804d80d00706cede6c" category="paragraph">利用NetApp等公司可以在利用Ansilt Galaxy上的集合扩展内置功能(请参见<block ref="09c3689692686597c3ced866c6122b6c" category="inline-link-rx"></block>)。集合包括执行某些特定功能或任务(例如创建E系列卷)的模块、以及可以调用多个模块和其他角色的角色。这种自动化方法可减少部署BeeGFS文件系统和底层HA集群所需的时间。此外、它还简化了添加组件以扩展现有文件系统的过程。</block>
  <block id="8bf028bec7411a5f58e9f6c9cdcb868c" category="paragraph">以下步骤已在Ubuntu 22.04上进行了测试。有关首选Linux发行版的特定步骤，请参见<block ref="34c856f227a1cab1577af9d235784d24" category="inline-link-rx"></block>。</block>
  <block id="6beebf7e29f7e6b87bb0cfa8afb3d664" category="list-text">安装Python 3.10并确保已安装正确版本的<block ref="62ad1c2a46c5298f3e2c95d3babf8d0c" prefix=" " category="inline-code"></block> 。</block>
  <block id="e709eaee39c1c94ce2b784ef354857f3" category="list-text">创建符号链接、确保调用或时使用Python 3.10二进制文件<block ref="6e8efbe3a442748b716644025479aab5" prefix=" " category="inline-code"></block><block ref="23eeeb4347bdd26bfc6b7ee9a3b755dd" prefix=" " category="inline-code"></block> 。</block>
  <block id="0f7c31137702c2d677a474d55058637d" category="paragraph">要了解如何为经验证的联想SR点 对V3文件节点配置网络连接，请参阅<block ref="05277b4b7d004e546ac1f238e66dd4bf" category="inline-link-rx"></block>。</block>
  <block id="b8d06d76e2eaa67bfafbce3081ab48f5" category="list-text">安装Red Hat 9.3并配置用于管理操作系统的主机名和网络端口、包括来自Ansible控制节点的SSH连接。</block>
  <block id="7568449700f7c3e03b4500285c69b82f" category="list-text">使用RedHat订阅管理器注册和订阅系统，以便从Red Hat官方存储库安装所需的软件包，并将更新限制为受支持的Red Hat版本：<block ref="085c7e75df5d271759849f369fa065a7" prefix=" " category="inline-code"></block>。有关说明，请参阅<block ref="2e2e1be81972e19947d90393d5319b6e" category="inline-link-rx"></block> 和 <block ref="bbd834e2960f33a50fb102fd4d31a6d9" category="inline-link-rx"></block>。</block>
  <block id="00d3e1c43b2f440233b2874bbe49a236" category="list-text">将所有HCA固件更新为中建议的版本 <block ref="27ecbcefd12957257b84a6d4c5608591" category="inline-link-macro-rx"></block>。</block>
  <block id="313520f5b6c2887466092680afb5d057" category="paragraph">要完成此更新、可以下载并运行捆绑了建议固件的lxup工具版本。您可以从下载此工具<block ref="d22fd7ba0031fc3b862dce4cf129cfa5" category="inline-link-rx"></block> (<block ref="0efbaca172e58edf29b612ba47aac915" category="inline-link-macro-rx"></block>)。</block>
  <block id="b52d8b061d9ea3d197fbe8093a3eec3f" category="admonition">在使用分路器缆线将存储交换机连接到文件节点时、应使用一根缆线分支并连接到浅绿色所示的端口。另一根缆线应分支出来并连接到深绿色所示的端口。此外、对于具有冗余交换机的存储网络、浅绿色端口应连接到一个交换机、而深绿色端口应连接到另一个交换机。</block>
  <block id="dcc608d1c76fed74a96f75915bc6561f" category="paragraph">要利用完整的PCIe双向带宽、请确保每个InfiniBand适配器上的一个端口连接到存储网络结构、另一个端口连接到块节点。</block>
  <block id="0a31efbdaa47f7da5564c0e43b03e7ea" category="paragraph">您可以根据需要覆盖配置参数的默认设置。有关可针对特定工作负载或用例调整的参数，请参见<block ref="986eca0f3f99dd3e8d8640fddbc137d2" category="inline-link-rx"></block>。</block>
  <block id="11a09874ac1f09275ccc827cbc44353e" category="paragraph">有关可针对特定工作负载或用例调整的参数，请参见<block ref="0ea07919cef6ebe8518c59fc238308fd" category="inline-link-rx"></block>。</block>
  <block id="4d8ee2002969aa8084ace10838f40531" category="list-text">*安装在文件节点上的Linux操作系统中的系统设置。*您可以在的步骤4中创建Ands恢复 清单时覆盖默认的Linux操作系统系统设置 <block ref="dbbcb9482f49ee969cddb7f10864cbd0" category="inline-link-macro-rx"></block>。</block>
  <block id="f9a2fc1e1676d37df014ebfbdfa9a90d" category="paragraph">您可以增加NVIDIA HCA的最大读取请求大小。</block>
  <block id="163d5c0f8034e540888104ef4ded6727" category="list-text">*BeeGFS客户端多轨配置*_Multi-rail_是指应用程序使用多个独立网络连接(或称"导轨")来提高性能的能力。</block>
  <block id="8d2644ad58bcbab1442816a77a82fefb" category="paragraph">BeeGFS实施多轨支持、允许在一个IPoIB子网中使用多个IB接口。此功能可实现RDMA NIC之间的动态负载平衡等功能、从而优化网络资源的使用。它还与NVIDIA GPUDirect存储(GDS)相集成、可增加系统带宽、并降低客户端CPU的延迟和利用率。</block>
  <block id="992c3cb2d0c5be332151afe6ab4d5005" category="paragraph">本文档提供了有关单个IPoIB子网配置的说明。支持双IPoIB子网配置、但其优势与单子网配置不同。</block>
  <block id="2d861baf986f6a35c479d15a72c8284c" category="paragraph">HA集群设计基于两个广泛使用的Linux HA项目：用于集群成员资格的corosync和用于集群资源管理的Pacemaker。有关详细信息，请参见<block ref="0a03558b42ce04f55d37553193f6d76f" category="inline-link-rx"></block>。</block>
  <block id="9d550842e04b4f253a1d3e7bb3297890" category="paragraph">这些组件连接到两个NVIDIA qMTM InfiniBand (M8700)交换机。此外、还将10个BeeGFS客户端连接到InfiniBand交换机、并用于运行综合基准实用程序。</block>
  <block id="16e30c156c86a2bc6240a20ed7b6fdc4" category="section-title">NVIDIA DGX SuperPOD和BasePOD验证</block>
  <block id="40fa362dda8b4d271b61c38987bd5131" category="paragraph">NetApp使用一个类似的BeeGFS文件系统验证了用于NVIDIA DGX A100 SuperPOD的存储解决方案 、该文件系统由三个组件组成、并应用了元数据和存储配置文件。资格认定工作涉及使用20台DGX A100 GPU服务器测试此NVA所述的解决方案 、这些服务器运行各种存储、机器学习和深度学习基准。基于NVIDIA DGX A100 SuperPOD的验证、基于NetApp的BeeGFS解决方案已获得批准、可用于DGX SuperPOD H100、8200和B200系统。此扩展基于满足之前建立的基准和系统要求、并已通过NVIDIA DGX A100的验证。</block>
  <block id="21b6d1b90774505daa15a9be831436a9" category="inline-link-macro">设计指南</block>
  <block id="1cba1266f00c729aee1318803f870d22" category="list-text">该架构专为NVIDIA DGX SuperPOD A100、H100、H200和B200系统设计、之前已在NVIDIA的专用验收集群上进行过验证。有关采用NetApp的NVIDIA DGX SuperPOD的更多信息，请参见 <block ref="e98320202738eb339bebe66cbb05ad8f" category="inline-link-macro-rx"></block>。</block>
  <block id="10ca191b839b35e5100464ff59b95b97" category="paragraph">基于NetApp的第一代BeeGFS专为使用NetApp EF600 NVMe存储系统、BeeGFS并行文件系统、NVIDIA DGX™A100系统和NVIDIA®Mellanox®定量分析TM QM8700Gb/s IB交换机的机器学习(ML)和人工智能(AI)工作负载而设计。此设计还为存储和计算集群互连网络结构提供了200 Gb/秒InfiniBand (IB)、以便为高性能工作负载提供完全基于IB的架构。</block>
  <block id="aef5a6ba281c6919d0a3e3ff7d8feaf3" category="section-title">设计概述</block>
  <block id="a1d7af56cbcfca285cd257ae3430a2d3" category="inline-link-macro">架构概述</block>
  <block id="61dd8d13bec6e1ac3455eb2e13d61261" category="paragraph">基于NetApp的BeeGFS解决方案是一个可扩展的组件架构、可针对各种要求苛刻的工作负载进行配置。无论是处理多个小文件、管理大量大文件操作、还是混合工作负载、都可以对文件系统进行自定义以满足这些需求。高可用性内置在设计中、采用双层硬件结构、支持在多个硬件层进行独立故障转移、并确保性能稳定一致、即使在部分系统降级期间也是如此。BeeGFS文件系统支持在不同的Linux分发版之间实现高性能和可扩展的环境、并为客户端提供一个易于访问的存储命名空间。要了解更多信息，请访问 <block ref="45037eea1e64b480408f051dfe424a3c" category="inline-link-macro-rx"></block>。</block>
  <block id="bcaa6be52b9fd12687892056d441d7e4" category="paragraph">要实施基于NetApp的BeeGFS解决方案、请确保您的环境满足本文档中概述的技术要求。</block>
  <block id="7bf6b11b50ef88e180323b13813659d7" category="paragraph">开始之前、请确保您的硬件满足基于NetApp的BeeGFS解决方案的第二代组件设计的以下规格。根据客户要求、特定部署的确切组件可能会有所不同。</block>
  <block id="694e8d1f2ee056f98ee488bdc4982d73" category="cell">数量</block>
  <block id="d065c203a4b9103e8896c456d35cceea" category="paragraph">每个文件节点都应满足或超出建议文件节点的规格、以实现预期性能。</block>
  <block id="fbb1fad3a6f7d3538a8a1f8e9b6f1f08" category="paragraph">*建议的文件节点选项:*</block>
  <block id="5be994ecb912a7fb7448cc05f90afcf7" category="list-text">*Lenovo ThinkSystem SR国际 电脑公司</block>
  <block id="c0c1df1f325217c6fa04ce4c03ba875a" category="list-text">*处理器：* 2个AMD EPYC 9124 16C 3.0 GHz (配置为两个NUMA分区)。</block>
  <block id="e679361e60a219fe470d3ddb1f34a7d7" category="list-text">*内存：* 256 GB (16个16 GB TruDR5 4800MHz RDIM-A)</block>
  <block id="9946d99f0bd7932556af9646233dd2e8" category="list-text">*PCIe扩展：*四个PCIe Gen5 x16插槽(每个NUMA分区两个)</block>
  <block id="accd99f82c9ad3f026edd29ae4aaa9d8" category="list-text">在RAID 1中为操作系统配置两个驱动器(1 TB 7.2K SATA或更高)</block>
  <block id="c618fd1e9213f6ba6e4961e3d1165110" category="list-text">用于带内操作系统管理的1GbE端口</block>
  <block id="db812d54d604d8c71ffd5e4be563e3e5" category="list-text">采用Redfish API的1GbE BMC、用于带外服务器管理</block>
  <block id="15cf8b6d2674b1d9c9b0383ecfee8929" category="list-text">双热插拔电源和性能风扇</block>
  <block id="1e36a3ec484f8d613eabadcfb7010a41" category="paragraph">主机卡适配器因文件节点使用的服务器型号而异。针对经验证的文件节点的建议包括：</block>
  <block id="22d9c94f9f4ead6ee028aeb105c59845" category="list-text">*Lenovo ThinkSystem SR6SR V3服务器:*</block>
  <block id="6ea32d47808c9a0a8b4ad8ce7c3d46a8" category="list-text">MCX755106AS-热连接X-7、NDR200、QSFP112、双端口、PCIe Gen5 x16、 InfiniBand适配器</block>
  <block id="b74051cf2ad1a189f8a05453712ca47a" category="cell">存储网络交换机</block>
  <block id="abf33d394022ed774955ca8b4e892340" category="paragraph">存储网络交换机必须支持200 Gb/秒的InfiniBand速度。建议的交换机型号包括：</block>
  <block id="d7405c22a666ad0d0cb249c209ed8a2a" category="list-text">* NVIDIA QM9700昆特2 NDNS InfiniBand交换机*</block>
  <block id="8371ac7bb43cddb78635bb02c4ecf477" category="list-text">* NVIDIA MMM4700多模HDR InfiniBand交换机*</block>
  <block id="118d935cca54466f59122caecfde09ad" category="section-title">布线要求</block>
  <block id="1fe3c9d0657c143dd35fa09974da425b" category="cell">部件号</block>
  <block id="ba2a9c6c8c77e03f83ef8bf543612275" category="cell">长度</block>
  <block id="c3fc989bc0ee89bd4f833252b93ae9fc" category="cell">NVIDIA 1500-H001E30 (无源铜缆、QSFP56、200 GB/秒)</block>
  <block id="9859011cc78b3687689e719ce0d111a5" category="cell">1 个月</block>
  <block id="e71a6bc9da9d285c521501e596936972" category="cell">交换机型号</block>
  <block id="6fd115591b61cfe21f37443a0afb71e0" category="cell">电缆类型</block>
  <block id="0f0a45940e8946022b971d4ccdf6154e" category="cell">NVIDIA QM9700</block>
  <block id="a87ff679a2f3e71d9181a67b7542122c" category="cell">4</block>
  <block id="979ceabbdb73904b7beec8a0d58c32b8" category="cell">活动光纤</block>
  <block id="f629de18a131cfa25b9f36ef4690fc92" category="cell">无源铜线</block>
  <block id="f3b15dfb9c8e8d6298034f5cc32a59cd" category="cell">NVIDIA MqM8700</block>
  <block id="30657be0f3a2fdc8c171bce10af72efc" category="cell">MFS1S00-H003C (NVIDIA有源光纤电缆、InfiniBand 200Gb/秒、QFP56)</block>
  <block id="c1850fdcdcbbaf2fb48f3055382d5a41" category="cell">NVIDIA 1500-H002E26 (无源铜缆、InfiniBand 200Gb/秒、QSFP56)</block>
  <block id="0db451285b4ab90f8e6012dfd8f0d190" category="paragraph">具有高可用性的RedHat 9.3 Server物理服务器(双插槽)。</block>
  <block id="099646c88bdb63cce0ec389f4c842fed" category="cell">5.14.0-362.24.1.el9_3.x86_64</block>
  <block id="de4e152f23f311bbd0da3bd3cc07390d" category="cell">MLNR_OFED_LINUX-23.10-3.2.0.2-LTS</block>
  <block id="8c21a74db8c25bd18866fe78a889642f" category="paragraph">HCA固件</block>
  <block id="141a8d7da406be785ba26084a46e1c00" category="cell">7.4.4</block>
  <block id="5487c77147bdac492714cd2896a16557" category="cell">通过pip安装时为6.x：Ansight-6.0.0和Ansight-core &gt;= 2.13.0</block>
  <block id="b1e65a5d34a577630a4fc7840358333f" category="cell">3.9 (或更高版本)</block>
  <block id="1f6e93b1ea11aa12e871822a2cabfc76" category="cell">加密法-43.0.0、netaddr-1.3.0、ipaddr-2.2.0</block>
  <block id="7af6b9890b6c8ce699616c59f48b5248" category="cell">NetApp E-Series BeeGFS折叠资料集</block>
  <block id="070afde0274dc6039a8a8949d12a15cd" category="cell">3.2.0</block>
  <block id="ddc7c5e85c28111eae39eef12269daf4" category="inline-link-macro">使用自定义架构</block>
  <block id="a33f0af0b0b4566b693084a9b90c220b" category="paragraph">向集群添加组件时、您需要<block ref="3342582e194d63e4c91b56623752c9c6" prefix=" " category="inline-code"></block>为每个新文件节点和块节点(E-Series阵列)创建文件。需要将这些主机的名称以及要创建的新资源添加到清单中。<block ref="96fa973cda8809ad84f646e3d8fbbc1c" prefix=" " category="inline-code"></block>需要为每个新资源创建相应的文件。<block ref="46924488f50abe82484adb9bfcdcde3b" category="inline-link-macro-rx"></block>有关详细信息、请参见一节。</block>
  <block id="a9e2fb24cfaef729e583ffb43f910760" category="paragraph">如果节点发生硬件或其他故障、HA集群应自动做出响应并将其服务移动到运行正常的节点、以便管理员有时间采取更正操作。在继续操作之前、请参考<block ref="9f376b3ee66d4a4a484e850809b96601" category="inline-link-macro-rx"></block>一节以确定故障转移的原因并解决任何未解决的问题。在节点重新启动并运行正常后、您可以继续执行故障恢复。</block>
  <block id="d97281ea1240a72da4b3d700493296c1" category="paragraph">虽然其中一些概念已在主<block ref="aeb2367c8b6e8485692304c0f57562a5" category="inline-link-macro-rx"></block>页上介绍、但在BeeGFS HA集群环境中重新介绍它们会很有帮助：</block>
  <block id="9faa71c9a363d883afdd567d859ce5b2" category="paragraph">**维护模式：**禁用所有资源监视，并阻止PacMaker移动或以其他方式管理群集中的资源(另请参见上的一节<block ref="bcf91b88f4600ab15eefb2c3b749ba9b" category="inline-link-macro-rx"></block>)。</block>
  <block id="9ce95feb3853f5a2e43ca0d15f2341bd" category="paragraph">通常、要重新配置BeeGFS HA集群的任何方面、都应更新您的Ansient清单并重新运行<block ref="6afa1ad605a4192ba2e50e8be9966e68" prefix=" " category="inline-code"></block>命令。其中包括更新警报、更改永久隔离配置或调整BeeGFS服务配置。这些<block ref="4003590e6e5408f8e5272e50f909dfac" prefix=" " category="inline-code"></block>选项可使用文件进行调整、可在<block ref="dc7fd2b3ea1b2b4a060b953a1b281371" category="inline-link-macro-rx"></block>部分中找到完整的选项列表。</block>
  <block id="1b8fa8fe7d656db42e80d5a6ce645ec8" category="paragraph">也可以在单个节点上停止集群(这会自动将服务故障转移到另一个节点)、但建议首先将该节点置于备用状态(请参见<block ref="a588c352114ff4abc3bdc2aa2fbe7c6e" category="inline-link-macro-rx"></block>一节)：</block>
  <block id="5b359307b8bd7b288c8e5b703cdf97d4" category="paragraph">如果运行BeeGFS服务所需的资源发生故障、BeeGFS监控器将触发故障转移。如果发生这种情况，底部可能不会列出“失败的资源操作”<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block>，您应参阅有关如何操作的步骤<block ref="0a749dc3cd00487c17b8cc6492fb44ee" category="inline-link-macro-rx"></block>。</block>
  <block id="3a06f222be74df90b61af2d3590f53fb" category="doc">更新BeeGFS版本</block>
  <block id="fb7db280dc24f798821f72f3a6314baa" category="paragraph">请按照以下步骤使用Ansient更新HA集群的BeeGFS版本。</block>
  <block id="de08fe25e6d2fa4fb114dee71c6d1955" category="paragraph">BeeGFS采用<block ref="95d209426d2bead51bc37b6066b6ee21" prefix=" " category="inline-code"></block>版本控制方案。每个受支持的<block ref="708997fbc70843c52165e3f6faed4fa8" prefix=" " category="inline-code"></block>版本(例如<block ref="4111d90a1d8089aa9621c399414fd198" prefix=" " category="inline-code"></block>和<block ref="7bfdf60ffcc8e818739972660aeebf71" prefix=" " category="inline-code"></block>)都提供了BeeGFS HA Ansient角色。每个HA角色都固定为在发布此Ansient集合时提供的最新BeeGFS修补程序版本。</block>
  <block id="901381f9137ae0a8db99e41924ff8ef1" category="section-title">已测试升级路径</block>
  <block id="ee70a4cf48b74ec6f64d87c6e1480515" category="section-title">BeeGFS升级步骤</block>
  <block id="079cd431e62fc3a22940a2261f836245" category="paragraph">以下各节介绍了更新BeeGFS的Ansient集合和BeeGFS本身的步骤。请特别注意更新BeeGFS主要或次要版本的任何额外步骤。</block>
  <block id="2cdd3511031afa1a313d8e79d7d576b1" category="section-title">第1步：升级BeeGFS集合</block>
  <block id="f6abfd633f96f44e32dca944a1a80e9c" category="section-title">第2步：更新Ands处理 清单</block>
  <block id="95172f30ff12c9cb640f1c8398d0b04a" category="paragraph">对集群的Ansible清单文件进行任何必要或所需的更新。<block ref="2e381baad9ceebe6c5aa505098cb18a1" category="inline-link-macro-rx"></block>有关特定升级要求的详细信息、请参见以下部分。<block ref="f7bda10e421919e9d8ced89dacaba34f" category="inline-link-macro-rx"></block>有关配置BeeGFS HA清单的常规信息、请参见一节。</block>
  <block id="de129d7813d91b8a2df6987dc1e993c1" category="section-title">第3步：更新《Ands维修 手册》(仅在更新主要或次要版本时)</block>
  <block id="ee7f4ebf4b84c588316192566a0cb8cd" category="paragraph">有关此播放手册文件内容的更多详细信息、请参见<block ref="e4439ff10fb632bb30fbb98653fb7d05" category="inline-link-macro-rx"></block>一节。</block>
  <block id="21c4f9c8b31954d3a790c8c8be86b9c8" category="section-title">第4步：运行BeeGFS升级</block>
  <block id="9c8627d3001e5a503b31e4dcd6ecfd87" category="section-title">版本升级说明</block>
  <block id="909565cc470ef2ebeaadbdc37ace1c46" category="section-title">对基于连接的身份验证进行的更改</block>
  <block id="cd35a558180e5a60f1da5ebd80b06ed2" category="paragraph">有关其他详细信息和备用配置选项、请参见<block ref="dc7fd2b3ea1b2b4a060b953a1b281371" category="inline-link-macro-rx"></block>一节中配置连接身份验证的步骤。</block>
  <block id="8d4ce44e7e1f685f22f0480066f6dadc" category="summary">升级HA集群的E-Series存储阵列的步骤。</block>
  <block id="fecb4be6b37a9fda6b207eaf97363fed" category="doc">升级E-Series存储阵列</block>
  <block id="40039e282631364c07ceaedf99c2cf6c" category="admonition">虽然可以在HA集群联机的情况下升级存储阵列、但建议在进行所有升级时将集群置于维护模式。</block>
  <block id="e23311179b5a9fe1039e35e28290b482" category="section-title">块节点升级步骤</block>
  <block id="4a77379e9fcc01e35b7933a91b02a2bb" category="inline-link-macro">升级注意事项</block>
  <block id="46b8f258a80b91c5c4fffd3d5ece01a4" category="paragraph">以下步骤概述了如何使用<block ref="e49e2f9371e7bc22ee200e5f75b6602c" prefix=" " category="inline-code"></block>Ands得以 收集来更新存储阵列的固件。在继续操作之前、请查看<block ref="6c9178c1392ea3672f35be0055264c17" category="inline-link-macro-rx"></block>以更新E-Series系统。</block>
  <block id="bdee1b73e1febbf048ec6a5f2831e85b" category="admonition">只能从11.70.5P1升级到SANtricity OS 11.80或更高版本。在应用进一步升级之前、必须先将存储阵列升级到11.70.5P1。</block>
  <block id="d71cc28583686cddef55d03b0274281d" category="list-text">验证您的SANtricity控制节点是否正在使用最新的Ants解决 方案集合。</block>
  <block id="958b4e178dbb15f4d101c7af076a86e0" category="list-text">对于脱机升级，请从下载收集tarball<block ref="32839d1e65aead10794a1c6916b9ba54" category="inline-link-macro-rx"></block>，将其传输到控制节点，然后执行：</block>
  <block id="b7c167ccf3ed53b1f6e48097aeff0a80" category="list-text">为存储阵列和驱动器获取最新固件。</block>
  <block id="b48447584775163c7687f535f818de69" category="list-text">下载固件文件。</block>
  <block id="9c093f14319e8253b8c9b37290597239" category="inline-link-macro">NetApp 支持站点</block>
  <block id="8730ba85a04b4b9309e2eb5e8255e024" category="list-text">* SANtricity OS和NVSRAM:*导航到<block ref="a9f7476d3f84cd9adf0af429b2aa178f" category="inline-link-macro-rx"></block>并下载适用于您的存储阵列型号的SANtricity OS和NVSRAM:的最新版本。</block>
  <block id="482a1edf3e9cd198f6ee458a1cea1af9" category="inline-link-macro">E-Series磁盘固件站点</block>
  <block id="bad7f30f1449c1f5ab5e97ce89aee762" category="list-text">*驱动器固件：*导航到<block ref="dc6c914f008159d5969a25304ddfb479" category="inline-link-macro-rx"></block>并下载每个存储阵列驱动器型号的最新固件。</block>
  <block id="c26b41b932786e55f3bf481a6938083e" category="list-text">将SANtricity操作系统、NVSRAID和驱动器固件文件存储在您的Ans负责人 控制节点的<block ref="971398284b1e828e40efc6b6630f0369" prefix=" " category="inline-code"></block>目录中。</block>
  <block id="09a777fce4515aa1a8dcd86346441924" category="list-text">如有必要、请更新集群的"Andsess"清单文件、以包括所有需要更新的存储阵列(块节点)。有关指导、请参见<block ref="f7bda10e421919e9d8ced89dacaba34f" category="inline-link-macro-rx"></block>一节。</block>
  <block id="f525483091b48c05e08ecf537a6c9e5a" category="list-text">按照中的说明将集群置于维护模式<block ref="4b8504199df3a0ade85c92603634e18f" category="inline-link-macro-rx"></block>。</block>
  <block id="390c5fa21f5dea398732a7b3b4024304" category="list-text">创建一个名为的新的Ands要 用手册<block ref="bdc450c9ffd9674cb7c88bcb24bfedb8" prefix=" " category="inline-code"></block>。使用以下内容填充此操作手册、将SANtricity操作系统、NVSAN并 将驱动器固件版本更换为所需的升级路径：</block>
  <block id="13ec6a1291f9e3d303bbc7f6bece60a3" category="list-text">要启动更新、请从您的Andsute控制节点执行以下命令：</block>
  <block id="2268e1bfefae0c28c267b29923d65e0c" category="list-text">完成该操作手册后、验证每个存储阵列是否处于最佳状态。</block>
  <block id="c1fdae9b6a94c3924447ee6c483855cb" category="list-text">将集群移出维护模式、并验证集群是否处于最佳状态、并且每个BeeGFS服务都位于其首选节点上。</block>
  <block id="3ad9625708cd0c96f347ec4ce5d874d3" category="list-text">自BeeGFS 7.2.7和7.3.1起<block ref="770c4b58b3b364c4ac52cf5cc555453f" category="inline-link-macro-rx"></block>、必须配置或显式禁用。根据您在指定时选择配置基于连接的身份验证<block ref="8920d94093ad4ef03a0a5d6b5041695b" category="inline-link-macro-rx"></block>的方式，您可能需要调整客户端配置：</block>
  <block id="98ef1fa853194aa97ce7e1d48795cef5" category="admonition">每个受支持的BeeGFS主要版本都会保留一个BeeGFS HA角色。这样、用户可以选择何时升级主要/次要版本。目前<block ref="b8974e83e3e52aff89dd9fef2fd40433" prefix="(" category="inline-code"></block><block ref="a89433e176d102073aaa272a94fc99a0" prefix="(" category="inline-code"></block>支持BeeGFS 7.3.x或BeeGFS 7.2.x。默认情况下、这两个角色将在发布时部署最新的BeeGFS修补程序版本、但用户可以选择覆盖此修补程序、并根据需要部署最新的修补程序。<block ref="ea68a501eb5a456f305896d5a2358bdb" category="inline-link-macro-rx"></block>有关详细信息、请参见最新版本。</block>
  <block id="3a08f340332ef25464a2e7b7cfe7f232" category="paragraph">指定时<block ref="8920d94093ad4ef03a0a5d6b5041695b" category="inline-link-macro-rx"></block>，如果选择默认选项让Ansound自动管理基于连接的身份验证，则<block ref="6097b6e95af2579f2147a330c21f7b59" prefix=" " category="inline-code"></block>可在<block ref="8e9df790452dc085676f10b7754aa94b" prefix=" " category="inline-code"></block>(默认情况下)中找到用作共享密钥的。任何需要访问文件系统的客户端都需要使用此共享密钥。如果使用配置客户端，则会自动处理此<block ref="a5e865a21fc7e89f99d76e47a99103f5" category="inline-link-macro-rx"></block>问题。</block>
  <block id="7e96a3522e757b7c2f84f96e80a5204a" category="list-text">与此<block ref="4b612fd25b54d8125236d973922744dd" category="inline-link-macro-rx"></block>项目允许用户部署/维护整个Kubirnetes分发版以实现横向扩展计算基础架构的方式类似。</block>
  <block id="8de8ee53c552f1f6dd7babfe6c53c01d" category="list-text">使用IOR和MDTest等性能基准测试工具验证文件系统性能是否满足预期。有关BeeGFS的常见测试和参数示例、请参见<block ref="a0a81c919707a85f36fb8f6f519c1f93" category="inline-link-macro-rx"></block>经验证的NetApp架构上的BeeGFS一节。</block>
  <block id="d27d0d9d916f3c0f77ce2785848cb725" category="paragraph">创建一个新文件<block ref="096c36ebf1ab8bf90e099d6808eb57d0" prefix=" " category="inline-code"></block>并引用该<block ref="b777967ae458ad80005c5e1730bd996c" category="inline-link-macro-rx"></block>部分、按如下所示填充该文件：</block>
  <block id="245b1bd598314a0a050725e4c5d97c78" category="list-text">卷大小应指定为存储池/卷组的百分比、并且使用特定存储池/卷组的所有服务/卷的总数不应超过100。注意使用SSD时、建议在卷组中保留一些可用空间、以最大程度地提高SSD性能和使用寿命(单击可<block ref="16def06e05414fadffd7f5aab36ffa19" category="inline-link-macro-rx"></block>了解更多详细信息)。</block>
  <block id="884a1a74c4254f0e663282849a218050" category="paragraph">参考<block ref="b777967ae458ad80005c5e1730bd996c" category="inline-link-macro-rx"></block>部分、<block ref="3ffe66d0860049a5a100c385493d4997" prefix=" " category="inline-code"></block>为集群中的每个元数据服务创建一个位于的文件、然后按如下所示填充它们：</block>
  <block id="bbadc58dfee849a3a02be97243b97990" category="paragraph">参考<block ref="b777967ae458ad80005c5e1730bd996c" category="inline-link-macro-rx"></block>部分、<block ref="a16ac980b359b788a73d8add9202cc6f" prefix=" " category="inline-code"></block>为集群中的每个存储服务创建一个文件、然后按如下所示填充它们：</block>
  <block id="3061d639cb074dd9a1f3c7d24d061d94" category="list-text">根据<block ref="b777967ae458ad80005c5e1730bd996c" category="inline-link-macro-rx"></block>指定此文件系统的BeeGFS管理IP部分：</block>
  <block id="5a89b4f80128d0b3669b1564943cd510" category="paragraph">如果块节点和文件节点使用InfiniBand直接连接、<block ref="d21519b2c7af8ce90e382199384a8c06" prefix=" " category="inline-code"></block>则必须在每个文件节点上为直接连接到块节点的每个接口配置一个实例。通过指定<block ref="a983fd54df8f83bdfdc5756fe288aa56" prefix=" " category="inline-code"></block>时间来完成此<block ref="9a73a9f8352cf6494b7d5bc6c3eb6d0a" category="inline-link-macro-rx"></block>操作。</block>
  <block id="5c823b437a4fc165b3349c1455412d2b" category="list-text">使用cURL或所需工具、将NVIDIA网站上部分中列出的OpenSM版本的软件包下载到目录中 <block ref="178d97073525b373723b8dda031e8548" category="inline-link-macro-rx"></block><block ref="4d67f7bc650c0237a4f14903bb4e32de" prefix=" " category="inline-code"></block> 。例如：</block>
  <block id="fa90fb024c68aeaa307b3486cdb0811c" category="paragraph">请参考<block ref="b777967ae458ad80005c5e1730bd996c" category="inline-link-macro-rx"></block>本节中定义的IP寻址方案、为集群中的每个块节点创建一个文件<block ref="9a669560bf11c3e8770f91d615f47c78" prefix=" " category="inline-code"></block>并按如下所示进行填充：</block>
  <block id="54e21e619ebcd2038cbf6ad99bac975f" category="paragraph">请参考<block ref="d83d5464c6c0dbe0203869281fc21d2b" category="inline-link-macro-rx"></block>本节中定义的IP寻址方案、为集群中的每个文件节点创建一个文件<block ref="29c5616b1b8c32726b3152860a451439" prefix=" " category="inline-code"></block>并按如下所示进行填充：</block>
  <block id="3c51eceddcbfbb08a09bb39a9f19e117" category="paragraph"><block ref="3c51eceddcbfbb08a09bb39a9f19e117" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8ea6cc14c3361efc3a01a352f7d8b097" category="admonition">本节中使用的术语定义可在<block ref="aeb2367c8b6e8485692304c0f57562a5" category="inline-link-macro-rx"></block>页面上找到。</block>
  <block id="7a5c5ebabde54389985d3b9fadd7b425" category="paragraph">虽然<block ref="4d27806b9f70cbf03b3483248ec7d7bc" category="inline-link-macro-rx"></block>提供了预定义的参考配置和规模估算指导、但某些客户和合作伙伴可能更愿意设计更适合特定要求或硬件首选项的自定义架构。在NetApp上选择BeeGFS的主要优势之一是、能够使用Ansible部署BeeGFS共享磁盘HA集群、从而简化集群管理、并通过NetApp编写的HA组件提高可靠性。在NetApp上部署自定义BeeGFS架构仍可使用Ansible来完成、从而在一系列灵活的硬件上保持类似设备的方法。</block>
  <block id="ab2a4abcb79fad270532717ca3427f92" category="paragraph">本节概述了在NetApp硬件上部署BeeGFS文件系统以及使用Ansible配置BeeGFS文件系统所需的常规步骤。有关设计BeeGFS文件系统的最佳实践和优化示例的详细信息、请参见<block ref="4d27806b9f70cbf03b3483248ec7d7bc" category="inline-link-macro-rx"></block>一节。</block>
  <block id="30de48a7127295863f5f215fde6c08ca" category="paragraph">有关标准约定、最佳实践和填写的示例工作表的详细信息、请参阅<block ref="28bbc43b20c819953a71af93d1c4e109" category="inline-link-macro-rx"></block><block ref="4d6b3e482c415f3bd4b50893909bd85e" category="inline-link-macro-rx"></block>NetApp经验证的架构上BeeGFS的和部分。</block>
  <block id="09b6dc0fcffa0dde65b5a3c6c13023a3" category="list-text">满足<block ref="a141ba9ea027408279c2684d8c781c5d" category="inline-link-macro-rx"></block>BeeGFS HA角色的要求、包括已安装的Ansient、Python版本以及任何其他Python软件包。</block>
  <block id="7007891572e5a419add36531fb5f1be8" category="paragraph">有关详细的安装步骤，请参见<block ref="29286ffa550e08bdb3d9fa0a0be38f68" category="inline-link-macro-rx"></block>。</block>
  <block id="2acc893838b1eb90d1c84b809a236835" category="inline-image-macro">组件示例</block>
  <block id="0cf0e609964c9930dfcd66ad6ffe8361" category="paragraph"><block ref="0cf0e609964c9930dfcd66ad6ffe8361" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ea853e91a86a86cbc9cea1e039d6ec17" category="inline-image-macro">BeeGFS部署示例</block>
  <block id="92bf56a169d86e418f4a78aaaf5a3153" category="paragraph"><block ref="92bf56a169d86e418f4a78aaaf5a3153" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2701ff78b7eb357effebb637477114b8" category="paragraph">通常、您会将E系列块节点的HIC端口直接连接到文件节点的指定主机通道适配器(对于InfiniBand协议)或主机总线适配器(对于光纤通道和其他协议)端口。建立这些连接的确切方法取决于所需的文件系统架构，下面是一个示例<block ref="48bff068417bb27c10f3ddce61de14e9" category="inline-link-macro-rx"></block>：</block>
  <block id="d280e44616dd9cb363292987ea8c1939" category="inline-image-macro">示例BeeGFS文件到块节点的布线</block>
  <block id="c2ad0d9a44428ac4772ec872090c3da7" category="paragraph"><block ref="c2ad0d9a44428ac4772ec872090c3da7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="85180c66af01717bf125dc82f4f1ed53" category="inline-image-macro">BeeGFS客户端布线示例</block>
  <block id="4864e5d5de47684fb9038e0ef5afff80" category="paragraph"><block ref="4864e5d5de47684fb9038e0ef5afff80" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ccb84ec92fe82c0d6ab0a55f23e3eb17" category="paragraph">使用系统设置(BIOS/UEFI)界面、确保设置为最大程度地提高性能。确切设置和最佳值将因所使用的服务器型号而异。提供了有关的指导<block ref="5f1c2d149eae40e1322e9fafa3998295" category="inline-link-macro-rx"></block>，否则请参阅服务器供应商的文档和基于您的型号的最佳实践。</block>
  <block id="db2fad664adc100829ebfbffc137527d" category="paragraph">根据列出的文件节点要求安装受支持的操作系统<block ref="9e16c2314a033d11f0704d539a894ebf" category="inline-link-macro-rx"></block>。根据您的Linux版本、请参见以下任何其他步骤。</block>
  <block id="f2cf78e0d1f7ad85dcd842faf7ac4515" category="paragraph">确保所有HBA和HCA均运行上列出的受支持固件版本<block ref="8b59326e9a63a3b8d68c843e238b964b" category="inline-link-macro-rx"></block>、并在必要时进行升级。有关NVIDIA ConnectX适配器的其他建议，请参见<block ref="9e16c2314a033d11f0704d539a894ebf" category="inline-link-macro-rx"></block>。</block>
  <block id="8a537f7e0401508a2313fc508d89890f" category="admonition"><block ref="4aaa57a471c2a91096648d10c36a27be" category="inline-link-macro-rx"></block>有关特定于与BeeGFS高可用性(HA)集群交互的术语和概念的更多详细信息、请参见一节。</block>
  <block id="ea56ba40e3c5a9cd92e8f51ccb6c3ae4" category="inline-image-macro">BeeGFS组件</block>
  <block id="6097578a9c3bfa602c1e755a66ade1ab" category="paragraph"><block ref="6097578a9c3bfa602c1e755a66ade1ab" category="inline-image-macro-rx" type="image"></block></block>
  <block id="09642005b99405e19fa67b3689b21ee7" category="inline-image-macro">HA架构比较</block>
  <block id="ea01fc482ace12597c68d8d51d799253" category="paragraph"><block ref="ea01fc482ace12597c68d8d51d799253" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fdd0fa6524b4c92bc95af5176461013e" category="inline-image-macro">组件</block>
  <block id="2282ea06676d9a4cf9ddadaa654d14b1" category="paragraph"><block ref="2282ea06676d9a4cf9ddadaa654d14b1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5523e74e8cf94c323e9b7dc4c2bb722b" category="inline-image-macro">BeeGFS HA集群扩展</block>
  <block id="d52adc3743c104eeb589c42277ff0c59" category="paragraph"><block ref="d52adc3743c104eeb589c42277ff0c59" category="inline-image-macro-rx" type="image"></block></block>
  <block id="83b5e8063fa9a23613c6fe11336c236a" category="paragraph"><block ref="83b5e8063fa9a23613c6fe11336c236a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="32105fac7897c11e56236a163fa6d971" category="inline-image-macro">EF600驱动器插槽</block>
  <block id="a2df183adc09aa68cc267d7f30848e40" category="paragraph"><block ref="a2df183adc09aa68cc267d7f30848e40" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9c5c72057491d0a5ae89a71dfa3f18ec" category="inline-image-macro">SR665V3直连布线</block>
  <block id="91b0007e09ff2fa20716b9ee1e611eb4" category="paragraph"><block ref="91b0007e09ff2fa20716b9ee1e611eb4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e501a80fb52b2df8a7a16f92da9b76b2" category="inline-image-macro">存储网络布线</block>
  <block id="3f713ba1926971f2cec8152bf5b64825" category="paragraph"><block ref="3f713ba1926971f2cec8152bf5b64825" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3e555d7998b255ac574c6430c2d9eaf6" category="inline-image-macro">高容量机架图</block>
  <block id="5c4a48e1bba2d7e97a5afb3329da8750" category="paragraph"><block ref="5c4a48e1bba2d7e97a5afb3329da8750" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ab0440e4421843b823481ec8c40114fa" category="inline-image-macro">高容量驱动器插槽示意图</block>
  <block id="d471943365921fcc3ec56d2cb62b204d" category="paragraph"><block ref="d471943365921fcc3ec56d2cb62b204d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ce0bc242efa1f7752857cac8fae4d239" category="admonition">尤其是对于大型部署、<block ref="448725115a83c589b33de77889e1e2f3" prefix=" " category="inline-code"></block>建议使用参数覆盖默认的分叉数(5)、以增加Ans可 并行配置的主机数量。(有关详细信息，请参阅<block ref="2f92d47aead0a3ef15304d32faf6a032" category="inline-link-rx"></block>。)最大值设置取决于可变控制节点上可用的处理功率。以上示例20是在具有4个CPU (Intel (R) Xeon (R) Gold 6146 CPU @ 3.20GHz)的虚拟Ansible控制节点上运行的。</block>
  <block id="e5e317ea18fb59bd91370981078a2eb6" category="inline-image-macro">NUMA配置</block>
  <block id="b69049bad10aec8bac8579c94488a401" category="paragraph"><block ref="b69049bad10aec8bac8579c94488a401" category="inline-image-macro-rx" type="image"></block></block>
  <block id="12316ea7d4573c51756ec0fb8fe2d354" category="inline-image-macro">网络布线</block>
  <block id="f8e0ca3438f30328dc02a59212533e4b" category="paragraph"><block ref="f8e0ca3438f30328dc02a59212533e4b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dfc8d818052af4f5e6b27ab14809f648" category="inline-image-macro">HCA双向带宽</block>
  <block id="109f376ab71650e10de73ac118faa1cf" category="paragraph"><block ref="109f376ab71650e10de73ac118faa1cf" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4761409fb0a2290e1a6a09381da73347" category="inline-image-macro">接口流量平衡</block>
  <block id="04e97962e6bb1a104f48fbc1086830e4" category="paragraph"><block ref="04e97962e6bb1a104f48fbc1086830e4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="26b17225b626fb9238849fd60eabdf60" category="paragraph">+</block>
  <block id="bbd50c1c67920eb714a77de6085a1da7" category="inline-image-macro">EF600阵列</block>
  <block id="77ab09336108b97d55d660c37ecfa138" category="paragraph"><block ref="77ab09336108b97d55d660c37ecfa138" category="inline-image-macro-rx" type="image"></block></block>
  <block id="aa24db2ee9f316acbbbfcc348aff2139" category="inline-image-macro">BeeGFS服务卷所有权</block>
  <block id="81722745ad5693a2c53cb7fd80ef42cd" category="paragraph"><block ref="81722745ad5693a2c53cb7fd80ef42cd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a0db15ba7734a2f0bd68d8f7ec6da53b" category="inline-image-macro">起搏器控制器服务</block>
  <block id="633cadaf9644bd4072214489980f4de0" category="paragraph"><block ref="633cadaf9644bd4072214489980f4de0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="08193bfb92c50dc5860e0ae7ab70b8de" category="inline-image-macro">BeeGFS验证配置</block>
  <block id="d4d7c2778d639ee21874e3a533b4cb45" category="paragraph"><block ref="d4d7c2778d639ee21874e3a533b4cb45" category="inline-image-macro-rx" type="image"></block></block>
  <block id="25362da3867ffd1fb6b8e5946bb60770" category="inline-image-macro">单个BeeGFS基本组件IOL结果</block>
  <block id="815be59c5f2e9977f869e63692f4c698" category="paragraph"><block ref="815be59c5f2e9977f869e63692f4c698" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5ceb441734022db46316b9560c287a7f" category="inline-image-macro">单个BeeGFS元数据和存储组件IOL结果</block>
  <block id="2fd2e54693b2c76f97569df889a592fd" category="paragraph"><block ref="2fd2e54693b2c76f97569df889a592fd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bc75db64efedca0861be31efc710d385" category="inline-image-macro">单个BeeGFS存储IOL结果</block>
  <block id="7f73d3737f911cd518afbf2c214c0c64" category="paragraph"><block ref="7f73d3737f911cd518afbf2c214c0c64" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d63d6ac704b4d61d17ece2c0612e08f5" category="inline-image-macro">BeeGFS的三个组件IOL结果</block>
  <block id="9c28704420f2090ce57c2e671f191dc0" category="paragraph"><block ref="9c28704420f2090ce57c2e671f191dc0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e5910bdf77b7103e1d2c0a93d4c49fc8" category="inline-image-macro">具有单个客户端IOL结果的三个BeeGFS组件</block>
  <block id="f496e88262c7c32001b4a84ce3febf98" category="paragraph"><block ref="f496e88262c7c32001b4a84ce3febf98" category="inline-image-macro-rx" type="image"></block></block>
  <block id="09033d0c41b9b8aab0f364b81b9c69b3" category="inline-image-macro">单个BeeGFS元数据和存储组件MDTest结果</block>
  <block id="9a0ca14324a0c9493b33cc5efdcf3460" category="paragraph"><block ref="9a0ca14324a0c9493b33cc5efdcf3460" category="inline-image-macro-rx" type="image"></block></block>
  <block id="362973e7a4fa534a7db69e8dfa0877a8" category="inline-image-macro">两个BeeGFS元数据和存储组件MDTest结果</block>
  <block id="070cfbe37786e49518755132f73ded2c" category="paragraph"><block ref="070cfbe37786e49518755132f73ded2c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e40e4e443af5090e1039aebba0a6cd24" category="paragraph">BeeGFS文件节点</block>
  <block id="05323ece1df24d4488db57fd326597c0" category="cell">E-Series块节点(EF600阵列)</block>
  <block id="06fc3bd2748fbbf8f16ce893ede22214" category="paragraph">*内存：* 256 GB (每个控制器128 GB)。*适配器：* 2端口200GB/HDR (NVMe/IB)。*驱动器：*配置为匹配所需元数据和存储容量。</block>
  <block id="1e3cea12222d4b63badbe998ef00b55d" category="cell">InfiniBand主机卡适配器(适用于文件节点)。</block>
  <block id="0594ef398f6882c7d1d98994e3906850" category="paragraph">*从块节点直接连接到文件节点。*</block>
  <block id="b38917fef1efbb1471841f7a026c98c3" category="paragraph">*从文件节点连接到存储网络交换机。*根据您的InfiniBand存储交换机、从下表中选择适当的缆线选项。+建议的电缆长度为2米；但是、这可能会因客户环境而异。</block>
  <block id="a00d274d551f6b74718d44ea2bb6e6c3" category="sidebar">更新HA集群组件</block>
  <block id="67f62a9c37bde591abc850b5a2b22b02" category="list-text">为集群密码创建子目录，并通过使用Ans可 存储对文件进行加密来保护文件(请参见<block ref="69d38d4b5deda302461f6461c5317006" category="inline-link-rx"></block>)：</block>
  <block id="8e7f7bdc10cb596910cce6b79c2e2ed6" category="list-text">创建子目录<block ref="fc7cb0a7b647c6ff35b553a10d616c4b" prefix=" " category="inline-code"></block>。</block>
  <block id="166355001b2692bdc29d698719b5f702" category="list-text">在目录中<block ref="fc7cb0a7b647c6ff35b553a10d616c4b" prefix=" " category="inline-code"></block>，创建一个标记为的密码文件<block ref="97a67fc90fe6d13cef22fa951de48f8d" prefix=" " category="inline-code"></block>。</block>
  <block id="da8d8318ceb4254068ec25272c92bc85" category="list-text">使用以下内容填充<block ref="b8d32e4c2d78b6e404b69e5c1fbf3118" prefix=" " category="inline-code"></block>、根据您的配置替换所有用户名和密码参数：</block>
  <block id="7e60d329db54d74d692f53620b366281" category="list-text">根据提示运行<block ref="150063209c60b18e2173569bd82ec639" prefix=" " category="inline-code"></block>并设置存储密码。</block>
  <block id="1d2459ca9cef1e38badde9d192eff628" category="admonition">如果<block ref="f2bf771afbc16045e1951ded58c56f98" prefix=" " category="inline-code"></block>已经是<block ref="63a9f0ea7bb98050796b649e85481845" prefix=" " category="inline-code"></block>，则可以选择省略，<block ref="424240cd4e5c359372b7f199431603d5" prefix=" " category="inline-code"></block>并在运行该播放手册时指定<block ref="13d87b4892426ec19bdc58a4643d3104" prefix=" " category="inline-code"></block>选项。</block>
  <block id="49e794dd3d68025fd6943b67048e4f27" category="paragraph">基于NetApp的第二代BeeGFS经过优化、可满足高性能计算(HPC)、机器学习(ML)、深度学习(DL)和其他人工智能(AI)技术等苛刻工作负载的性能要求。通过整合共享磁盘高可用性(HA)架构、此设计可确保数据持久性和可用性、使其成为无法承受停机或数据丢失的企业和其他组织的理想选择。第二代设计包括PCIe Gen5服务器等组件，并支持NVIDIA®QuutM9700 400Gb/s InfiniBand交换机。该解决方案不仅经过NetApp的验证，还通过了NVIDIA DGX™A100 SuperPOD存储选项的外部认证，并获得了DGX SuperPOD H100、H200和B200系统的扩展认证。</block>
  <block id="7da4cabbb2f4c4e53ccb9660355b7dd1" category="list-text">NVIDIA DGX SuperPOD系统采用采用DGX的A100、H100、H200和B200 GPU。</block>
  <block id="e02a1b9bf28135b2931b63ac814ff7ac" category="sidebar">NVA-1174 -采用NVIDIA DGX SuperPoD系统的NetApp EF系列上的BeeGFS</block>
  <block id="049125cf8ec62098912c4f2c8db9f61b" category="paragraph">此<block ref="e6211db0073064ade016ad4558767968" prefix=" " category="inline-code"></block>如果集群运行正常、则不会显示属性。如果集群当前处于维护模式，则该属性将报告为<block ref="b326b5062b2f0e69046810717534cb09" prefix=" " category="inline-code"></block>。要启用维护模式、请运行：</block>
  <block id="ae7cd547e02c1f67adce822f49e1815f" category="admonition">根据集群大小、整个集群可能需要几秒钟或几分钟才能停止或显示为中已启动<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block>。如果挂起超过五分钟、请在运行Ctrl+C取消命令之前登录到集群的每个节点、然后使用<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block>查看该节点上的集群服务(Corosync/PacMaker)是否仍在运行。<block ref="88f9ea6da6d01a3e529f8aa41e0e4643" prefix=" " category="inline-code"></block>您可以从集群仍处于活动状态的任何节点上检查阻止集群的资源。手动输入问题描述 地址、然后命令应完成或可以重新运行以停止任何剩余服务。</block>
  <block id="5dfbb07786784ecd0c0829f3624766bf" category="summary">在HA集群中升级PacMaker和Corosync软件包的步骤。</block>
  <block id="256ad8b6e95e34f8784f6b80bcf07e62" category="doc">升级HA集群中的PacMaker和Corosync软件包</block>
  <block id="f9b43d72a27351762f4809a45ab3809e" category="paragraph">按照以下步骤升级HA集群中的PacMaker和Corosync软件包。</block>
  <block id="93bcc5a6e49472d3ee328b74217072a4" category="paragraph">升级PacMaker和Corosync可确保集群受益于新功能、安全修补程序和性能改进。</block>
  <block id="d5870f2e8bb30d5fd8dba0f3bcba2ff2" category="section-title">升级方法</block>
  <block id="3910bde80db45114f03b57a1cea719d7" category="inline-link-macro">升级PacMaker集群</block>
  <block id="fbe527032decd848e5233378716880ef" category="paragraph">建议使用两种方法升级集群：滚动升级或完全关闭集群。每种方法都有自己的优缺点。升级过程可能因您的PacMaker版本而异。请参见ClusterLabs<block ref="f46eb388ba6d1748ea24c2340bf59c47" category="inline-link-macro-rx"></block>文档以确定使用哪种方法。在执行升级方法之前、请验证：</block>
  <block id="3875a0129b5e7200d99ab95798b4ca49" category="list-text">NetApp BeeGFS解决方案支持新的PacMaker和Corosync软件包。</block>
  <block id="14bc480662de00a882a587d6c753c533" category="list-text">您的BeeGFS文件系统和PacMaker集群配置具有有效的备份。</block>
  <block id="efd7093d185f1f3506d2f99fa2406088" category="list-text">集群处于运行状况良好的状态。</block>
  <block id="22e44c8383bdd51e7823eed40de12db4" category="section-title">滚动升级</block>
  <block id="49939651104a8f4bf473311d280796b9" category="paragraph">此方法包括从集群中删除每个节点、对其进行升级、然后将其重新引入集群、直到所有节点都运行新版本为止。这种方法可以使集群保持正常运行、这是大型HA集群的理想选择、但会带来在此过程中运行混合版本的风险。在双节点集群中应避免使用此方法。</block>
  <block id="4fe0553e4bb27a05a3680575a66540a7" category="list-text">确认集群处于最佳状态、每个BeeGFS服务都在其首选节点上运行。有关详细信息、请参见 <block ref="1d1f85855f64d7b14ac7c0ae29a52511" category="inline-link-macro-rx"></block> 。</block>
  <block id="afcf7685b4b8a18d898e6c84f2b84166" category="list-text">对于要升级的节点、请将其置于备用模式以耗尽(或移动)所有BeeGFS服务：</block>
  <block id="36b48c4e047e7d7107eaa995708914b1" category="list-text">运行以下命令、验证节点的服务是否已耗尽：</block>
  <block id="9c1adfab509ac587de61a03c43cda767" category="paragraph">确保未将备用节点上的服务报告为<block ref="8428552d86c0d262a542a528af490afa" prefix=" " category="inline-code"></block>。</block>
  <block id="2b26b4d53851d442c712564adfb4b445" category="admonition">根据您的集群大小、服务可能需要几秒钟或几分钟才能移至姊妹节点。如果BeeGFS服务无法在姊妹节点上启动，请参阅<block ref="c31c76dcbaad8e2836998d58888cb639" category="inline-link-macro-rx"></block>。</block>
  <block id="e2939fee46b1883f2b4fb3fec03f83fb" category="list-text">关闭节点上的集群：</block>
  <block id="7a3db5a8197b212244d160de60f682da" category="list-text">升级节点上的PacMaker、Corosync和pcs软件包：</block>
  <block id="054ce71db50c3d6b29d6ddfda5264cc9" category="admonition">软件包管理器命令因操作系统而异。以下命令适用于运行RHEL 8及更高版本的系统。</block>
  <block id="0a761ff507fc5bb4859d6d425b2b120a" category="list-text">在节点上启动PacMaker集群服务：</block>
  <block id="7a98d33ee2035dc15b33a6ccaea4753b" category="list-text">如果<block ref="3ecf2642759a04bd3616642bd56bed59" prefix=" " category="inline-code"></block>软件包已更新、请向集群重新对节点进行身份验证：</block>
  <block id="039f324455c000e0dad7b93f641cd7bf" category="list-text">使用工具验证PacMaker配置是否仍然有效<block ref="419527551374e0fe5024d6bb1f3f2814" prefix=" " category="inline-code"></block>。</block>
  <block id="51c1fa488cc911104720c97dad8ec5eb" category="admonition">在集群升级期间、只需验证一次即可。</block>
  <block id="265a35348bf91dcba3e55e3454e3c155" category="list-text">使节点退出待机状态：</block>
  <block id="ea285586c4e419f14cfb8b432dd0d4b6" category="list-text">将所有BeeGFS服务重新定位回其首选节点：</block>
  <block id="1fa806fcbe49745af0c2b70e8779b73d" category="list-text">对集群中的每个节点重复上述步骤、直到所有节点都运行所需的PacMaker、Corosync和pcs版本为止。</block>
  <block id="d90c1dfacfcfe6034c62dbbf554aa336" category="list-text">最后、运行<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block>并验证集群是否运行正常、并<block ref="60c21e5e7bb2f6f1f478a497d52448f3" prefix=" " category="inline-code"></block>报告所需的PacMaker版本。</block>
  <block id="894166f580af39476db30ddf0b39e93c" category="admonition">如果<block ref="60c21e5e7bb2f6f1f478a497d52448f3" prefix=" " category="inline-code"></block>报告"mxy-version"、则表示集群中的某个节点仍在运行先前的Pacemker版本、需要进行升级。如果任何升级后的节点无法重新加入集群或资源无法启动、请查看集群日志、并参阅PacMaker发行说明或用户指南以了解已知的升级问题。</block>
  <block id="2360c7132bb0f703a6af1f784e30721f" category="section-title">完全关闭集群</block>
  <block id="c56b96ad19ba7ad1a0a28a5dd92fccd7" category="paragraph">在这种方法中、所有集群节点和资源都会关闭、节点会升级、然后集群会重新启动。如果PacMaker和Corosync版本不支持混合版本配置、则必须使用此方法。</block>
  <block id="ada4df9ccfff1547c1f09456386caf07" category="list-text">关闭所有节点上的集群软件(PacMaker和Corosync)。</block>
  <block id="ec37f5378eeba13984a263685014a655" category="admonition">根据集群大小、整个集群可能需要几秒钟或几分钟才能停止。</block>
  <block id="26dce8ee8153faa4816d7468ec720330" category="list-text">关闭所有节点上的集群服务后、根据您的要求升级每个节点上的PacMaker、Corosync和pcs软件包。</block>
  <block id="142f756ea3d035f02b974a98db74916c" category="list-text">升级所有节点后、在所有节点上启动集群软件：</block>
  <block id="492e09d8d491f90ea20fad54f615816a" category="list-text">如果<block ref="3ecf2642759a04bd3616642bd56bed59" prefix=" " category="inline-code"></block>软件包已更新、请重新对集群中的每个节点进行身份验证：</block>
  <block id="fe0b373cea492c0574adf218141f90b9" category="list-text">最后、运行<block ref="fcad1c87c23363c990849a7aaf9d6cd9" prefix=" " category="inline-code"></block>并验证集群是否运行正常、并报告正确的<block ref="60c21e5e7bb2f6f1f478a497d52448f3" prefix=" " category="inline-code"></block>PacMaker版本。</block>
  <block id="c07d2f5207c17b96abd3e5c6aa314715" category="admonition">如果<block ref="60c21e5e7bb2f6f1f478a497d52448f3" prefix=" " category="inline-code"></block>报告"mxy-version"、则表示集群中的某个节点仍在运行先前的Pacemker版本、需要进行升级。</block>
  <block id="6b923a0944f4926d7adb6a03c07c9a69" category="summary">更新文件节点的ConnectX-7适配器固件的步骤。</block>
  <block id="8fce27499bf82a3c6907d5382138d466" category="doc">更新文件节点适配器固件</block>
  <block id="c344aab4fba3911c1af618a881763c15" category="paragraph">按照以下步骤将文件节点的ConnectX-7适配器更新为最新固件。</block>
  <block id="89cdf8293572c88c65745474062df951" category="paragraph">要支持新的MLNX_OFED驱动程序、启用新功能或修复错误、可能需要更新ConnectX-7适配器固件。本指南将使用NVIDIA的<block ref="073f22c545d6312ca19220ec3d6d9547" prefix=" " category="inline-code"></block>实用程序进行适配器更新、因为它易于使用且效率高。</block>
  <block id="d41774d5dcaa69f5393d8da7101754ec" category="paragraph">本指南介绍更新ConnectX-7适配器固件的两种方法：滚动更新和双节点集群更新。根据集群大小选择适当的更新方法。在执行固件更新之前、请验证：</block>
  <block id="1d79fc0255b694c56bd5dea749c741cd" category="list-text">安装了受支持的MLNR_OFED驱动程序，请参阅<block ref="178d97073525b373723b8dda031e8548" category="inline-link-macro-rx"></block>。</block>
  <block id="e9b1ac80ddb831f90b95b913fae55a9f" category="section-title">固件更新准备</block>
  <block id="6b9b7c71638c919ff18548623403c799" category="inline-link-macro">NVIDIA的支持站点</block>
  <block id="28adaa75c816b77283bde4522b8cc249" category="paragraph">建议使用NVIDIA的<block ref="073f22c545d6312ca19220ec3d6d9547" prefix=" " category="inline-code"></block>实用程序更新节点的适配器固件、该固件与NVIDIA的MLNR_OFED驱动程序捆绑在一起。开始更新之前、请从下载适配器的固件映像<block ref="1a2b49373c8b50530166a64f6ed91a90" category="inline-link-macro-rx"></block>、并将其存储在每个文件节点上。</block>
  <block id="415a4f653138a852500ffee84bf5c1b4" category="inline-link-macro">OEM 固件</block>
  <block id="4f4c0bb368cf9ad01cdc3ff868ebf17c" category="admonition">对于联想ConnectX-7适配器、请使用<block ref="afeb1af9ee3dad5422ab912ec5ed916d" prefix=" " category="inline-code"></block>NVIDIA页面上提供的工具<block ref="01d7d47a93ae1e4d58f3e91b6cd1d0c0" category="inline-link-macro-rx"></block>。</block>
  <block id="da3485dbd4b4e5883fb3b1f4e9556949" category="section-title">滚动更新方法</block>
  <block id="1f97f3d9707d91def548aa8a2e62b91d" category="paragraph">对于具有两个以上节点的任何HA集群、建议使用此方法。此方法涉及一次更新一个文件节点上的适配器固件、以使HA集群能够继续处理请求、但建议避免在此期间处理I/O。</block>
  <block id="a6e5bc149cec5a68a62c041d3c6a0b33" category="list-text">选择要更新的文件节点并将其置于备用模式、此模式会从该节点中消耗(或移动)所有BeeGFS服务：</block>
  <block id="a6f5d5c821201989f4f5f4b1434bbab2" category="list-text">运行以下命令、验证节点的服务是否已耗尽：</block>
  <block id="879176c1b609d9d4155509330b98a7dc" category="paragraph">确认没有服务在备用节点上报告为<block ref="8428552d86c0d262a542a528af490afa" prefix=" " category="inline-code"></block>。</block>
  <block id="9d2557a9c1e296e086e87e0ea139e32b" category="admonition">根据集群大小、BeeGFS服务可能需要几秒钟或几分钟才能移至姊妹节点。如果BeeGFS服务无法在姊妹节点上启动，请参阅<block ref="c31c76dcbaad8e2836998d58888cb639" category="inline-link-macro-rx"></block>。</block>
  <block id="d15de38a9cc8343b26b76e04866effdf" category="list-text">使用更新适配器固件<block ref="073f22c545d6312ca19220ec3d6d9547" prefix=" " category="inline-code"></block>。</block>
  <block id="4d87c4ea16f4cf2adbeefb288c4840e6" category="paragraph">记下接收固件更新的<block ref="0e4a508dbc00c0684c2ed58952be4420" prefix=" " category="inline-code"></block>每个适配器的。</block>
  <block id="69b31d926cd00aa9de80cf7b14eab218" category="list-text">使用实用程序重置每个适配器<block ref="45e6a20266bfc1fa2c25471ddf52308b" prefix=" " category="inline-code"></block>以应用新固件。</block>
  <block id="25eb42c85a64acec04cf19a3ad2b7395" category="inline-link-macro">NVIDIA的mxfwreset限制</block>
  <block id="435a7ccec9f9ff6251954e95de4d0077" category="admonition">某些固件更新可能需要重新启动才能应用更新。有关指导、请参见。<block ref="ebfc57e157ebe1ff1768e220a8dc329c" category="inline-link-macro-rx"></block>如果需要重新启动、请执行重新启动、而不是重置适配器。</block>
  <block id="d974fd8f7ae3828a4b95f6e90d4c579a" category="list-text">停止opensm服务：</block>
  <block id="6a878a1cd043169c82c66374f6fec2a5" category="list-text">对前面提到的每个执行以下命令<block ref="0e4a508dbc00c0684c2ed58952be4420" prefix=" " category="inline-code"></block>。</block>
  <block id="bd1516e27db5d9760920cc6ac65637f7" category="list-text">启动opensm服务：</block>
  <block id="e8dd47a8d6e5d7d4ce23864009576781" category="list-text">运行<block ref="64284c8d228536994c2b22912d2dfd88" prefix=" " category="inline-code"></block>并验证所有适配器是否以所需的固件版本运行：</block>
  <block id="afdebfdd553f315294b6e2613a68bac2" category="paragraph">对集群中的每个文件节点重复上述步骤、直到所有适配器均已更新为止。</block>
  <block id="2e24e5f97c6ecd461030eb1eb884379b" category="section-title">双节点集群更新方法</block>
  <block id="305a0f364da0ff85c6c92c4680866c24" category="paragraph">对于仅包含两个节点的HA集群、建议使用此方法。此方法类似于滚动更新、但还包括一些额外的步骤、以防止在一个节点的集群服务停止时出现服务停机。</block>
  <block id="8daaa6355694edbaba2cb5a9b13ce781" category="list-text">选择要更新的文件节点并将该节点置于备用模式、此操作将从该节点中消耗(或移动)所有BeeGFS服务：</block>
  <block id="370d6736b9730ee3ed471c975dca3040" category="list-text">运行以下命令、验证节点的资源是否已耗尽：</block>
  <block id="04adfc113361937ceba2fcd8d61b3c92" category="admonition">根据集群大小、BeeGFS服务可能需要数秒或数分钟才能报告为<block ref="8428552d86c0d262a542a528af490afa" prefix=" " category="inline-code"></block>在姐妹节点上。如果BeeGFS服务无法启动，请参见<block ref="c31c76dcbaad8e2836998d58888cb639" category="inline-link-macro-rx"></block>。</block>
  <block id="322895ffeb919484b312ccccded9b8ac" category="list-text">将集群置于维护模式。</block>
  <block id="936f1016c7b40dcadce05d9585e03c4c" category="list-text">使集群退出维护模式。</block>
  <block id="7190ac3ac7ea745d4c9a31ade586f240" category="paragraph">请按照以下步骤升级HA集群的E系列存储阵列组件。</block>
  <block id="91ba484bdb8dfae4fcf9b5f1cb4c9407" category="paragraph">确保HA集群的NetApp E-Series存储阵列始终使用最新固件、以确保最佳性能和更高的安全性。存储阵列的固件更新可通过SANtricity操作系统、NVSRAID和驱动器固件文件应用。</block>
  <block id="f04c5fdc9e10396af2f82ce9565f65a5" category="list-text">确保集群处于最佳状态、并且每个BeeGFS服务都位于其首选节点上。有关详细信息、请参见 <block ref="1d1f85855f64d7b14ac7c0ae29a52511" category="inline-link-macro-rx"></block> 。</block>
  <block id="d5c73bafdf627c28554a39d3e655f1bf" category="cell">有源光纤(包括收发器)</block>
  <block id="c44b2ed9fc36044ebe1e8b9057c4a281" category="cell">MMA4Z00-NS (多模式、IB/ETH、800 Gb/秒2x400 Gb/秒双端口OSFP)</block>
  <block id="53fff94cbca4161cd31d168451033f2e" category="cell">MFP7E20-Nxxx (多模式、4通道到2通道分路器光缆)</block>
  <block id="804e83e6974e7f6076f940326b985a83" category="cell">MMA1Z00-NS400 (多模式、IB/ETH、400 Gb/秒单端口QP-112)</block>
  <block id="b2f1f9abf8117b3cde0475d1adf7a64f" category="cell">NVIDIA 7Y40-N002 (InfiniBand无源铜缆分路器电缆、InfiniBand 800Gb/s到4个200Gb/s、OSFP到4个QSFP112)</block>
  <block id="fbe7b2959f641c0a45951417fc744ba8" category="paragraph">*ConnectX-7 HCA固件* FW 28.42.1000 + PXE 3.7.0500 + UEFI 14.35.0015</block>
  <block id="63c2d436fc11f0bcdd598c38560aca3f" category="paragraph">*ConnectX-6 HCA固件* FW 20.43.1014 + PXE 3.7.0500 + UEFI 14.36.0016</block>
  <block id="0d665a6c7072af8fddd1f64d9c741762" category="cell">11.90R1</block>
  <block id="6c3a5f2fbe0e1eb20af96ccd813c89b0" category="cell">N6000-890834-D02.DLP</block>
  <block id="2c31ce9dbdba754d30ac4980d7d504df" category="cell">3.1.7-1.</block>
  <block id="fec83cb9bb84cd6342be622a93d94a1b" category="cell">2.1.6-10.</block>
  <block id="088914339db9effda3ac57ec2e9439b6" category="cell">Fence Agent (红鱼/APC)</block>
  <block id="f726fcf5784fc25f630a32e650f8b5a0" category="cell">4.10.0-55.</block>
  <block id="f8b6aa2ae96c25a05a0cc6e26a9236d7" category="sidebar">升级PacMaker和Corosync软件包</block>
</blocks>